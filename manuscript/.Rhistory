axis.text = element_text(size = rel(0.8)),
legend.position = "none",
panel.grid.minor = element_blank()
)
# adding images -----
# load images
image_1 <- image_read(paste0("../illustrations/plotexample ", levels(d1$condition)[1], ".png"))
image_2 <- image_read(paste0("../illustrations/plotexample ", levels(d1$condition)[2], ".png"))
image_3 <- image_read(paste0("../illustrations/plotexample ", levels(d1$condition)[3], ".png"))
image_4 <- image_read(paste0("../illustrations/plotexample ", levels(d1$condition)[4], ".png"))
# create grobs
image_1_grob <- rasterGrob(image_1, interpolate = TRUE)
image_2_grob <- rasterGrob(image_2, interpolate = TRUE)
image_3_grob <- rasterGrob(image_3, interpolate = TRUE)
image_4_grob <- rasterGrob(image_4, interpolate = TRUE)
final_plot <- ggdraw(main_plot) +
draw_grob(image_1_grob, x = 0.071, y = 0.752, width = 0.25, height = 0.15) +
draw_grob(image_2_grob, x = 0.3, y = 0.752, width = 0.25, height = 0.15) +
draw_grob(image_3_grob, x = 0.527, y = 0.752, width = 0.25, height = 0.15) +
draw_grob(image_4_grob, x = 0.755, y = 0.752, width = 0.25, height = 0.15)
# Save  ------------
ggsave(
filename = "../illustrations/plot_study1.png",
plot = final_plot,
device = "png",
width = 8, height = 3.5,
dpi = 300,
units = "in",
bg = "white"
)
# display plot
img <- image_read("../illustrations/plot_study1.png")
windows(width = 15, height = 10)  # On Windows
plot(img)
# Create main plot
main_plot <- ggplot() +
geom_hline(yintercept = 0.5, linetype = "dashed", color = "grey70", alpha = 0.75) +
geom_point(data = d1, aes(x = ageinyears, y = mean, colour = colour), alpha = 0.5, shape = 1, size = 2) +
geom_smooth(data = f1, aes(x = age, y = Estimate, ymin = Q2.5, ymax = Q97.5, fill = colour, colour = colour),
stat = "identity", alpha = 0.2, linewidth = 0.8) +
geom_point(data = p1, aes(x = days/365.25, y = 0.5, fill = colour, colour = colour), size = 4, shape = 21, stroke = 1) +
geom_point(data = p1, aes(x = days/365.25, y = 0.5, fill = "black", colour = "black"), size = 0.5, shape = 21, stroke = 1) +
geom_text(data = p1, aes(label = months, x = days/365.25, y = 0.13, colour = "black", fontface = "bold"),
angle = 90, size = 3.2, vjust = 0.5) +
geom_text(data = p1, aes(label = "months", x = days/365.25, y = .31, colour = "black", fontface = "bold"),
angle = 90, size = 3.2, vjust = 0.5) +
scale_colour_identity() +
scale_fill_identity() +
scale_y_continuous(labels = function(x) paste0(x*100, "%")) + # Multiply by 100 & add %
facet_grid(cols = vars(condition)) +
labs(x = "Age", y = "Proportion Correct") +
coord_cartesian(ylim = c(0, 1), xlim = c(2.7, 7.3)) +   # Allow more Y space for image
theme_minimal(base_size = 13) +
theme(
panel.border = element_rect(colour = "grey30", fill = NA, size = 2),
strip.background = element_rect(colour = "grey30", size = 2),
strip.text = element_text(face = "bold", size = rel(0.8),
margin = margin(t = 5, b = 45)), # HIER STRIPE SPACING via b =
# strip.switch.pad.grid = unit(0, "cm"),
axis.title = element_text(face = "bold", size = rel(0.8)),
axis.text = element_text(size = rel(0.8)),
legend.position = "none",
panel.grid.minor = element_blank()
)
# adding images -----
# load images
image_1 <- image_read(paste0("../illustrations/plotexample ", levels(d1$condition)[1], ".png"))
image_2 <- image_read(paste0("../illustrations/plotexample ", levels(d1$condition)[2], ".png"))
image_3 <- image_read(paste0("../illustrations/plotexample ", levels(d1$condition)[3], ".png"))
image_4 <- image_read(paste0("../illustrations/plotexample ", levels(d1$condition)[4], ".png"))
# create grobs
image_1_grob <- rasterGrob(image_1, interpolate = TRUE)
image_2_grob <- rasterGrob(image_2, interpolate = TRUE)
image_3_grob <- rasterGrob(image_3, interpolate = TRUE)
image_4_grob <- rasterGrob(image_4, interpolate = TRUE)
final_plot <- ggdraw(main_plot) +
draw_grob(image_1_grob, x = 0.071, y = 0.752, width = 0.25, height = 0.15) +
draw_grob(image_2_grob, x = 0.3, y = 0.752, width = 0.25, height = 0.15) +
draw_grob(image_3_grob, x = 0.527, y = 0.752, width = 0.25, height = 0.15) +
draw_grob(image_4_grob, x = 0.755, y = 0.752, width = 0.25, height = 0.15)
# Save  ------------
ggsave(
filename = "../illustrations/plot_study1.png",
plot = final_plot,
device = "png",
width = 8, height = 3.5,
dpi = 300,
units = "in",
bg = "white"
)
# display plot
img <- image_read("../illustrations/plot_study1.png")
windows(width = 15, height = 10)  # On Windows
plot(img)
# Create main plot
main_plot <- ggplot() +
geom_hline(yintercept = 0.5, linetype = "dashed", color = "grey70", alpha = 0.75) +
geom_point(data = d1, aes(x = ageinyears, y = mean, colour = colour), alpha = 0.5, shape = 1, size = 2) +
geom_smooth(data = f1, aes(x = age, y = Estimate, ymin = Q2.5, ymax = Q97.5, fill = colour, colour = colour),
stat = "identity", alpha = 0.2, linewidth = 0.8) +
geom_point(data = p1, aes(x = days/365.25, y = 0.5, fill = colour, colour = colour), size = 4, shape = 21, stroke = 1) +
geom_point(data = p1, aes(x = days/365.25, y = 0.5, fill = "black", colour = "black"), size = 0.5, shape = 21, stroke = 1) +
geom_text(data = p1, aes(label = months, x = days/365.25, y = 0.13, colour = "black", fontface = "bold"),
angle = 90, size = 3.2, vjust = 0.5) +
geom_text(data = p1, aes(label = "months", x = days/365.25, y = .31, colour = "black", fontface = "bold"),
angle = 90, size = 3.2, vjust = 0.5) +
scale_colour_identity() +
scale_fill_identity() +
scale_y_continuous(labels = function(x) paste0(x*100, "%")) + # Multiply by 100 & add %
facet_grid(cols = vars(condition)) +
labs(x = "Age", y = "Proportion Correct") +
coord_cartesian(ylim = c(0, 1), xlim = c(2.7, 7.3)) +   # Allow more Y space for image
theme_minimal(base_size = 13) +
theme(
panel.border = element_rect(colour = "grey30", fill = NA, size = 1),
strip.background = element_rect(colour = "grey30", size = 1),
strip.text = element_text(face = "bold", size = rel(0.8),
margin = margin(t = 5, b = 45)), # HIER STRIPE SPACING via b =
# strip.switch.pad.grid = unit(0, "cm"),
axis.title = element_text(face = "bold", size = rel(0.8)),
axis.text = element_text(size = rel(0.8)),
legend.position = "none",
panel.grid.minor = element_blank()
)
# adding images -----
# load images
image_1 <- image_read(paste0("../illustrations/plotexample ", levels(d1$condition)[1], ".png"))
image_2 <- image_read(paste0("../illustrations/plotexample ", levels(d1$condition)[2], ".png"))
image_3 <- image_read(paste0("../illustrations/plotexample ", levels(d1$condition)[3], ".png"))
image_4 <- image_read(paste0("../illustrations/plotexample ", levels(d1$condition)[4], ".png"))
# create grobs
image_1_grob <- rasterGrob(image_1, interpolate = TRUE)
image_2_grob <- rasterGrob(image_2, interpolate = TRUE)
image_3_grob <- rasterGrob(image_3, interpolate = TRUE)
image_4_grob <- rasterGrob(image_4, interpolate = TRUE)
final_plot <- ggdraw(main_plot) +
draw_grob(image_1_grob, x = 0.071, y = 0.752, width = 0.25, height = 0.15) +
draw_grob(image_2_grob, x = 0.3, y = 0.752, width = 0.25, height = 0.15) +
draw_grob(image_3_grob, x = 0.527, y = 0.752, width = 0.25, height = 0.15) +
draw_grob(image_4_grob, x = 0.755, y = 0.752, width = 0.25, height = 0.15)
# Save  ------------
ggsave(
filename = "../illustrations/plot_study1.png",
plot = final_plot,
device = "png",
width = 8, height = 3.5,
dpi = 300,
units = "in",
bg = "white"
)
# display plot
img <- image_read("../illustrations/plot_study1.png")
windows(width = 15, height = 10)  # On Windows
plot(img)
# Create main plot
main_plot <- ggplot() +
geom_hline(yintercept = 0.5, linetype = "dashed", color = "grey70", alpha = 0.75) +
geom_point(data = d2, aes(x = ageinyears, y = mean, colour = colour), alpha = 0.5, shape = 1, size = 2) +
geom_smooth(data = f2, aes(x = age, y = Estimate, ymin = Q2.5, ymax = Q97.5, fill = colour, colour = colour),
stat = "identity", alpha = 0.2, linewidth = 0.8) +
geom_point(data = p2, aes(x = days/365.25, y = 0.5, fill = colour, colour = colour), size = 4, shape = 21, stroke = 1) +
geom_point(data = p2, aes(x = days/365.25, y = 0.5, fill = "black", colour = "black"), size = 0.5, shape = 21, stroke = 1) +
geom_text(data = p2, aes(label = months, x = days/365.25, y = 0.13, colour = "black", fontface = "bold"),
angle = 90, size = 3.2, vjust = 0.5) +
geom_text(data = p2, aes(label = "months", x = days/365.25, y = .31, colour = "black", fontface = "bold"),
angle = 90, size = 3.2, vjust = 0.5) +
scale_colour_identity() +
scale_fill_identity() +
scale_y_continuous(labels = function(x) paste0(x*100, "%")) + # Multiply by 100 & add %
facet_grid(cols = vars(condition)) +
labs(x = "Age", y = "Proportion Correct") +
coord_cartesian(ylim = c(0, 1), xlim = c(2.7, 7.3)) +   # Allow more Y space for image
theme_minimal(base_size = 13) +
theme(
panel.border = element_rect(colour = "grey30", fill = NA, size = 1),
strip.background = element_rect(colour = "grey30", size = 1),
strip.text = element_text(face = "bold", size = rel(0.8),
margin = margin(t = 5, b = 45)), # HIER STRIPE SPACING via b =
# strip.switch.pad.grid = unit(0, "cm"),
axis.title = element_text(face = "bold", size = rel(0.8)),
axis.text = element_text(size = rel(0.8)),
legend.position = "none",
panel.grid.minor = element_blank()
)
# adding images -----
# load images
image_1 <- image_read(paste0("../illustrations/plotexample ", levels(d2$condition)[1], ".png"))
image_2 <- image_read(paste0("../illustrations/plotexample ", levels(d2$condition)[2], ".png"))
image_3 <- image_read(paste0("../illustrations/plotexample ", levels(d2$condition)[3], ".png"))
image_4 <- image_read(paste0("../illustrations/plotexample ", levels(d2$condition)[4], ".png"))
# create grobs
image_1_grob <- rasterGrob(image_1, interpolate = TRUE)
image_2_grob <- rasterGrob(image_2, interpolate = TRUE)
image_3_grob <- rasterGrob(image_3, interpolate = TRUE)
image_4_grob <- rasterGrob(image_4, interpolate = TRUE)
final_plot <- ggdraw(main_plot) +
draw_grob(image_1_grob, x = 0.071, y = 0.752, width = 0.25, height = 0.15) +
draw_grob(image_2_grob, x = 0.3, y = 0.752, width = 0.25, height = 0.15) +
draw_grob(image_3_grob, x = 0.527, y = 0.752, width = 0.25, height = 0.15) +
draw_grob(image_4_grob, x = 0.755, y = 0.752, width = 0.25, height = 0.15)
# Save  ------------
ggsave(
filename = "../illustrations/plot_study2.png",
plot = final_plot,
device = "png",
width = 8, height = 3.5,
dpi = 300,
units = "in",
bg = "white"
)
# display plot
img <- image_read("../illustrations/plot_study2.png")
windows(width = 15, height = 10)  # On Windows
plot(img)
# Create main plot
main_plot <- ggplot() +
geom_hline(yintercept = 0.5, linetype = "dashed", color = "grey70", alpha = 0.75) +
geom_point(data = d3, aes(x = ageinyears, y = mean, colour = colour), alpha = 0.5, shape = 1, size = 2) +
geom_smooth(data = f3, aes(x = age, y = Estimate, ymin = Q2.5, ymax = Q97.5, fill = colour, colour = colour),
stat = "identity", alpha = 0.2, linewidth = 0.8) +
geom_point(data = p3, aes(x = days/365.25, y = 0.5, fill = colour, colour = colour), size = 4, shape = 21, stroke = 1) +
geom_point(data = p3, aes(x = days/365.25, y = 0.5, fill = "black", colour = "black"), size = 0.5, shape = 21, stroke = 1) +
geom_text(data = p3, aes(label = months, x = days/365.25, y = 0.13, colour = "black", fontface = "bold"),
angle = 90, size = 3.2, vjust = 0.5) +
geom_text(data = p3, aes(label = "months", x = days/365.25, y = .31, colour = "black", fontface = "bold"),
angle = 90, size = 3.2, vjust = 0.5) +
scale_colour_identity() +
scale_fill_identity() +
scale_y_continuous(labels = function(x) paste0(x*100, "%")) + # Multiply by 100 & add %
facet_grid(cols = vars(condition)) +
labs(x = "Age", y = "Proportion Correct") +
coord_cartesian(ylim = c(0, 1), xlim = c(2.7, 7.3)) +   # Allow more Y space for image
theme_minimal(base_size = 13) +
theme(
panel.border = element_rect(colour = "grey30", fill = NA, size = 1),
strip.background = element_rect(colour = "grey30", size = 1),
strip.text = element_text(face = "bold", size = rel(0.8),
margin = margin(t = 5, b = 45)), # HIER STRIPE SPACING via b =
# strip.switch.pad.grid = unit(0, "cm"),
axis.title = element_text(face = "bold", size = rel(0.8)),
axis.text = element_text(size = rel(0.8)),
legend.position = "none",
panel.grid.minor = element_blank()
)
# adding images -----
# load images
image_1 <- image_read(paste0("../illustrations/plotexample ", levels(d3$condition)[1], ".png"))
image_2 <- image_read(paste0("../illustrations/plotexample ", levels(d3$condition)[2], ".png"))
image_3 <- image_read(paste0("../illustrations/plotexample ", levels(d3$condition)[3], ".png"))
image_4 <- image_read(paste0("../illustrations/plotexample ", levels(d3$condition)[4], ".png"))
# create grobs
image_1_grob <- rasterGrob(image_1, interpolate = TRUE)
image_2_grob <- rasterGrob(image_2, interpolate = TRUE)
image_3_grob <- rasterGrob(image_3, interpolate = TRUE)
image_4_grob <- rasterGrob(image_4, interpolate = TRUE)
final_plot <- ggdraw(main_plot) +
draw_grob(image_1_grob, x = 0.071, y = 0.752, width = 0.25, height = 0.15) +
draw_grob(image_2_grob, x = 0.3, y = 0.752, width = 0.25, height = 0.15) +
draw_grob(image_3_grob, x = 0.527, y = 0.752, width = 0.25, height = 0.15) +
draw_grob(image_4_grob, x = 0.755, y = 0.752, width = 0.25, height = 0.15)
# Save  ------------
ggsave(
filename = "../illustrations/plot_study3.png",
plot = final_plot,
device = "png",
width = 8, height = 3.5,
dpi = 300,
units = "in",
bg = "white"
)
# display plot
img <- image_read("../illustrations/plot_study3.png")
windows(width = 15, height = 10)  # On Windows
plot(img)
# load model from rds
S2.full.bm <- readRDS("../models/S2.full.bm.rds")
# table(rep.S2.bayes.data$condition)
nd2 <- tibble(z.age = rep(seq(from = min(rep.S2.bayes.data$z.age), to = max(rep.S2.bayes.data$z.age), length.out = 50),4),
condition = c(rep("Relative Position",50),
rep("Absolute Position",50),
rep("Orientation of Feature",50),
rep("Orientation of Object",50)),
sex = rep(0,200),
z.trial = rep(0,200))
# here we generate the fitted values based on the model
# the function fitted() takes in the model and the new dataset and generates a fitted values (inclucing upper and lower 95% CI) for every row in the dataset
# because our dataset ranges from min age to max age in the data, we get the prediction for the age range in the data
# but we could also generate predictions for different ages of course
f2 <- fitted(S2.full.bm,
newdata = nd2,
re_formula = NA) %>%
# this tells the function to ignore the random effects - in theory, we could generate predictions for specific individuals
as_tibble() %>%
bind_cols(nd2)%>%
mutate(age = z.age + mean(rep.S2.bayes.data$ageinyears)) %>% # convert age back to the original scale by adding the mean of the data
mutate(condition = factor(condition, levels = c(
"Absolute Position", # first level becomes reference
"Relative Position",
"Orientation of Object",
"Orientation of Feature")))
# summarize the data to include them in the plot later on
d2 <- rep.S2.bayes.data%>%
group_by(subid, ageinyears, condition)%>%
summarise(mean = mean(correct)) %>%
mutate(condition = factor(condition, levels = c(
"Absolute Position", # first level becomes reference
"Relative Position",
"Orientation of Object",
"Orientation of Feature")))
p2 <- f2 %>%
mutate(age = age * 365.25)%>%
mutate(condition = factor(condition, levels = c(
"Absolute Position", # first level becomes reference
"Relative Position",
"Orientation of Object",
"Orientation of Feature"))) %>%
group_by(condition)%>%
summarise(
Q2.5_closest_to.5 = Q2.5[which.min(abs(Q2.5-.5))],
estimate_closest_to.5 = Estimate[which.min(abs(Q2.5-.5))],
days = age[which.min(abs(Q2.5-.5))],
months = round(days/30.5),
years = round(days/365.25, 2),
monthlabels = as.character(paste(months, "months"))
)
nd2 <- add_colour(nd2)
f2  <- add_colour(f2)
d2  <- add_colour(d2)
p2  <- add_colour(p2)
# Create main plot
main_plot <- ggplot() +
geom_hline(yintercept = 0.5, linetype = "dashed", color = "grey70", alpha = 0.75) +
geom_point(data = d3, aes(x = ageinyears, y = mean, colour = colour), alpha = 0.5, shape = 1, size = 2) +
geom_smooth(data = f3, aes(x = age, y = Estimate, ymin = Q2.5, ymax = Q97.5, fill = colour, colour = colour),
stat = "identity", alpha = 0.2, linewidth = 0.8) +
geom_point(data = p3, aes(x = days/365.25, y = 0.5, fill = colour, colour = colour), size = 4, shape = 21, stroke = 1) +
geom_point(data = p3, aes(x = days/365.25, y = 0.5, fill = "black", colour = "black"), size = 0.5, shape = 21, stroke = 1) +
geom_text(data = p3, aes(label = months, x = days/365.25, y = 0.13, colour = "black", fontface = "bold"),
angle = 90, size = 3.2, vjust = 0.5) +
geom_text(data = p3, aes(label = "months", x = days/365.25, y = .31, colour = "black", fontface = "bold"),
angle = 90, size = 3.2, vjust = 0.5) +
scale_colour_identity() +
scale_fill_identity() +
scale_y_continuous(labels = function(x) paste0(x*100, "%")) + # Multiply by 100 & add %
facet_grid(cols = vars(condition)) +
labs(x = "Age", y = "Proportion Correct") +
coord_cartesian(ylim = c(0, 1), xlim = c(2.7, 7.3)) +   # Allow more Y space for image
theme_minimal(base_size = 13) +
theme(
panel.border = element_rect(colour = "grey30", fill = NA, size = 1),
strip.background = element_rect(colour = "grey30", size = 1),
strip.text = element_text(face = "bold", size = rel(0.8),
margin = margin(t = 5, b = 45)), # HIER STRIPE SPACING via b =
# strip.switch.pad.grid = unit(0, "cm"),
axis.title = element_text(face = "bold", size = rel(0.8)),
axis.text = element_text(size = rel(0.8)),
legend.position = "none",
panel.grid.minor = element_blank()
)
# adding images -----
# load images
image_1 <- image_read(paste0("../illustrations/plotexample ", levels(d3$condition)[1], ".png"))
image_2 <- image_read(paste0("../illustrations/plotexample ", levels(d3$condition)[2], ".png"))
image_3 <- image_read(paste0("../illustrations/plotexample ", levels(d3$condition)[3], ".png"))
image_4 <- image_read(paste0("../illustrations/plotexample ", levels(d3$condition)[4], ".png"))
# create grobs
image_1_grob <- rasterGrob(image_1, interpolate = TRUE)
image_2_grob <- rasterGrob(image_2, interpolate = TRUE)
image_3_grob <- rasterGrob(image_3, interpolate = TRUE)
image_4_grob <- rasterGrob(image_4, interpolate = TRUE)
final_plot <- ggdraw(main_plot) +
draw_grob(image_1_grob, x = 0.071, y = 0.752, width = 0.25, height = 0.15) +
draw_grob(image_2_grob, x = 0.3, y = 0.752, width = 0.25, height = 0.15) +
draw_grob(image_3_grob, x = 0.527, y = 0.752, width = 0.25, height = 0.15) +
draw_grob(image_4_grob, x = 0.755, y = 0.752, width = 0.25, height = 0.15)
# Save  ------------
ggsave(
filename = "../illustrations/plot_study3.png",
plot = final_plot,
device = "png",
width = 8, height = 3.5,
dpi = 300,
units = "in",
bg = "white"
)
# display plot
img <- image_read("../illustrations/plot_study3.png")
windows(width = 15, height = 10)  # On Windows
plot(img)
# Create main plot
main_plot <- ggplot() +
geom_hline(yintercept = 0.5, linetype = "dashed", color = "grey70", alpha = 0.75) +
geom_point(data = d2, aes(x = ageinyears, y = mean, colour = colour), alpha = 0.5, shape = 1, size = 2) +
geom_smooth(data = f2, aes(x = age, y = Estimate, ymin = Q2.5, ymax = Q97.5, fill = colour, colour = colour),
stat = "identity", alpha = 0.2, linewidth = 0.8) +
geom_point(data = p2, aes(x = days/365.25, y = 0.5, fill = colour, colour = colour), size = 4, shape = 21, stroke = 1) +
geom_point(data = p2, aes(x = days/365.25, y = 0.5, fill = "black", colour = "black"), size = 0.5, shape = 21, stroke = 1) +
geom_text(data = p2, aes(label = months, x = days/365.25, y = 0.13, colour = "black", fontface = "bold"),
angle = 90, size = 3.2, vjust = 0.5) +
geom_text(data = p2, aes(label = "months", x = days/365.25, y = .31, colour = "black", fontface = "bold"),
angle = 90, size = 3.2, vjust = 0.5) +
scale_colour_identity() +
scale_fill_identity() +
scale_y_continuous(labels = function(x) paste0(x*100, "%")) + # Multiply by 100 & add %
facet_grid(cols = vars(condition)) +
labs(x = "Age", y = "Proportion Correct") +
coord_cartesian(ylim = c(0, 1), xlim = c(2.7, 7.3)) +   # Allow more Y space for image
theme_minimal(base_size = 13) +
theme(
panel.border = element_rect(colour = "grey30", fill = NA, size = 1),
strip.background = element_rect(colour = "grey30", size = 1),
strip.text = element_text(face = "bold", size = rel(0.8),
margin = margin(t = 5, b = 45)), # HIER STRIPE SPACING via b =
# strip.switch.pad.grid = unit(0, "cm"),
axis.title = element_text(face = "bold", size = rel(0.8)),
axis.text = element_text(size = rel(0.8)),
legend.position = "none",
panel.grid.minor = element_blank()
)
# adding images -----
# load images
image_1 <- image_read(paste0("../illustrations/plotexample ", levels(d2$condition)[1], ".png"))
image_2 <- image_read(paste0("../illustrations/plotexample ", levels(d2$condition)[2], ".png"))
image_3 <- image_read(paste0("../illustrations/plotexample ", levels(d2$condition)[3], ".png"))
image_4 <- image_read(paste0("../illustrations/plotexample ", levels(d2$condition)[4], ".png"))
# create grobs
image_1_grob <- rasterGrob(image_1, interpolate = TRUE)
image_2_grob <- rasterGrob(image_2, interpolate = TRUE)
image_3_grob <- rasterGrob(image_3, interpolate = TRUE)
image_4_grob <- rasterGrob(image_4, interpolate = TRUE)
final_plot <- ggdraw(main_plot) +
draw_grob(image_1_grob, x = 0.071, y = 0.752, width = 0.25, height = 0.15) +
draw_grob(image_2_grob, x = 0.3, y = 0.752, width = 0.25, height = 0.15) +
draw_grob(image_3_grob, x = 0.527, y = 0.752, width = 0.25, height = 0.15) +
draw_grob(image_4_grob, x = 0.755, y = 0.752, width = 0.25, height = 0.15)
# Save  ------------
ggsave(
filename = "../illustrations/plot_study2.png",
plot = final_plot,
device = "png",
width = 8, height = 3.5,
dpi = 300,
units = "in",
bg = "white"
)
# display plot
img <- image_read("../illustrations/plot_study2.png")
windows(width = 15, height = 10)  # On Windows
plot(img)
# Create main plot
main_plot <- ggplot() +
geom_hline(yintercept = 0.5, linetype = "dashed", color = "grey70", alpha = 0.75) +
geom_point(data = d3, aes(x = ageinyears, y = mean, colour = colour), alpha = 0.5, shape = 1, size = 2) +
geom_smooth(data = f3, aes(x = age, y = Estimate, ymin = Q2.5, ymax = Q97.5, fill = colour, colour = colour),
stat = "identity", alpha = 0.2, linewidth = 0.8) +
geom_point(data = p3, aes(x = days/365.25, y = 0.5, fill = colour, colour = colour), size = 4, shape = 21, stroke = 1) +
geom_point(data = p3, aes(x = days/365.25, y = 0.5, fill = "black", colour = "black"), size = 0.5, shape = 21, stroke = 1) +
geom_text(data = p3, aes(label = months, x = days/365.25, y = 0.13, colour = "black", fontface = "bold"),
angle = 90, size = 3.2, vjust = 0.5) +
geom_text(data = p3, aes(label = "months", x = days/365.25, y = .31, colour = "black", fontface = "bold"),
angle = 90, size = 3.2, vjust = 0.5) +
scale_colour_identity() +
scale_fill_identity() +
scale_y_continuous(labels = function(x) paste0(x*100, "%")) + # Multiply by 100 & add %
facet_grid(cols = vars(condition)) +
labs(x = "Age", y = "Proportion Correct") +
coord_cartesian(ylim = c(0, 1), xlim = c(2.7, 7.3)) +   # Allow more Y space for image
theme_minimal(base_size = 13) +
theme(
panel.border = element_rect(colour = "grey30", fill = NA, size = 1),
strip.background = element_rect(colour = "grey30", size = 1),
strip.text = element_text(face = "bold", size = rel(0.8),
margin = margin(t = 5, b = 45)), # HIER STRIPE SPACING via b =
# strip.switch.pad.grid = unit(0, "cm"),
axis.title = element_text(face = "bold", size = rel(0.8)),
axis.text = element_text(size = rel(0.8)),
legend.position = "none",
panel.grid.minor = element_blank()
)
# adding images -----
# load images
image_1 <- image_read(paste0("../illustrations/plotexample ", levels(d3$condition)[1], ".png"))
image_2 <- image_read(paste0("../illustrations/plotexample ", levels(d3$condition)[2], ".png"))
image_3 <- image_read(paste0("../illustrations/plotexample ", levels(d3$condition)[3], ".png"))
image_4 <- image_read(paste0("../illustrations/plotexample ", levels(d3$condition)[4], ".png"))
# create grobs
image_1_grob <- rasterGrob(image_1, interpolate = TRUE)
image_2_grob <- rasterGrob(image_2, interpolate = TRUE)
image_3_grob <- rasterGrob(image_3, interpolate = TRUE)
image_4_grob <- rasterGrob(image_4, interpolate = TRUE)
final_plot <- ggdraw(main_plot) +
draw_grob(image_1_grob, x = 0.071, y = 0.752, width = 0.25, height = 0.15) +
draw_grob(image_2_grob, x = 0.3, y = 0.752, width = 0.25, height = 0.15) +
draw_grob(image_3_grob, x = 0.527, y = 0.752, width = 0.25, height = 0.15) +
draw_grob(image_4_grob, x = 0.755, y = 0.752, width = 0.25, height = 0.15)
# Save  ------------
ggsave(
filename = "../illustrations/plot_study3.png",
plot = final_plot,
device = "png",
width = 8, height = 3.5,
dpi = 300,
units = "in",
bg = "white"
)
# # display plot
# img <- image_read("../illustrations/plot_study3.png")
#
# windows(width = 15, height = 10)  # On Windows
# plot(img)
#
<!-- RESTE ...Backup von alten Versionen -->
