image_3_grob <- rasterGrob(image_3, interpolate = TRUE)
image_4_grob <- rasterGrob(image_4, interpolate = TRUE)
# place images on the plot
library(cowplot)
final_plot <- ggdraw(main_plot) +
draw_grob(image_1_grob, x = 0.07, y = 0.78, width = 0.23, height = 0.13) +
draw_grob(image_2_grob, x = 0.30, y = 0.78, width = 0.23, height = 0.13) +
draw_grob(image_3_grob, x = 0.53, y = 0.78, width = 0.23, height = 0.13) +
draw_grob(image_4_grob, x = 0.76, y = 0.78, width = 0.23, height = 0.13)
# Save correctly
ggsave(
filename = "../illustrations/final_plot.png",
plot = final_plot,   # <- IMPORTANT: plot = main_plot
device = "png",
width = 8, height = 4,
dpi = 300,
units = "in",
bg = "white"
)
# display plot
img <- image_read("../illustrations/final_plot.png")
windows(width = 15, height = 10)  # On Windows
plot(img)
# library(ggplot2)
# library(png)
# library(grid)
# while (!is.null(dev.list())) dev.off()
# Step 1: Load the image file (PNG)
img <- readPNG("../illustrations/plotexample Pars pro Toto.png")
img_grob <- rasterGrob(img, interpolate = TRUE)
# Step 2: Create main plot
main_plot <- ggplot() +
geom_hline(yintercept = 0.5, linetype = "dashed", color = "grey70", alpha = 0.75) +
geom_point(data = d1, aes(x = ageinyears, y = mean, colour = colour), alpha = 0.5, shape = 1, size = 2) +
geom_smooth(data = f1, aes(x = age, y = Estimate, ymin = Q2.5, ymax = Q97.5, fill = colour, colour = colour),
stat = "identity", alpha = 0.2, linewidth = 0.8) +
geom_point(data = p1, aes(x = days/365.25, y = 0.5, fill = colour, colour = colour), size = 3, shape = 21, stroke = 1) +
geom_text(data = p1, aes(label = months, x = days/365.25, y = 0.24, colour = colour),
angle = 90, size = 3.2, vjust = 0.5) +
geom_text(data = p1, aes(label = "months", x = days/365.25, y = 0.38, colour = colour),
angle = 90, size = 3.2, vjust = 0.5) +
scale_colour_identity() +
scale_fill_identity() +
facet_grid(cols = vars(condition)) +
labs(x = "Age", y = "Proportion correct") +
coord_cartesian(ylim = c(0, 1), xlim = c(2.7, 7.3)) +   # Allow more Y space for image
theme_minimal(base_size = 13) +
theme(
# panel.border = element_rect(colour = "grey30", fill = NA, size = 0.8),
# strip.background = element_rect(colour = "grey30", size = 0.8),
panel.border = element_rect(colour = "grey30", fill = NA, size = 0.8),
strip.background = element_blank(),
strip.text = element_text(face = "bold", size = rel(0.8), margin = margin(t = 5, b = 45)),
axis.title = element_text(face = "bold", size = rel(0.8)),
axis.text = element_text(size = rel(0.8)),
legend.position = "none",
panel.grid.minor = element_blank()
)
# load images
image_1 <- image_read(paste0("../illustrations/plotexample ", levels(d1$condition)[1], ".png"))
image_2 <- image_read(paste0("../illustrations/plotexample ", levels(d1$condition)[2], ".png"))
image_3 <- image_read(paste0("../illustrations/plotexample ", levels(d1$condition)[3], ".png"))
image_4 <- image_read(paste0("../illustrations/plotexample ", levels(d1$condition)[4], ".png"))
# create grobs
image_1_grob <- rasterGrob(image_1, interpolate = TRUE)
image_2_grob <- rasterGrob(image_2, interpolate = TRUE)
image_3_grob <- rasterGrob(image_3, interpolate = TRUE)
image_4_grob <- rasterGrob(image_4, interpolate = TRUE)
# place images on the plot
library(cowplot)
final_plot <- ggdraw(main_plot) +
draw_grob(image_1_grob, x = 0.07, y = 0.78, width = 0.23, height = 0.13) +
draw_grob(image_2_grob, x = 0.30, y = 0.78, width = 0.23, height = 0.13) +
draw_grob(image_3_grob, x = 0.53, y = 0.78, width = 0.23, height = 0.13) +
draw_grob(image_4_grob, x = 0.76, y = 0.78, width = 0.23, height = 0.13)
# Save correctly
ggsave(
filename = "../illustrations/final_plot.png",
plot = final_plot,   # <- IMPORTANT: plot = main_plot
device = "png",
width = 8, height = 4,
dpi = 300,
units = "in",
bg = "white"
)
# display plot
img <- image_read("../illustrations/final_plot.png")
windows(width = 15, height = 10)  # On Windows
plot(img)
# library(ggplot2)
# library(png)
# library(grid)
# while (!is.null(dev.list())) dev.off()
# Step 1: Load the image file (PNG)
img <- readPNG("../illustrations/plotexample Pars pro Toto.png")
img_grob <- rasterGrob(img, interpolate = TRUE)
# Step 2: Create main plot
main_plot <- ggplot() +
geom_hline(yintercept = 0.5, linetype = "dashed", color = "grey70", alpha = 0.75) +
geom_point(data = d1, aes(x = ageinyears, y = mean, colour = colour), alpha = 0.5, shape = 1, size = 2) +
geom_smooth(data = f1, aes(x = age, y = Estimate, ymin = Q2.5, ymax = Q97.5, fill = colour, colour = colour),
stat = "identity", alpha = 0.2, linewidth = 0.8) +
geom_point(data = p1, aes(x = days/365.25, y = 0.5, fill = colour, colour = colour), size = 3, shape = 21, stroke = 1) +
geom_text(data = p1, aes(label = months, x = days/365.25, y = 0.24, colour = colour),
angle = 90, size = 3.2, vjust = 0.5) +
geom_text(data = p1, aes(label = "months", x = days/365.25, y = 0.38, colour = colour),
angle = 90, size = 3.2, vjust = 0.5) +
scale_colour_identity() +
scale_fill_identity() +
facet_grid(cols = vars(condition)) +
labs(x = "Age", y = "Proportion correct") +
coord_cartesian(ylim = c(0, 1), xlim = c(2.7, 7.3)) +   # Allow more Y space for image
theme_minimal(base_size = 13) +
theme(
# Only draw left, right, bottom borders on the plot panel
panel.border = element_rect(colour = "grey30", fill = NA, size = 0.8),
strip.background = element_rect(fill = "white", colour = "grey30", size = 0.8),
strip.text = element_text(face = "bold", size = rel(0.8), margin = margin(t = 5, b = 45)),
axis.title = element_text(face = "bold", size = rel(0.8)),
axis.text = element_text(size = rel(0.8)),
legend.position = "none",
panel.grid.minor = element_blank(),
# VERY IMPORTANT: remove vertical spacing between strip and plot
strip.placement = "outside",
panel.spacing.y = unit(0, "pt")
)
# load images
image_1 <- image_read(paste0("../illustrations/plotexample ", levels(d1$condition)[1], ".png"))
image_2 <- image_read(paste0("../illustrations/plotexample ", levels(d1$condition)[2], ".png"))
image_3 <- image_read(paste0("../illustrations/plotexample ", levels(d1$condition)[3], ".png"))
image_4 <- image_read(paste0("../illustrations/plotexample ", levels(d1$condition)[4], ".png"))
# create grobs
image_1_grob <- rasterGrob(image_1, interpolate = TRUE)
image_2_grob <- rasterGrob(image_2, interpolate = TRUE)
image_3_grob <- rasterGrob(image_3, interpolate = TRUE)
image_4_grob <- rasterGrob(image_4, interpolate = TRUE)
# place images on the plot
library(cowplot)
final_plot <- ggdraw(main_plot) +
draw_grob(image_1_grob, x = 0.07, y = 0.78, width = 0.23, height = 0.13) +
draw_grob(image_2_grob, x = 0.30, y = 0.78, width = 0.23, height = 0.13) +
draw_grob(image_3_grob, x = 0.53, y = 0.78, width = 0.23, height = 0.13) +
draw_grob(image_4_grob, x = 0.76, y = 0.78, width = 0.23, height = 0.13)
# Save correctly
ggsave(
filename = "../illustrations/final_plot.png",
plot = final_plot,   # <- IMPORTANT: plot = main_plot
device = "png",
width = 8, height = 4,
dpi = 300,
units = "in",
bg = "white"
)
# display plot
img <- image_read("../illustrations/final_plot.png")
windows(width = 15, height = 10)  # On Windows
plot(img)
# library(ggplot2)
# library(png)
library(grid)
# Step 1: Load the image file (PNG)
img <- readPNG("../illustrations/plotexample Pars pro Toto.png")
img_grob <- rasterGrob(img, interpolate = TRUE)
# Step 2: Create main plot
main_plot <- ggplot() +
geom_hline(yintercept = 0.5, linetype = "dashed", color = "grey70", alpha = 0.75) +
geom_point(data = d1, aes(x = ageinyears, y = mean, colour = colour), alpha = 0.5, shape = 1, size = 2) +
geom_smooth(data = f1, aes(x = age, y = Estimate, ymin = Q2.5, ymax = Q97.5, fill = colour, colour = colour),
stat = "identity", alpha = 0.2, linewidth = 0.8) +
geom_point(data = p1, aes(x = days/365.25, y = 0.5, fill = colour, colour = colour), size = 3, shape = 21, stroke = 1) +
geom_text(data = p1, aes(label = months, x = days/365.25, y = 0.24, colour = colour),
angle = 90, size = 3.2, vjust = 0.5) +
geom_text(data = p1, aes(label = "months", x = days/365.25, y = 0.38, colour = colour),
angle = 90, size = 3.2, vjust = 0.5) +
scale_colour_identity() +
scale_fill_identity() +
facet_grid(cols = vars(condition)) +
labs(x = "Age", y = "Proportion correct") +
coord_cartesian(ylim = c(0, 1), xlim = c(2.7, 7.3)) +   # Allow more Y space for image
theme_minimal(base_size = 13) +
theme(
# Only draw left, right, bottom borders on the plot panel
panel.border = element_rect(colour = "grey30", fill = NA, size = 0.8),
strip.background = element_rect(fill = "white", colour = "grey30", size = 0.8),
strip.text = element_text(face = "bold", size = rel(0.8), margin = margin(t = 5, b = 45)),
axis.title = element_text(face = "bold", size = rel(0.8)),
axis.text = element_text(size = rel(0.8)),
legend.position = "none",
panel.grid.minor = element_blank(),
# VERY IMPORTANT: remove vertical spacing between strip and plot
strip.placement = "outside",
panel.spacing.y = unit(0, "pt")
)
# load images
image_1 <- image_read(paste0("../illustrations/plotexample ", levels(d1$condition)[1], ".png"))
image_2 <- image_read(paste0("../illustrations/plotexample ", levels(d1$condition)[2], ".png"))
image_3 <- image_read(paste0("../illustrations/plotexample ", levels(d1$condition)[3], ".png"))
image_4 <- image_read(paste0("../illustrations/plotexample ", levels(d1$condition)[4], ".png"))
main_plot
# library(ggplot2)
# library(png)
library(grid)
# while (!is.null(dev.list())) dev.off()
# Step 1: Load the image file (PNG)
img <- readPNG("../illustrations/plotexample Pars pro Toto.png")
img_grob <- rasterGrob(img, interpolate = TRUE)
# Step 2: Create main plot
main_plot <- ggplot() +
geom_hline(yintercept = 0.5, linetype = "dashed", color = "grey70", alpha = 0.75) +
geom_point(data = d1, aes(x = ageinyears, y = mean, colour = colour), alpha = 0.5, shape = 1, size = 2) +
geom_smooth(data = f1, aes(x = age, y = Estimate, ymin = Q2.5, ymax = Q97.5, fill = colour, colour = colour),
stat = "identity", alpha = 0.2, linewidth = 0.8) +
geom_point(data = p1, aes(x = days/365.25, y = 0.5, fill = colour, colour = colour), size = 3, shape = 21, stroke = 1) +
geom_text(data = p1, aes(label = months, x = days/365.25, y = 0.24, colour = colour),
angle = 90, size = 3.2, vjust = 0.5) +
geom_text(data = p1, aes(label = "months", x = days/365.25, y = 0.38, colour = colour),
angle = 90, size = 3.2, vjust = 0.5) +
scale_colour_identity() +
scale_fill_identity() +
facet_grid(cols = vars(condition)) +
labs(x = "Age", y = "Proportion correct") +
coord_cartesian(ylim = c(0, 1), xlim = c(2.7, 7.3)) +   # Allow more Y space for image
theme_minimal(base_size = 13) +
theme(
panel.border = element_rect(colour = "grey30", fill = NA, size = 0.8),
strip.background = element_rect(fill = "white", colour = "grey30", size = 0.8),
strip.text = element_text(face = "bold", size = rel(0.8), margin = margin(t = 0, b = 0)),
axis.title = element_text(face = "bold", size = rel(0.8)),
axis.text = element_text(size = rel(0.8)),
legend.position = "none",
panel.grid.minor = element_blank(),
strip.placement = "outside",
panel.spacing.y = unit(0, "pt")
)
# load images
image_1 <- image_read(paste0("../illustrations/plotexample ", levels(d1$condition)[1], ".png"))
image_2 <- image_read(paste0("../illustrations/plotexample ", levels(d1$condition)[2], ".png"))
image_3 <- image_read(paste0("../illustrations/plotexample ", levels(d1$condition)[3], ".png"))
image_4 <- image_read(paste0("../illustrations/plotexample ", levels(d1$condition)[4], ".png"))
# create grobs
image_1_grob <- rasterGrob(image_1, interpolate = TRUE)
image_2_grob <- rasterGrob(image_2, interpolate = TRUE)
image_3_grob <- rasterGrob(image_3, interpolate = TRUE)
image_4_grob <- rasterGrob(image_4, interpolate = TRUE)
# place images on the plot
library(cowplot)
final_plot <- ggdraw(main_plot) +
draw_grob(image_1_grob, x = 0.07, y = 0.78, width = 0.23, height = 0.13) +
draw_grob(image_2_grob, x = 0.30, y = 0.78, width = 0.23, height = 0.13) +
draw_grob(image_3_grob, x = 0.53, y = 0.78, width = 0.23, height = 0.13) +
draw_grob(image_4_grob, x = 0.76, y = 0.78, width = 0.23, height = 0.13)
# Save correctly
ggsave(
filename = "../illustrations/final_plot.png",
plot = final_plot,   # <- IMPORTANT: plot = main_plot
device = "png",
width = 8, height = 4,
dpi = 300,
units = "in",
bg = "white"
)
# display plot
img <- image_read("../illustrations/final_plot.png")
windows(width = 15, height = 10)  # On Windows
plot(img)
# library(ggplot2)
# library(png)
library(grid)
# while (!is.null(dev.list())) dev.off()
# Step 1: Load the image file (PNG)
img <- readPNG("../illustrations/plotexample Pars pro Toto.png")
img_grob <- rasterGrob(img, interpolate = TRUE)
# Step 2: Create main plot
main_plot <- ggplot() +
geom_hline(yintercept = 0.5, linetype = "dashed", color = "grey70", alpha = 0.75) +
geom_point(data = d1, aes(x = ageinyears, y = mean, colour = colour), alpha = 0.5, shape = 1, size = 2) +
geom_smooth(data = f1, aes(x = age, y = Estimate, ymin = Q2.5, ymax = Q97.5, fill = colour, colour = colour),
stat = "identity", alpha = 0.2, linewidth = 0.8) +
geom_point(data = p1, aes(x = days/365.25, y = 0.5, fill = colour, colour = colour), size = 3, shape = 21, stroke = 1) +
geom_text(data = p1, aes(label = months, x = days/365.25, y = 0.24, colour = colour),
angle = 90, size = 3.2, vjust = 0.5) +
geom_text(data = p1, aes(label = "months", x = days/365.25, y = 0.38, colour = colour),
angle = 90, size = 3.2, vjust = 0.5) +
scale_colour_identity() +
scale_fill_identity() +
facet_grid(cols = vars(condition)) +
labs(x = "Age", y = "Proportion correct") +
coord_cartesian(ylim = c(0, 1), xlim = c(2.7, 7.3)) +   # Allow more Y space for image
theme_minimal(base_size = 13) +
theme(
panel.border = element_rect(colour = "grey30", fill = NA, size = 0.8),
strip.background = element_rect(colour = "grey30", size = 0.8),
strip.text = element_text(face = "bold", size = rel(0.8), margin = margin(t = 5, b = 45)),
axis.title = element_text(face = "bold", size = rel(0.8)),
axis.text = element_text(size = rel(0.8)),
legend.position = "none",
panel.grid.minor = element_blank()
)
# load images
image_1 <- image_read(paste0("../illustrations/plotexample ", levels(d1$condition)[1], ".png"))
image_2 <- image_read(paste0("../illustrations/plotexample ", levels(d1$condition)[2], ".png"))
image_3 <- image_read(paste0("../illustrations/plotexample ", levels(d1$condition)[3], ".png"))
image_4 <- image_read(paste0("../illustrations/plotexample ", levels(d1$condition)[4], ".png"))
# create grobs
image_1_grob <- rasterGrob(image_1, interpolate = TRUE)
image_2_grob <- rasterGrob(image_2, interpolate = TRUE)
image_3_grob <- rasterGrob(image_3, interpolate = TRUE)
image_4_grob <- rasterGrob(image_4, interpolate = TRUE)
# place images on the plot
library(cowplot)
final_plot <- ggdraw(main_plot) +
draw_grob(image_1_grob, x = 0.07, y = 0.78, width = 0.23, height = 0.13) +
draw_grob(image_2_grob, x = 0.30, y = 0.78, width = 0.23, height = 0.13) +
draw_grob(image_3_grob, x = 0.53, y = 0.78, width = 0.23, height = 0.13) +
draw_grob(image_4_grob, x = 0.76, y = 0.78, width = 0.23, height = 0.13)
# Save correctly
ggsave(
filename = "../illustrations/final_plot.png",
plot = final_plot,   # <- IMPORTANT: plot = main_plot
device = "png",
width = 8, height = 4,
dpi = 300,
units = "in",
bg = "white"
)
# display plot
img <- image_read("../illustrations/final_plot.png")
windows(width = 15, height = 10)  # On Windows
plot(img)
img
# library(ggplot2)
# library(png)
library(grid)
# while (!is.null(dev.list())) dev.off()
# Step 1: Load the image file (PNG)
img <- readPNG("../illustrations/plotexample Pars pro Toto.png")
img_grob <- rasterGrob(img, interpolate = TRUE)
# Step 2: Create main plot
main_plot <- ggplot() +
geom_hline(yintercept = 0.5, linetype = "dashed", color = "grey70", alpha = 0.75) +
geom_point(data = d1, aes(x = ageinyears, y = mean, colour = colour), alpha = 0.5, shape = 1, size = 2) +
geom_smooth(data = f1, aes(x = age, y = Estimate, ymin = Q2.5, ymax = Q97.5, fill = colour, colour = colour),
stat = "identity", alpha = 0.2, linewidth = 0.8) +
geom_point(data = p1, aes(x = days/365.25, y = 0.5, fill = colour, colour = colour), size = 3, shape = 21, stroke = 1) +
geom_text(data = p1, aes(label = months, x = days/365.25, y = 0.24, colour = colour),
angle = 90, size = 3.2, vjust = 0.5) +
geom_text(data = p1, aes(label = "months", x = days/365.25, y = 0.38, colour = colour),
angle = 90, size = 3.2, vjust = 0.5) +
scale_colour_identity() +
scale_fill_identity() +
facet_grid(cols = vars(condition)) +
labs(x = "Age", y = "Proportion correct") +
coord_cartesian(ylim = c(0, 1), xlim = c(2.7, 7.3)) +   # Allow more Y space for image
theme_minimal(base_size = 13) +
theme(
panel.border = element_rect(colour = "grey30", fill = NA, size = 0.8),
strip.background = element_rect(colour = "grey30", size = 0.8),
strip.text = element_text(face = "bold", size = rel(0.8), margin = margin(t = 5, b = 45)),
axis.title = element_text(face = "bold", size = rel(0.8)),
axis.text = element_text(size = rel(0.8)),
legend.position = "none",
panel.grid.minor = element_blank()
)
main_plot
# library(ggplot2)
# library(png)
library(grid)
# while (!is.null(dev.list())) dev.off()
# Step 1: Load the image file (PNG)
img <- readPNG("../illustrations/plotexample Pars pro Toto.png")
img_grob <- rasterGrob(img, interpolate = TRUE)
# Step 2: Create main plot
main_plot <- ggplot() +
geom_hline(yintercept = 0.5, linetype = "dashed", color = "grey70", alpha = 0.75) +
geom_point(data = d1, aes(x = ageinyears, y = mean, colour = colour), alpha = 0.5, shape = 1, size = 2) +
geom_smooth(data = f1, aes(x = age, y = Estimate, ymin = Q2.5, ymax = Q97.5, fill = colour, colour = colour),
stat = "identity", alpha = 0.2, linewidth = 0.8) +
geom_point(data = p1, aes(x = days/365.25, y = 0.5, fill = colour, colour = colour), size = 3, shape = 21, stroke = 1) +
geom_text(data = p1, aes(label = months, x = days/365.25, y = 0.24, colour = colour),
angle = 90, size = 3.2, vjust = 0.5) +
geom_text(data = p1, aes(label = "months", x = days/365.25, y = 0.38, colour = colour),
angle = 90, size = 3.2, vjust = 0.5) +
scale_colour_identity() +
scale_fill_identity() +
facet_grid(cols = vars(condition)) +
labs(x = "Age", y = "Proportion correct") +
coord_cartesian(ylim = c(0, 1), xlim = c(2.7, 7.3)) +   # Allow more Y space for image
# theme_minimal(base_size = 13) +
# theme(
#   panel.border = element_rect(colour = "grey30", fill = NA, size = 0.8),
#   strip.background = element_rect(colour = "grey30", size = 0.8),
#   strip.text = element_text(face = "bold", size = rel(0.8), margin = margin(t = 5, b = 45)),
#   axis.title = element_text(face = "bold", size = rel(0.8)),
#   axis.text = element_text(size = rel(0.8)),
#   legend.position = "none",
#   panel.grid.minor = element_blank()
# )
theme_minimal(base_size = 13) +
theme(
panel.border = element_rect(colour = "grey30", fill = NA, size = 0.8),
strip.background = element_rect(colour = "grey30", fill = NA, size = 0.8),  # <- also set fill = NA!
strip.text = element_text(face = "bold", size = rel(0.8), margin = margin(t = 0, b = 0)),  # <- remove strip margins
strip.placement = "outside",  # <- ensure strip is tightly on top
strip.switch.pad.grid = unit(0, "cm"),  # <- remove extra padding
axis.title = element_text(face = "bold", size = rel(0.8)),
axis.text = element_text(size = rel(0.8)),
legend.position = "none",
panel.grid.minor = element_blank()
)
main_plot
# library(ggplot2)
# library(png)
library(grid)
# while (!is.null(dev.list())) dev.off()
# Step 1: Load the image file (PNG)
img <- readPNG("../illustrations/plotexample Pars pro Toto.png")
img_grob <- rasterGrob(img, interpolate = TRUE)
# Step 2: Create main plot
main_plot <- ggplot() +
geom_hline(yintercept = 0.5, linetype = "dashed", color = "grey70", alpha = 0.75) +
geom_point(data = d1, aes(x = ageinyears, y = mean, colour = colour), alpha = 0.5, shape = 1, size = 2) +
geom_smooth(data = f1, aes(x = age, y = Estimate, ymin = Q2.5, ymax = Q97.5, fill = colour, colour = colour),
stat = "identity", alpha = 0.2, linewidth = 0.8) +
geom_point(data = p1, aes(x = days/365.25, y = 0.5, fill = colour, colour = colour), size = 3, shape = 21, stroke = 1) +
geom_text(data = p1, aes(label = months, x = days/365.25, y = 0.24, colour = colour),
angle = 90, size = 3.2, vjust = 0.5) +
geom_text(data = p1, aes(label = "months", x = days/365.25, y = 0.38, colour = colour),
angle = 90, size = 3.2, vjust = 0.5) +
scale_colour_identity() +
scale_fill_identity() +
facet_grid(cols = vars(condition)) +
labs(x = "Age", y = "Proportion correct") +
coord_cartesian(ylim = c(0, 1), xlim = c(2.7, 7.3)) +   # Allow more Y space for image
theme_minimal(base_size = 13) +
theme(
panel.border = element_rect(colour = "grey30", fill = NA, size = 0.8),
strip.background = element_rect(colour = "grey30", size = 0.8),
strip.text = element_text(face = "bold", size = rel(0.8),
margin = margin(t = 5, b = 45)),
strip.switch.pad.grid = unit(0, "cm"),
axis.title = element_text(face = "bold", size = rel(0.8)),
axis.text = element_text(size = rel(0.8)),
legend.position = "none",
panel.grid.minor = element_blank()
)
main_plot
# library(ggplot2)
# library(png)
library(grid)
# while (!is.null(dev.list())) dev.off()
# Step 1: Load the image file (PNG)
img <- readPNG("../illustrations/plotexample Pars pro Toto.png")
img_grob <- rasterGrob(img, interpolate = TRUE)
# Step 2: Create main plot
main_plot <- ggplot() +
geom_hline(yintercept = 0.5, linetype = "dashed", color = "grey70", alpha = 0.75) +
geom_point(data = d1, aes(x = ageinyears, y = mean, colour = colour), alpha = 0.5, shape = 1, size = 2) +
geom_smooth(data = f1, aes(x = age, y = Estimate, ymin = Q2.5, ymax = Q97.5, fill = colour, colour = colour),
stat = "identity", alpha = 0.2, linewidth = 0.8) +
geom_point(data = p1, aes(x = days/365.25, y = 0.5, fill = colour, colour = colour), size = 3, shape = 21, stroke = 1) +
geom_text(data = p1, aes(label = months, x = days/365.25, y = 0.24, colour = colour),
angle = 90, size = 3.2, vjust = 0.5) +
geom_text(data = p1, aes(label = "months", x = days/365.25, y = 0.38, colour = colour),
angle = 90, size = 3.2, vjust = 0.5) +
scale_colour_identity() +
scale_fill_identity() +
facet_grid(cols = vars(condition)) +
labs(x = "Age", y = "Proportion correct") +
coord_cartesian(ylim = c(0, 1), xlim = c(2.7, 7.3)) +   # Allow more Y space for image
theme_minimal(base_size = 13) +
theme(
panel.border = element_rect(colour = "grey30", fill = NA, size = 0.8),
strip.background = element_rect(colour = "grey30", size = 0.8),
strip.text = element_text(face = "bold", size = rel(0.8),
margin = margin(t = 5, b = 45)),
strip.switch.pad.grid = unit(0, "cm"),
axis.title = element_text(face = "bold", size = rel(0.8)),
axis.text = element_text(size = rel(0.8)),
legend.position = "none",
panel.grid.minor = element_blank()
)
# load images
image_1 <- image_read(paste0("../illustrations/plotexample ", levels(d1$condition)[1], ".png"))
image_2 <- image_read(paste0("../illustrations/plotexample ", levels(d1$condition)[2], ".png"))
image_3 <- image_read(paste0("../illustrations/plotexample ", levels(d1$condition)[3], ".png"))
image_4 <- image_read(paste0("../illustrations/plotexample ", levels(d1$condition)[4], ".png"))
# create grobs
image_1_grob <- rasterGrob(image_1, interpolate = TRUE)
image_2_grob <- rasterGrob(image_2, interpolate = TRUE)
image_3_grob <- rasterGrob(image_3, interpolate = TRUE)
image_4_grob <- rasterGrob(image_4, interpolate = TRUE)
# place images on the plot
library(cowplot)
final_plot <- ggdraw(main_plot) +
draw_grob(image_1_grob, x = 0.07, y = 0.78, width = 0.23, height = 0.13) +
draw_grob(image_2_grob, x = 0.30, y = 0.78, width = 0.23, height = 0.13) +
draw_grob(image_3_grob, x = 0.53, y = 0.78, width = 0.23, height = 0.13) +
draw_grob(image_4_grob, x = 0.76, y = 0.78, width = 0.23, height = 0.13)
# Save correctly
ggsave(
filename = "../illustrations/final_plot.png",
plot = final_plot,   # <- IMPORTANT: plot = main_plot
device = "png",
width = 8, height = 4,
dpi = 300,
units = "in",
bg = "white"
)
# display plot
img <- image_read("../illustrations/final_plot.png")
windows(width = 15, height = 10)  # On Windows
plot(img)
