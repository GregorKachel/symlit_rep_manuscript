---
title             : "Young Children’s Spontaneous Comprehension of Symbol-Referent Relationships in the Graphic Domain"
shorttitle        : "Comprehension of Graphic Symbol-Referent Relationships"
author: 
  - name          : "Gregor Kachel"
    affiliation   : "1"
    corresponding : yes    # Define only one corresponding author
    address       : "Universitätsallee 1, C1.008a, 21335 Lüneburg"
    email         : "gregor.kachel&#64;leuphana.de"
    role: # Contributorship roles (e.g., CRediT, https://credit.niso.org/)
      - "Conceptualization"
      - "Funding Acquisition"
      - "Project Administration"
      - "Investigation"
      - "Methodology"
      - "Data Curation"
      - "Formal Analysis"
      - "Visualization"
      - "Writing - Original Draft Preparation"
      - "Writing - Review & Editing"
  - name          : "Daniel Haun"
    affiliation   : "2"
    role:
      - "Resources"
      - "Writing - Review & Editing"
  - name          : "Manuel Bohn"
    affiliation   : "1"
    role:
      - "Methodology"
      - "Software"
      - "Formal Analysis"
      - "Validation"
      - "Writing - Review & Editing"
      - "Supervision"
affiliation:
  - id            : "1"
    institution   : "Leuphana University"
  - id            : "2"
    institution   : "Max-Planck-Institute for Evolutionary Anthropology"
note: "\\clearpage"
authornote: |
    
    
    *Ethics, consent and conflict of interest*: This study confirms with recognized standards (e.g. the Declaration of Helsinki) and was approved by an internal ethics committee at the Max-Planck-Institute for Evolutionary Anthropology. Informed consent has been obtained from all participants. The authors declare no conflict of interest. 
    
    *Scientific Integrity and Openness*: The data and code necessary to reproduce the analyses presented here are publicly accessible, as are the materials necessary to attempt to replicate the findings. Analyses were also pre-registered. Data, code, materials, and the preregistration for this research are available at the following XXXLINKXXX.
    
    *Acknowledgments*: We are thankful to Susanne Mauritz for her help in the organization of the study and to Valerie Jurgenson and Cynthia Pones for help with data collection. We would like to thank Anne Deiglmayr for hosting this project in her research group and for her continuous support. Finally, we are very thankful to all parents and children participating in the study. Gregor Kachel was supported by the German Research Foundation (Deutsche Forschungsgemeinschaft) under project number 429220405.

abstract: |
  The developmental literature testifies to young children’s remarkable communicative skills in language and gesture, but much less is known about the domain of graphical communication. In three coordinated studies with identical procedures, young children’s ability to spontaneously comprehend unfamiliar graphic symbols was tested in a simple object-choice task across a wide variety of symbol-referent relationships. In four conditions per study, reference was established via representation, part-whole relationships, analogies in size, number and form but also gestalt-like principles such as orientation, alignment or figure-ground relationships. The samples comprise German-speaking children continuously spread from the third to the seventh birthday (Study 1, N = 106; Study 2, N = 99; Study 3, N = 99). While children are generally able to use direct representations to identify the correct target item already prior to their third birthday, group-level success in all other conditions was observed later, but well before school age. Converging results from conditions employing several abstract and conceptual symbol-referent relationships point to a qualitative shift in symbolic competence around the fourth birthday. Together, this set of studies explores the conceptual continuum from iconic to abstract graphical representations and, therein, provides one of the most comprehensive, robust and systematic investigations of young children’s ability to find meaning in unfamiliar graphic symbols - a largely unexplored component of emerging literacy.
  
keywords          : "Graphic Communication, Iconicity, Analogical Reasoning, Gestalt Principles, Pragmatics, Emerging Literacy, Symbolic Literacy, Symbol-Referent-Relationship"
wordcount         : "Child Development Max 40 pages"
bibliography      : ["library.bib"]
floatsintext      : no
linenumbers       : yes
draft             : no
mask              : no
figurelist        : no
tablelist         : no
footnotelist      : no
output:
  papaja::apa6_doc: default
    
appendix: # to change filenames, also see end of document
- "appendix_a_participants.Rmd"
- "appendix_b_results.Rmd"
- "appendix_c_additional.Rmd"

editor_options: 
  markdown: 
    wrap: 72
---

<!-- Packages, Setup, Read data for all studies, and prepare for analyses -->

```{r setup, include = FALSE}
library("papaja")
r_refs("library.bib")

# NOTE; how to push title, authornotes and abstract 
# note: "\\clearpage"


# Loading packages 
# NOTE: this will install these packages in case they are missing

# General
if (!require(tidyverse)) install.packages('tidyverse'); library(tidyverse)
if (!require(lsr)) install.packages('lsr'); library(lsr) # Analysis, Cohen's D
if (!require(ggthemes)) install.packages('ggthemes'); library(ggthemes) # for tufte boxplots
# if (!require(kableExtra)) install.packages('kableExtra'); library(kableExtra) 

# plotting graphic
library(patchwork)
library(cowplot)
library(magick)

# Styling library(flextable)
if (!require(flextable)) install.packages('flextable'); library(flextable) 

# bayes packages
if (!require(brms)) install.packages('brms'); library(brms) # 
if (!require(tidybayes)) install.packages('tidybayes'); library(tidybayes) # 
if (!require(HDInterval)) install.packages('HDInterval'); library(HDInterval) # 
if (!require(posterior)) install.packages('posterior'); library(posterior) # 

# basic analyses
if (!require(scales)) install.packages('scales'); library(scales) # 

# plotting
## ggplot via tidyverse
if (!require(cowplot)) install.packages('cowplot'); library(cowplot) # 
if (!require(png)) install.packages('png'); library(png) # 
if (!require(grid)) install.packages('grid'); library(grid) # 

# Troubleshooting Knitting Document
# might be required for knitting manuscript
# install.packages('tinytex')
# tinytex::install_tinytex()
# 
# tinytex::tlmgr_update()
# tinytex::reinstall_tinytex()

# Seed for random number generation
set.seed(42)
knitr::opts_chunk$set(cache.extra = knitr::rand_seed)


```

```{r rep_read_data, include = FALSE}

# Full data set including all participants (i.e. including dropped participants)
rep.data <- readRDS("../data/symlitrep_final_data.rds")

# test  <- rep.data %>%
#   #filter(valid != "drop") %>% # valid participants only 
#   filter(trial != "fam") %>% 
#   group_by(subid, agem) %>% 
#   summarize(participants = n_distinct(subid),
#             trials = n())

# Study1 
rep.S1.bayes.data  <- rep.data %>%
  filter(valid != "drop") %>% # valid participants only 
  filter(study == "study1") %>% # in study one
  filter(trial != "fam") %>% 
  select(condition, subid, sex, aged, agey, agem, correct, trial, rt, cue) %>%
  mutate(condition = factor(condition, levels = c(
        "Representation", # first level becomes reference
        "Pars Pro Toto", 
        "Simple Form Analogy", 
        "Complex Form Analogy"))) %>%  
  mutate(sex = factor(sex, levels = c(
        "0", # first level becomes reference
        "1"))) %>%  
  mutate(z.trial = scale(as.numeric(trial)),
         ageinyears = aged/365.25, 
         z.age = ageinyears - mean(ageinyears),
         z.sex = scale(as.numeric(sex))) %>% 
  mutate(item = gsub("_A.png", "", cue)) %>% 
  mutate(item = gsub("_B.png", "", item)) 

# Study2
rep.S2.bayes.data  <- rep.data %>%
  filter(valid != "drop") %>% # valid participants only 
  filter(study == "study2") %>% # in study two
  filter(trial != "fam") %>% 
  select(condition, subid, sex, aged, agey, agem, correct, trial, rt, cue) %>%
  mutate(condition = factor(condition, levels = c(
        "Absolute Position", # first level becomes reference
        "Relative Position", 
        "Orientation of Object", 
        "Orientation of Feature"))) %>%  
  mutate(sex = factor(sex, levels = c(
        "0", # first level becomes reference
        "1"))) %>%  
  mutate(z.trial = scale(as.numeric(trial)),
         ageinyears = aged/365.25, 
         z.age = ageinyears - mean(ageinyears),
         z.sex = scale(as.numeric(sex))) %>% 
  mutate(item = gsub("_A.png", "", cue)) %>% 
  mutate(item = gsub("_B.png", "", item)) 

# Study 3 
rep.S3.bayes.data  <- rep.data %>%
  filter(valid != "drop") %>% # valid participants only 
  filter(study == "study3") %>% # in study two
  filter(trial != "fam") %>% 
  select(condition, subid, sex, aged, agey, agem, correct, trial, rt, cue) %>%
  mutate(condition = factor(condition, levels = c(
        "Size of Object", # first level becomes reference
        "Size of Feature", 
        "Number of Object", 
        "Number of Feature"))) %>%  
  mutate(sex = factor(sex, levels = c(
        "0", # first level becomes reference
        "1"))) %>%  
  mutate(z.trial = scale(as.numeric(trial)),
         ageinyears = aged/365.25, 
         z.age = ageinyears - mean(ageinyears),
         z.sex = scale(as.numeric(sex))) %>% 
  mutate(item = gsub("_A.png", "", cue)) %>% 
  mutate(item = gsub("_B.png", "", item)) 

# test <- rep.data %>%
#   filter(valid != "drop") %>%
#   group_by(study) %>%
#   summarize(min_Age = min(agem))

# test <- rep.data %>% 
#   filter(valid != "drop") %>% 
#   group_by(study, condition) %>% 
#   summarize(N = length(subid))


```

```{r S1S2s3_colours, echo=FALSE, eval=T}
#
add_colour <- function(df) {
  df %>%
    mutate(colour = case_when(
      condition == "Representation" ~ "#00441b",
      condition == "Pars Pro Toto" ~ "#238b45",
      condition == "Simple Form Analogy" ~ "#cc4c02",
      condition == "Complex Form Analogy" ~ "#ff9609",
      condition == "Absolute Position" ~ "#084081",
      condition == "Relative Position" ~ "#2b8cbe",
      condition == "Orientation of Object" ~ "#7B3F00",
      condition == "Orientation of Feature" ~ "#B55239",
      condition == "Size of Object" ~ "#2E004F", 
      condition == "Size of Feature" ~ "#9370DB",
      condition == "Number of Object" ~ "#67000d",
      condition == "Number of Feature" ~ "#cb181d",
      TRUE ~ NA_character_
    ))
}

# condition_colours_df <- data.frame(
#   condition = c(
#     # study1
#     "Representation", 
#     "Pars Pro Toto", 
#     "Simple Form Analogy", 
#     "Complex Form Analogy",
#     # study 2
#     "Absolute Position", 
#     "Relative Position", 
#     "Orientation of Object", 
#     "Orientation of Feature",
#     # study3
#     "Size of Object", 
#     "Size of Feature",
#     "Number of Object", 
#     "Number of Feature"),
#   colour = c(
#     # study1
#     "#006400", "#79e000", "#ff9609", "#ffc512",
#     # study2
#     "#4B0082", "#6A5ACD", "#8B0000", "#A0522D",
#     # study3
#     "#191970", "#008080", "#800080", "#8B008B"
#   ),
#   stringsAsFactors = F
# )
# 
# # Function to add colour using left_join
# add_colour <- function(df) {
#   df %>% 
#     left_join(condition_colours_df, by = "condition")
# }

# condition_colours <- c(
#   "Representation" = "#006400",  # Dark Green
#   "Pars Pro Toto" = "#79e000",    # Forest Green
#   "Simple Form Analogy" = "#ff9609",  
#   "Complex Form Analogy" = "#ffc512", 
#   "Absolute Position" = "#4B0082",    # Indigo (dark purple)
#   "Relative Position" = "#6A5ACD",    # Slate Blue
#   "Orientation of Object" = "#8B0000", # Dark Red
#   "Orientation of Feature" = "#A0522D", # Sienna (dark orange-brown)
#   "Size of Object" = "#191970",        # Midnight Blue
#   "Size of Feature" = "#008080",       # Teal
#   "Number of Object" = "#800080",      # Purple
#   "Number of Feature" = "#8B008B"       # Dark Magenta
# )

```

<!-- Prepare Demographics -->

```{r S1S2s3_participant_demographics, echo=F, eval=T}

rep.age.table.data  <- rep.data %>% 
  distinct(subid, .keep_all = TRUE) %>% # select only one line per participant
  filter(valid != "drop") %>%  # filter out dropped participants
  group_by(study) %>% 
  summarize(
    N = length(subid),
    female = sum(sex=="0"),
    Mean = mean(agem),
    Min = min(agem),
    Max = max(agem),
    SD = round(sd(agem), 2),
    N_daycare = length(subid[where == "daycare"]),
    N_lab = length(subid[where == "lab"]),
    N_home = length(subid[where == "home"]),
    N_hort = length(subid[where == "afterschoolcenter"]))

rep.age.table.data <- data.frame(rep.age.table.data, row.names = "study")

rep.drop.table.data  <- rep.data %>%
  distinct(subid, .keep_all = TRUE) %>% # select only one line per participant
  filter(valid == "drop") %>%
  group_by(study) %>%
  summarize(
    N = length(subid),
    female = sum(sex=="0"),
    Mean = mean(agem),
    Min = min(agem),
    Max = max(agem),
    fail_in_fam = length(subid[drop == "fail_in_fam"]),
    quit_early = length(subid[drop == "quit_early"]),
    fussy_child = length(subid[drop == "fussy_child"]),
    language = length(subid[drop == "language"]),
    technical = length(subid[drop == "technical"]))

rep.drop.table.data <- data.frame(rep.drop.table.data, row.names = "study")

# Count trials by conditions
rep.s1.trials <- rep.S1.bayes.data %>% 
  group_by(condition) %>% 
  summarize(
    Trials = n(),                
    N = n_distinct(subid))

rep.s2.trials <- rep.S2.bayes.data %>% 
  group_by(condition) %>% 
  summarize(
    Trials = n(),                
    N = n_distinct(subid))

rep.s3.trials <- rep.S3.bayes.data %>% 
  group_by(condition) %>% 
  summarize(
    Trials = n(),                
    N = n_distinct(subid))

```

```{r plot-participants-dots, echo = F, warning=F}

age.plot.data <- rep.data %>% #select data
  distinct(subid, .keep_all = TRUE) %>% # select only one line per participant
  filter(valid != "drop")  %>%
  mutate(sex = as.factor(sex))  %>%
  mutate(sex = fct_recode(sex, "female" = "0","male"="1")) %>% 
  rename(Sex = sex) %>% 
  mutate(study = case_when(
    study == "study1" ~ "Study 1",
    study == "study2" ~ "Study 2",
    study == "study3" ~ "Study 3",
    TRUE ~ NA_character_))

age.plot <- ggplot(age.plot.data, aes(x = agem, fill = Sex)) +
  geom_dotplot(stackgroups = TRUE, binwidth = 1, binpositions = "all") +  
  coord_fixed(ratio = 4, xlim = c(36, 84), ylim = c(0, 1.01)) +  # combine here
  theme_bw() +
  scale_x_continuous(name = "Age in Months", breaks = seq(36, 84, 12), minor_breaks = seq(36, 84, 1)) +
  scale_y_continuous(name = "Participants", breaks = NULL) +
  facet_wrap(~ study, ncol = 1) +
  labs(fill = NULL) +
  guides(fill = guide_legend(ncol =2, byrow = TRUE)) +  
  theme_minimal() +
  theme(
    base_size = 13,
    panel.grid.minor.x = element_line(linewidth = 0.25, linetype = 2),
    panel.grid.major.x = element_line(linewidth = 1, linetype = 1),
    panel.border = element_rect(colour = "grey30", fill = NA, linewidth = 1),
    strip.background = element_rect(colour = "grey30", size = 1),
    strip.text = element_text(face = "bold", size = rel(.9), 
                              margin = margin(t = 5, b = 8)),
    axis.title = element_text(face = "bold", size = rel(.9)),
    axis.text = element_text(size = rel(0.8)),
    legend.position = c(1, -0.06),              
    legend.justification = c(1, 1),
    legend.text = element_text(size = rel(.9)),
    panel.grid.minor = element_blank()
  )

ggsave(
  filename = "../illustrations/plot_supp_participants_S123.png",
  plot = age.plot,
  device = "png",
  width = 9.5, height = 6,
  dpi = 300,
  units = "in",
  bg = "white")
# 
# # display plot
# img <- image_read("../illustrations/plot_participants_S123.png")
# 
# windows(width = 15, height = 10)  # On Windows
# plot(img)



```

```{r plot-exclusions-dots, echo = F, warning=F}

drop.plot.data <- rep.data %>% #select data
  distinct(subid, .keep_all = TRUE) %>% # select only one line per participant
  filter(valid == "drop") %>% 
  mutate(study = case_when(
    study == "study1" ~ "Study 1",
    study == "study2" ~ "Study 2",
    study == "study3" ~ "Study 3",
    TRUE ~ NA_character_)) %>% 
  mutate(drop = case_when(
    drop == "fail_in_fam" ~ "< 75% Correct in Familiarization",
    drop == "fussy_child" ~ "Fussy Child", 
    drop == "language" ~ "Low Language Proficiency", 
    drop == "quit_early" ~ "Quit Early",
    drop == "technical" ~ "Technical Problem",
    TRUE ~ NA_character_)) %>%  
  mutate(drop = factor(drop, levels = c(
    "< 75% Correct in Familiarization",
    "Quit Early",
    "Fussy Child",
    "Low Language Proficiency",
    "Technical Problem")))

drop.plot <- ggplot(drop.plot.data, aes(x = agem, fill = drop)) +
  geom_dotplot(stackgroups = TRUE, binwidth = 1, binpositions = "all") +  
  theme_bw() +
  scale_x_continuous(name = "Age in Months", breaks = seq(36, 84, 12), minor_breaks = seq(36, 84, 1)) +
  scale_y_continuous(name = "Exclusions", breaks = NULL) +
  coord_fixed(ratio = 4, xlim = c(36, 84), ylim = c(0, 1.5)) + 
  facet_wrap(~ study, ncol = 1) +
  labs(fill = NULL) +
  guides(fill = guide_legend(ncol = 5, byrow = TRUE)) +  
  theme_minimal(base_size = 13) +
  theme(
    panel.grid.minor.x = element_line(linewidth = 0.25, linetype = 2),
    panel.grid.major.x = element_line(linewidth = 1, linetype = 1),
    panel.border = element_rect(colour = "grey30", fill = NA, linewidth = 1),
    strip.background = element_rect(colour = "grey30", size = 1),
    strip.text = element_text(face = "bold", size = rel(.9), 
                              margin = margin(t = 5, b = 8)),
    axis.title = element_text(face = "bold", size = rel(.9)),
    axis.text = element_text(size = rel(0.8)),
    legend.position = "bottom",
    legend.justification = c(1, 1),
    legend.text = element_text(size = rel(.9)),
    legend.margin = margin(t = 2),
    plot.margin = margin(10, 10, 10, 10),
    panel.grid.minor = element_blank()
  )

ggsave(
  filename = "../illustrations/plot_supp_exclusions_S123.png",
  plot = drop.plot,
  device = "png",
  width = 9.5, height = 6,
  dpi = 300,
  units = "in",
  bg = "white")


# # display plot
# img <- image_read("../illustrations/plot_supp_exclusions_S123.png")
# 
# windows(width = 15, height = 10)  # On Windows
# plot(img)

```

<!-- Run full and null models for all three studies (not evaluated to save time) -->

```{r rep_s1_bayes, echo = FALSE, include=F, eval=F, results='asis'}

# NOTE: this is section is not evaluated to save time during knitting

# in prergistration we used the term "task" instead of "condition", same thing
# we have now decided to not scale sex to make interpretation more straightforward
# preregistered: correct ~ task*z.age +z.trial +z.sex +(z.trial|id)

S1.full.bm<-brm(correct~condition*z.age+z.trial+sex+(z.trial|subid), 
               data= rep.S1.bayes.data, 
               family=bernoulli(),
               chains = 4,
               iter= 5000,
               cores= 4)

S1.full.bm <- add_criterion(S1.full.bm, c("loo", "waic"))

S1.null.bm<-brm(correct~condition+z.age+z.trial+sex+(z.trial|subid), 
               data= rep.S1.bayes.data, 
               family=bernoulli(),
               chains = 4,
               iter= 5000,
               cores= 4)

S1.null.bm <- add_criterion(S1.null.bm, c("loo", "waic"))

### MODEL COMPARISON
S1.comp <- loo_compare(S1.null.bm, S1.full.bm, criterion = "waic")%>%as_tibble(rownames = "index")
S1.comp <- data.frame(S1.comp, row.names = "index")

S1.weights <- model_weights(S1.null.bm, S1.full.bm, criterion = "waic") 
S1.weights <- S1.weights %>% as_tibble(rownames = "index")
S1.weights <- data.frame(S1.weights, row.names = "index")

# "significant" if elpd_diff > 2*se_diff (confer Sivula et al., 2020)

### LOO COMPARISON
### not reported, essentially identical
# S1.null.loo <- loo(S1.null.bm)
# S1.full.loo <- loo(S1.full.bm)
# S1.loo.comp <- loo_compare(S1.null.loo, S1.full.loo) %>%
#   as_tibble(rownames = "model")
# S1.loo.comp

# Saving the model (to not rerun it every time)
saveRDS(S1.full.bm, "../models/S1.full.bm.rds")
saveRDS(S1.null.bm, "../models/S1.null.bm.rds")
saveRDS(S1.comp, "../models/S1.comp.rds")
saveRDS(S1.weights, "../models/S1.weights.rds")

```

```{r rep_s2_bayes, echo = FALSE, include=F, eval=F, results='asis'}

# NOTE: this is section is not evaluated to save time during knitting

# in prergistration we used the term "task" instead of "condition", same thing
# we have now decided to not scale sex to make interpretation more straightforward
# preregistered: correct ~ task*z.age +z.trial +z.sex +(z.trial|id)

S2.full.bm<-brm(correct~condition*z.age+z.trial+sex+(z.trial|subid), 
                data= rep.S2.bayes.data, 
                family=bernoulli(),
                chains = 4,
                iter= 5000,
                cores= 4)

S2.full.bm <- add_criterion(S2.full.bm, c("loo", "waic"))

S2.null.bm<-brm(correct~condition+z.age+z.trial+sex+(z.trial|subid), 
                data= rep.S2.bayes.data, 
                family=bernoulli(),
                chains = 4,
                iter= 5000,
                cores= 4)

S2.null.bm <- add_criterion(S2.null.bm, c("loo", "waic"))

### MODEL COMPARISON
S2.comp <- loo_compare(S2.null.bm, S2.full.bm, criterion = "waic")%>%as_tibble(rownames = "index")
S2.comp <- data.frame(S2.comp, row.names = "index")


S2.weights <- model_weights(S2.null.bm, S2.full.bm, criterion = "waic") 
S2.weights <- S2.weights %>% as_tibble(rownames = "index")
S2.weights <- data.frame(S2.weights, row.names = "index")


# "significant" if elpd_diff > 2*se_diff (confer Sivula et al., 2020)

### LOO COMPARISON
### not reported, essentially identical
# S2.null.loo <- loo(S2.null.bm)
# S2.full.loo <- loo(S2.full.bm)
# S2.loo.comp <- loo_compare(S2.null.loo, S2.full.loo) %>%
#   as_tibble(rownames = "model")
# S2.loo.comp

# Saving the model (to not rerun it every time)
saveRDS(S2.full.bm, "../models/S2.full.bm.rds")
saveRDS(S2.null.bm, "../models/S2.null.bm.rds")
saveRDS(S2.comp, "../models/S2.comp.rds")
saveRDS(S2.weights, "../models/S2.weights.rds")

### item level model
# S2.item.bm<-brm(correct~condition+z.age+z.trial+z.sex+(z.trial|subid)+ (z.age|item), 
#                data= rep.S2.bayes.data, 
#                family=bernoulli(),
#                chains = 4,
#                iter= 2000,
#                cores= 4)

```

```{r rep_s3_bayes, echo = FALSE, include=F, eval=F, results='asis'}



# NOTE: this is section is not evaluated to save time during knitting

# in prergistration we used the term "task" instead of "condition", same thing
# we have now decided to not scale sex to make interpretation more straightforward
# preregistered: correct ~ task*z.age +z.trial +z.sex +(z.trial|id)

S3.full.bm<-brm(correct~condition*z.age+z.trial+sex+(z.trial|subid), 
                data= rep.S3.bayes.data, 
                family=bernoulli(),
                chains = 4,
                iter= 5000,
                cores= 4)

S3.full.bm <- add_criterion(S3.full.bm, c("loo", "waic"))

S3.null.bm<-brm(correct~condition+z.age+z.trial+sex+(z.trial|subid), 
                data= rep.S3.bayes.data, 
                family=bernoulli(),
                chains = 4,
                iter= 5000,
                cores= 4)

S3.null.bm <- add_criterion(S3.null.bm, c("loo", "waic"))

### MODEL COMPARISON
S3.comp <- loo_compare(S3.null.bm, S3.full.bm, criterion = "waic")%>%as_tibble(rownames = "index")
S3.comp <- data.frame(S3.comp, row.names = "index")


S3.weights <- model_weights(S3.null.bm, S3.full.bm, criterion = "waic") 
S3.weights <- S3.weights %>% as_tibble(rownames = "index")
S3.weights <- data.frame(S3.weights, row.names = "index")




# "significant" if elpd_diff > 2*se_diff (confer Sivula et al., 2020)

### LOO COMPARISON
### not reported, essentially identical
# S3.null.loo <- loo(S3.null.bm)
# S3.full.loo <- loo(S3.full.bm)
# S3.loo.comp <- loo_compare(S3.null.loo, S3.full.loo) %>%
#   as_tibble(rownames = "model")
# S3.loo.comp

# Saving the model (to not rerun it every time)
saveRDS(S3.full.bm, "../models/S3.full.bm.rds")
saveRDS(S3.null.bm, "../models/S3.null.bm.rds")
saveRDS(S3.comp, "../models/S3.comp.rds")
saveRDS(S3.weights, "../models/S3.weights.rds")

### item level model
# S3.item.bm<-brm(correct~condition+z.age+z.trial+z.sex+(z.trial|subid)+ (z.age|item), 
#                data= rep.S3.bayes.data, 
#                family=bernoulli(),
#                chains = 4,
#                iter= 2000,
#                cores= 4)




```

<!-- Diagnostics for all three studies -->

```{r rep_s1_inspect, echo = FALSE, include=F, eval=T, results='asis'}

S1.full.bm <- readRDS("../models/S1.full.bm.rds")
S1.null.bm <- readRDS("../models/S1.null.bm.rds")

S1.comp <- readRDS("../models/S1.comp.rds")
S1.weights <- readRDS("../models/S1.weights.rds")

### POSTERIOR PREDICTICE CHECKS
### Check plots ...they look good, as expected in binomial models
# pp_check(S1.full.bm)
# pp_check(S1.null.bm)
# pp_check(S1.full.bm, type = "bars")
# pp_check(S1.null.bm, type = "bars")

### EFFECTICE SAMPLE SIZES
### inspect rhat --> always 1 --> good
### inspect Bull_ESS --> always > 1000 --> good
# summary(S1.full.bm)
# summary(S1.null.bm)

# for reporting BULK_ESS and Coefficients
S1.full.coef <- summarise_draws(as_draws_df(S1.full.bm)) # ! standard is just 90% CrI

# NOTE: # as_draws_df() from posterior uses 90% CrIs
# we preregistered using 2.5% and 97.5% quantiles
draws_df <- as_draws_df(S1.full.bm)
quantiles_df <- as.data.frame(t(apply(draws_df, 2, quantile, probs = c(0.025, 0.975))))
quantiles_df <- tibble::rownames_to_column(quantiles_df, var = "variable")
names(quantiles_df)[2:3] <- c("q2.5", "q97.5")

S1.full.coef <- left_join(S1.full.coef, quantiles_df, by = "variable") 

# for table in appendix:
S1.full.coef.table <- S1.full.coef

# for reporting in text:
S1.full.coef <- S1.full.coef %>% 
  filter(grepl("^b_", variable)) %>% 
  mutate(variable = gsub("b_", "", variable)) %>% 
  mutate(variable = gsub("condition", "", variable)) %>% 
  data.frame(row.names = "variable")

S1.null.coef <- summarise_draws(as_draws_df(S1.null.bm)) %>%
  filter(grepl("^b_", variable))
# 
# mean(S1.full.coef$ess_bulk)
# min(S1.full.coef$ess_bulk)
# max(S1.full.coef$ess_bulk)
# 
# mean(S1.null.coef$ess_bulk)
# min(S1.null.coef$ess_bulk)
# max(S1.null.coef$ess_bulk)


```

```{r rep_s2_inspect, echo = FALSE, include=F, eval=T, results='asis'}

S2.full.bm <- readRDS("../models/S2.full.bm.rds")
S2.null.bm <- readRDS("../models/S2.null.bm.rds")

S2.comp <- readRDS("../models/S2.comp.rds")
S2.weights <- readRDS("../models/S2.weights.rds")


### POSTERIOR PREDICTICE CHECKS
### Check plots ...they look good, as expected in binomial models
# pp_check(S2.full.bm)
# pp_check(S2.null.bm)
# pp_check(S2.full.bm, type = "bars")
# pp_check(S2.null.bm, type = "bars")

### EFFECTICE SAMPLE SIZES
### inspect rhat --> always 1 --> good
### inspect Bull_ESS --> always > 1000 --> good
# summary(S2.full.bm)
# summary(S2.null.bm)

# # for reporting BULK_ESS
# S2.full.coef <- summarise_draws(as_draws_df(S2.full.bm)) %>%
#   filter(grepl("^b_", variable)) %>% 
#   mutate(variable = gsub("b_", "", variable)) %>% 
#   mutate(variable = gsub("condition", "", variable)) %>% 
#   data.frame(row.names = "variable")

# for reporting BULK_ESS and Coefficients
S2.full.coef <- summarise_draws(as_draws_df(S2.full.bm)) # ! standard is just 90% CrI

# NOTE: # as_draws_df() from posterior uses 90% CrIs
# we preregistered using 2.5% and 97.5% quantiles
draws_df <- as_draws_df(S2.full.bm)
quantiles_df <- as.data.frame(t(apply(draws_df, 2, quantile, probs = c(0.025, 0.975))))
quantiles_df <- tibble::rownames_to_column(quantiles_df, var = "variable")
names(quantiles_df)[2:3] <- c("q2.5", "q97.5")

S2.full.coef <- left_join(S2.full.coef, quantiles_df, by = "variable") 

# for table in appendix:
S2.full.coef.table <- S2.full.coef

# for reporting in text:
S2.full.coef <- S2.full.coef %>% 
  filter(grepl("^b_", variable)) %>% 
  mutate(variable = gsub("b_", "", variable)) %>% 
  mutate(variable = gsub("condition", "", variable)) %>% 
  data.frame(row.names = "variable")

# NULL MODEL
S2.null.coef <- summarise_draws(as_draws_df(S2.null.bm)) %>%
  filter(grepl("^b_", variable))

# 
# mean(S2.full.coef$ess_bulk)
# min(S2.full.coef$ess_bulk)
# max(S2.full.coef$ess_bulk)
# 
# mean(S2.null.coef$ess_bulk)
# min(S2.null.coef$ess_bulk)
# max(S2.null.coef$ess_bulk)


```

```{r rep_s3_inspect, echo = FALSE, include=F, eval=T, results='asis'}


S3.full.bm <- readRDS("../models/S3.full.bm.rds")
S3.null.bm <- readRDS("../models/S3.null.bm.rds")

S3.comp <- readRDS("../models/S3.comp.rds") 
S3.weights <- readRDS("../models/S3.weights.rds")


## POSTERIOR PREDICTICE CHECKS
## Check plots ...they look good, as expected in binomial models
# pp_check(S3.full.bm)
# pp_check(S3.null.bm)
# pp_check(S3.full.bm, type = "bars")
# pp_check(S3.null.bm, type = "bars")

# ### EFFECTICE SAMPLE SIZES
# ## inspect rhat --> always 1 --> good
# ## inspect Bull_ESS --> always > 1000 --> good
# summary(S3.full.bm)
# summary(S3.null.bm)

# # for reporting BULK_ESS
# S3.full.coef <- summarise_draws(as_draws_df(S3.full.bm)) %>%
#   filter(grepl("^b_", variable)) %>% 
#   mutate(variable = gsub("b_", "", variable)) %>% 
#   mutate(variable = gsub("condition", "", variable)) %>% 
#   data.frame(row.names = "variable")

# for reporting BULK_ESS and Coefficients
S3.full.coef <- summarise_draws(as_draws_df(S3.full.bm)) # ! standard is just 90% CrI

# NOTE: # as_draws_df() from posterior uses 90% CrIs
# we preregistered using 2.5% and 97.5% quantiles
draws_df <- as_draws_df(S3.full.bm)
quantiles_df <- as.data.frame(t(apply(draws_df, 2, quantile, probs = c(0.025, 0.975))))
quantiles_df <- tibble::rownames_to_column(quantiles_df, var = "variable")
names(quantiles_df)[2:3] <- c("q2.5", "q97.5")

S3.full.coef <- left_join(S3.full.coef, quantiles_df, by = "variable") 

# for table in appendix:
S3.full.coef.table <- S3.full.coef

# for reporting in text:
S3.full.coef <- S3.full.coef %>% 
  filter(grepl("^b_", variable)) %>% 
  mutate(variable = gsub("b_", "", variable)) %>% 
  mutate(variable = gsub("condition", "", variable)) %>% 
  data.frame(row.names = "variable")

# NULL MODEL
S3.null.coef <- summarise_draws(as_draws_df(S3.null.bm)) %>%
  filter(grepl("^b_", variable))

# mean(S3.full.coef$ess_bulk)
# min(S3.full.coef$ess_bulk)
# max(S3.full.coef$ess_bulk)
# 
# mean(S3.null.coef$ess_bulk)
# min(S3.null.coef$ess_bulk)
# max(S3.null.coef$ess_bulk)


```

<!-- Prepare Data for Plotting -->

```{r rep_S1_bayes_fullmodel_prep_prepplotting, echo=FALSE, eval=T, warning = F, message=F}

# load model from rds
# S1.full.bm <- readRDS("../models/S1.full.bm.rds")
# table(rep.S1.bayes.data$condition)

nd1 <- tibble(z.age = rep(seq(from = min(rep.S1.bayes.data$z.age), to = max(rep.S1.bayes.data$z.age), length.out = 50),4),
             condition = c(rep("Representation",50), 
                           rep("Pars Pro Toto",50), 
                           rep("Complex Form Analogy",50), 
                           rep("Simple Form Analogy",50)), 
             # the four conditions in the data
             sex = rep(0,200),
             z.trial = rep(0,200))

# here we generate the fitted values based on the model
# the function fitted() takes in the model and the new dataset and generates a fitted values (inclucing upper and lower 95% CrI) for every row in the dataset
# because our dataset ranges from min age to max age in the data, we get the prediction for the age range in the data 
# but we could also generate predictions for different ages of course
f1 <- fitted(S1.full.bm, 
             newdata = nd1, 
             re_formula = NA) %>% 
  # this tells the function to ignore the random effects - in theory, we could generate predictions for specific individuals
  as_tibble() %>%
  bind_cols(nd1)%>%
  mutate(age = z.age + mean(rep.S1.bayes.data$ageinyears)) %>% # convert age back to the original scale by adding the mean of the data
  mutate(condition = factor(condition, levels = c(
        "Representation",
        "Pars Pro Toto", 
        "Simple Form Analogy", 
        "Complex Form Analogy")))

# summarize the data to include them in the plot later on
d1 <- rep.S1.bayes.data%>%
  group_by(subid, ageinyears, condition)%>%
  summarise(mean = mean(correct)) %>% 
  mutate(condition = factor(condition, levels = c(
        "Representation", # first level becomes reference
        "Pars Pro Toto", 
        "Simple Form Analogy", 
        "Complex Form Analogy")))

p1 <- f1 %>%
  mutate(age = age * 365.25) %>%
   mutate(condition = factor(condition, levels = c(
        "Representation", # first level becomes reference
        "Pars Pro Toto", 
        "Simple Form Analogy", 
        "Complex Form Analogy"))) %>% 
  group_by(condition)%>%
  summarise(
    Q2.5_closest_to.5 = Q2.5[which.min(abs(Q2.5-.5))],
    estimate_closest_to.5 = Estimate[which.min(abs(Q2.5-.5))],
    days = age[which.min(abs(Q2.5-.5))],
    months = round(days/30.5),
    years = round(days/365.25, 2),
    monthlabels = as.character(paste(months, "months"))
    )


nd1 <- add_colour(nd1)
f1  <- add_colour(f1)
d1  <- add_colour(d1)
p1  <- add_colour(p1)



```

```{r rep_S2_bayes_fullmodel_prep_prepplotting, echo=FALSE, eval=T, warning = F, message=F}

# load model from rds
S2.full.bm <- readRDS("../models/S2.full.bm.rds")
# table(rep.S2.bayes.data$condition)

nd2 <- tibble(z.age = rep(seq(from = min(rep.S2.bayes.data$z.age), to = max(rep.S2.bayes.data$z.age), length.out = 50),4),
              condition = c(rep("Relative Position",50), 
                            rep("Absolute Position",50), 
                            rep("Orientation of Feature",50), 
                            rep("Orientation of Object",50)),
              sex = rep(0,200),
              z.trial = rep(0,200))

# here we generate the fitted values based on the model
# the function fitted() takes in the model and the new dataset and generates a fitted values (inclucing upper and lower 95% CrI) for every row in the dataset
# because our dataset ranges from min age to max age in the data, we get the prediction for the age range in the data 
# but we could also generate predictions for different ages of course
f2 <- fitted(S2.full.bm, 
             newdata = nd2, 
             re_formula = NA) %>% 
  # this tells the function to ignore the random effects - in theory, we could generate predictions for specific individuals
  as_tibble() %>%
  bind_cols(nd2)%>%
  mutate(age = z.age + mean(rep.S2.bayes.data$ageinyears)) %>% # convert age back to the original scale by adding the mean of the data
  mutate(condition = factor(condition, levels = c(
    "Absolute Position", # first level becomes reference
    "Relative Position", 
    "Orientation of Object", 
    "Orientation of Feature")))

# summarize the data to include them in the plot later on
d2 <- rep.S2.bayes.data%>%
  group_by(subid, ageinyears, condition)%>%
  summarise(mean = mean(correct)) %>% 
  mutate(condition = factor(condition, levels = c(
    "Absolute Position", # first level becomes reference
    "Relative Position", 
    "Orientation of Object", 
    "Orientation of Feature")))

p2 <- f2 %>%
  mutate(age = age * 365.25)%>%
  mutate(condition = factor(condition, levels = c(
    "Absolute Position", # first level becomes reference
    "Relative Position", 
    "Orientation of Object", 
    "Orientation of Feature"))) %>% 
  group_by(condition)%>%
  summarise(
    Q2.5_closest_to.5 = Q2.5[which.min(abs(Q2.5-.5))],
    estimate_closest_to.5 = Estimate[which.min(abs(Q2.5-.5))],
    days = age[which.min(abs(Q2.5-.5))],
    months = round(days/30.5),
    years = round(days/365.25, 2),
    monthlabels = as.character(paste(months, "months"))
  )

nd2 <- add_colour(nd2)
f2  <- add_colour(f2)
d2  <- add_colour(d2)
p2  <- add_colour(p2)

```

```{r rep_S3_bayes_fullmodel_prep_prepplotting, echo=FALSE, eval=T, warning = F, message=F}


# load model from rds
S3.full.bm <- readRDS("../models/S3.full.bm.rds")
# table(rep.S3.bayes.data$condition)

nd3 <- tibble(z.age = rep(seq(from = min(rep.S3.bayes.data$z.age), to = max(rep.S3.bayes.data$z.age), length.out = 50),4),
              condition = c(rep("Number of Object",50), 
                            rep("Number of Feature",50), 
                            rep("Size of Object",50), 
                            rep("Size of Feature",50)),
              sex = rep(0,200),
              z.trial = rep(0,200))

# here we generate the fitted values based on the model
# the function fitted() takes in the model and the new dataset and generates a fitted values (inclucing upper and lower 95% CrI) for every row in the dataset
# because our dataset ranges from min age to max age in the data, we get the prediction for the age range in the data 
# but we could also generate predictions for different ages of course
f3 <- fitted(S3.full.bm, 
             newdata = nd3, 
             re_formula = NA) %>% 
  # this tells the function to ignore the random effects - in theory, we could generate predictions for specific individuals
  as_tibble() %>%
  bind_cols(nd3)%>%
  mutate(age = z.age + mean(rep.S3.bayes.data$ageinyears)) %>% # convert age back to the original scale by adding the mean of the data
  mutate(condition = factor(condition, levels = c(
    "Size of Object", # first level becomes reference
    "Size of Feature", 
    "Number of Object", 
    "Number of Feature")))

# summarize the data to include them in the plot later on
d3 <- rep.S3.bayes.data%>%
  group_by(subid, ageinyears, condition)%>%
  summarise(mean = mean(correct)) %>% 
  mutate(condition = factor(condition, levels = c(
    "Size of Object", # first level becomes reference
    "Size of Feature", 
    "Number of Object", 
    "Number of Feature")))

p3 <- f3 %>%
  mutate(age = age * 365.25)%>%
  mutate(condition = factor(condition, levels = c(
    "Size of Object", # first level becomes reference
    "Size of Feature", 
    "Number of Object", 
    "Number of Feature"))) %>% 
  group_by(condition)%>%
  summarise(
    Q2.5_closest_to.5 = Q2.5[which.min(abs(Q2.5-.5))],
    estimate_closest_to.5 = Estimate[which.min(abs(Q2.5-.5))],
    days = age[which.min(abs(Q2.5-.5))],
    months = round(days/30.5),
    years = round(days/365.25, 2),
    monthlabels = as.character(paste(months, "months"))
  )

nd3 <- add_colour(nd3)
f3  <- add_colour(f3)
d3  <- add_colour(d3)
p3  <- add_colour(p3)

```

<!-- Plotting with stimuli -->

```{r rep_S1_stim_bayes_fullmodel_plotting_new, echo=FALSE, eval=F, warning = F, message=F}


# load images ###################################

# plotexample Representation.png
image_1 <- image_read(paste0("../illustrations/plotexample ", levels(d1$condition)[1], ".png"))
image_2 <- image_read(paste0("../illustrations/plotexample ", levels(d1$condition)[2], ".png"))
image_3 <- image_read(paste0("../illustrations/plotexample ", levels(d1$condition)[3], ".png"))
image_4 <- image_read(paste0("../illustrations/plotexample ", levels(d1$condition)[4], ".png"))
# stimuli Representation.png
image_1_2 <- image_read(paste0("../illustrations/stimuli ", levels(d1$condition)[1], ".png"))
image_2_2 <- image_read(paste0("../illustrations/stimuli ", levels(d1$condition)[2], ".png"))
image_3_3 <- image_read(paste0("../illustrations/stimuli ", levels(d1$condition)[3], ".png"))
image_4_4 <- image_read(paste0("../illustrations/stimuli ", levels(d1$condition)[4], ".png"))
# create grobs
image_1_grob <- rasterGrob(image_1, interpolate = TRUE)
image_2_grob <- rasterGrob(image_2, interpolate = TRUE)
image_3_grob <- rasterGrob(image_3, interpolate = TRUE)
image_4_grob <- rasterGrob(image_4, interpolate = TRUE)
image_1_2_grob <- rasterGrob(image_1_2, interpolate = TRUE)
image_2_2_grob <- rasterGrob(image_2_2, interpolate = TRUE)
image_3_2_grob <- rasterGrob(image_3_3, interpolate = TRUE)
image_4_2_grob <- rasterGrob(image_4_4, interpolate = TRUE)

# plot 1 #####################
plot1 <- ggplot() +
  geom_hline(yintercept = 0.5, linetype = "dashed", color = "grey70", alpha = 0.75) +
  
  geom_point(
    data = d1 %>% filter(condition == levels(condition)[1]),
    aes(x = ageinyears, y = mean, colour = colour),
    alpha = 0.5, shape = 1, size = 2
  ) +
  
  geom_smooth(
    data = f1 %>% filter(condition == levels(condition)[1]),
    aes(x = age, y = Estimate, ymin = Q2.5, ymax = Q97.5, fill = colour, colour = colour),
    stat = "identity", alpha = 0.2, linewidth = 0.8
  ) +
  
  # shape 21 uses both fill (inside) and colour (stroke)
  geom_point(
    data = p1 %>% filter(condition == levels(condition)[1]),
    aes(x = days/365.25, y = 0.5, fill = colour, colour = colour),
    size = 4, shape = 21, stroke = 1
  ) +
  
  # constant black overlay: set outside aes()
  geom_point(
    data = p1 %>% filter(condition == levels(condition)[1]),
    aes(x = days/365.25, y = 0.5),
    fill = "black", colour = "black", size = 0.5, shape = 21, stroke = 1
  ) +
  
  # text: move color/fontface outside aes()
  geom_text(
    data = p1 %>% filter(condition == levels(condition)[1]),
    aes(label = months, x = days/365.25, y = 0.13),
    color = "black", fontface = "bold",
    angle = 90, size = 3, vjust = 0.5
  ) +
  
  geom_text(
    data = p1 %>% filter(condition == levels(condition)[1]),
    aes(label = "months", x = days/365.25, y = .31),
    color = "black", fontface = "bold",
    angle = 90, size = 3, vjust = 0.5
  ) +
  
  scale_colour_identity() +
  scale_fill_identity() +
  scale_y_continuous(labels = function(x) paste0(x*100, "%")) +
  labs(x = "Age", y = "Proportion Correct") +
  coord_cartesian(ylim = c(0, 1), xlim = c(2.7, 7.3)) +
  theme_minimal(base_size = 13) +
  theme(
    panel.border = element_rect(colour = "grey30", fill = NA, size = 1),
    strip.text = element_blank(),
    strip.background = element_blank(),
    axis.title = element_text(face = "bold", size = rel(0.8)),
    axis.text = element_text(size = rel(0.8)),
    legend.position = "none",
    panel.grid.minor = element_blank(),
    axis.title.y = element_blank(),
    axis.title.x = element_blank()
  )


# plot 2 ##################
plot2 <- ggplot() +
  geom_hline(yintercept = 0.5, linetype = "dashed", color = "grey70", alpha = 0.75) +
  
  geom_point(
    data = d1 %>% filter(condition == levels(condition)[2]),
    aes(x = ageinyears, y = mean, colour = colour),
    alpha = 0.5, shape = 1, size = 2
  ) +
  
  geom_smooth(
    data = f1 %>% filter(condition == levels(condition)[2]),
    aes(x = age, y = Estimate, ymin = Q2.5, ymax = Q97.5, fill = colour, colour = colour),
    stat = "identity", alpha = 0.2, linewidth = 0.8
  ) +
  
  # shape 21 uses both fill (inside) and colour (stroke)
  geom_point(
    data = p1 %>% filter(condition == levels(condition)[2]),
    aes(x = days/365.25, y = 0.5, fill = colour, colour = colour),
    size = 4, shape = 21, stroke = 1
  ) +
  
  # constant black overlay: set outside aes()
  geom_point(
    data = p1 %>% filter(condition == levels(condition)[2]),
    aes(x = days/365.25, y = 0.5),
    fill = "black", colour = "black", size = 0.5, shape = 21, stroke = 1
  ) +
  
  # text: move color/fontface outside aes()
  geom_text(
    data = p1 %>% filter(condition == levels(condition)[2]),
    aes(label = months, x = days/365.25, y = 0.13),
    color = "black", fontface = "bold",
    angle = 90, size = 3, vjust = 0.5
  ) +
  
  geom_text(
    data = p1 %>% filter(condition == levels(condition)[2]),
    aes(label = "months", x = days/365.25, y = .31),
    color = "black", fontface = "bold",
    angle = 90, size = 3, vjust = 0.5
  ) +
  
  scale_colour_identity() +
  scale_fill_identity() +
  scale_y_continuous(labels = function(x) paste0(x*100, "%")) +
  labs(x = "Age", y = "Proportion Correct") +
  coord_cartesian(ylim = c(0, 1), xlim = c(2.7, 7.3)) +
  theme_minimal(base_size = 13) +
  theme(
    panel.border = element_rect(colour = "grey30", fill = NA, size = 1),
    strip.text = element_blank(),
    strip.background = element_blank(),
    axis.title = element_text(face = "bold", size = rel(0.8)),
    axis.text = element_text(size = rel(0.8)),
    legend.position = "none",
    panel.grid.minor = element_blank(),
    axis.title.y = element_blank(),
    axis.title.x = element_blank()
  )

# plot 3 #########################
plot3 <- ggplot() +
  geom_hline(yintercept = 0.5, linetype = "dashed", color = "grey70", alpha = 0.75) +
  
  geom_point(
    data = d1 %>% filter(condition == levels(condition)[3]),
    aes(x = ageinyears, y = mean, colour = colour),
    alpha = 0.5, shape = 1, size = 2
  ) +
  
  geom_smooth(
    data = f1 %>% filter(condition == levels(condition)[3]),
    aes(x = age, y = Estimate, ymin = Q2.5, ymax = Q97.5, fill = colour, colour = colour),
    stat = "identity", alpha = 0.2, linewidth = 0.8
  ) +
  
  # shape 21 uses both fill (inside) and colour (stroke)
  geom_point(
    data = p1 %>% filter(condition == levels(condition)[3]),
    aes(x = days/365.25, y = 0.5, fill = colour, colour = colour),
    size = 4, shape = 21, stroke = 1
  ) +
  
  # constant black overlay: set outside aes()
  geom_point(
    data = p1 %>% filter(condition == levels(condition)[3]),
    aes(x = days/365.25, y = 0.5),
    fill = "black", colour = "black", size = 0.5, shape = 21, stroke = 1
  ) +
  
  # text: move color/fontface outside aes()
  geom_text(
    data = p1 %>% filter(condition == levels(condition)[3]),
    aes(label = months, x = days/365.25, y = 0.13),
    color = "black", fontface = "bold",
    angle = 90, size = 3, vjust = 0.5
  ) +
  
  geom_text(
    data = p1 %>% filter(condition == levels(condition)[3]),
    aes(label = "months", x = days/365.25, y = .31),
    color = "black", fontface = "bold",
    angle = 90, size = 3, vjust = 0.5
  ) +
  
  scale_colour_identity() +
  scale_fill_identity() +
  scale_y_continuous(labels = function(x) paste0(x*100, "%")) +
  labs(x = "Age", y = "Proportion Correct") +
  coord_cartesian(ylim = c(0, 1), xlim = c(2.7, 7.3)) +
  theme_minimal(base_size = 13) +
  theme(
    panel.border = element_rect(colour = "grey30", fill = NA, size = 1),
    strip.text = element_blank(),
    strip.background = element_blank(),
    axis.title = element_text(face = "bold", size = rel(0.8)),
    axis.text = element_text(size = rel(0.8)),
    legend.position = "none",
    panel.grid.minor = element_blank(),
    axis.title.y = element_blank(),
    axis.title.x = element_blank()
  )



# plot 4 #########################
plot4 <- ggplot() +
  geom_hline(yintercept = 0.5, linetype = "dashed", color = "grey70", alpha = 0.75) +
  
  geom_point(
    data = d1 %>% filter(condition == levels(condition)[4]),
    aes(x = ageinyears, y = mean, colour = colour),
    alpha = 0.5, shape = 1, size = 2
  ) +
  
  geom_smooth(
    data = f1 %>% filter(condition == levels(condition)[4]),
    aes(x = age, y = Estimate, ymin = Q2.5, ymax = Q97.5, fill = colour, colour = colour),
    stat = "identity", alpha = 0.2, linewidth = 0.8
  ) +
  
  # shape 21 uses both fill (inside) and colour (stroke)
  geom_point(
    data = p1 %>% filter(condition == levels(condition)[4]),
    aes(x = days/365.25, y = 0.5, fill = colour, colour = colour),
    size = 4, shape = 21, stroke = 1
  ) +
  
  # constant black overlay: set outside aes()
  geom_point(
    data = p1 %>% filter(condition == levels(condition)[4]),
    aes(x = days/365.25, y = 0.5),
    fill = "black", colour = "black", size = 0.5, shape = 21, stroke = 1
  ) +
  
  # text: move color/fontface outside aes()
  geom_text(
    data = p1 %>% filter(condition == levels(condition)[4]),
    aes(label = months, x = days/365.25, y = 0.13),
    color = "black", fontface = "bold",
    angle = 90, size = 3, vjust = 0.5
  ) +
  
  geom_text(
    data = p1 %>% filter(condition == levels(condition)[4]),
    aes(label = "months", x = days/365.25, y = .31),
    color = "black", fontface = "bold",
    angle = 90, size = 3, vjust = 0.5
  ) +
  
  scale_colour_identity() +
  scale_fill_identity() +
  scale_y_continuous(labels = function(x) paste0(x*100, "%")) +
  labs(x = "Age", y = "Proportion Correct") +
  coord_cartesian(ylim = c(0, 1), xlim = c(2.7, 7.3)) +
  theme_minimal(base_size = 13) +
  theme(
    panel.border = element_rect(colour = "grey30", fill = NA, size = 1),
    strip.text = element_blank(),
    strip.background = element_blank(),
    axis.title = element_text(face = "bold", size = rel(0.8)),
    axis.text = element_text(size = rel(0.8)),
    legend.position = "none",
    panel.grid.minor = element_blank(),
    axis.title.y = element_blank(),
    axis.title.x = element_blank()
  )



# Combine plots #######################

S1_complete <- ggdraw() +
  draw_plot_label(label = paste(levels(d1$condition)[1]), size = 14, x = 0.015, y = 0.98) +
  draw_plot_label(label = paste(levels(d1$condition)[2]), size = 14, x = 0.275, y = 0.98) +
  draw_plot_label(label = paste(levels(d1$condition)[3]), size = 14, x = 0.45, y = 0.98) +
  draw_plot_label(label = paste(levels(d1$condition)[4]), size = 14, x = 0.68, y = 0.98) +
  draw_plot(image_1_grob, y = 0.77, x = 0.05, width = .2, height = .2) +
  draw_plot(image_2_grob, y = 0.77, x = 0.292, width = .2, height = .2) +
  draw_plot(image_3_grob, y = 0.77, x = 0.541, width = .2, height = .2) +
  draw_plot(image_4_grob, y = 0.77, x = 0.79, width = .2, height = .2) +
  draw_plot(image_1_2_grob, y = 0.47, x = -0.01, width = .32, height = .32) +
  draw_plot(image_2_2_grob, y = 0.47, x =  0.23, width = .32, height = .32) +
  draw_plot(image_3_2_grob, y = 0.47, x =  0.48, width = .32, height = .32) +
  draw_plot(image_4_2_grob, y = 0.47, x =  0.728, width = .32, height = .32) +
  draw_plot(plot1, y = 0, x =  0.01, width = .25, height = .44) +
  draw_plot(plot2, y = 0, x =  0.25, width = .25, height = .44) +
  draw_plot(plot3, y = 0, x =  0.5, width = .25, height = .44) +
  draw_plot(plot4, y = 0, x =  0.75, width = .25, height = .44) +
  draw_plot_label(label = "A", size = 14, x = 0, y = 0.89) +
  draw_plot_label(label = "B", size = 14, x = 0, y = 0.65) +
  draw_plot_label(label = "C", size = 14, x = 0, y = 0.26)

# saving images ###############################

ggsave(
  filename = "../illustrations/S1_complete.pdf",
  plot = S1_complete,
  width = 27,
  height = 16.9,
  units = "cm",
  dpi = 600)

# shell.exec("../illustrations/S1_complete.pdf")

ggsave(
  filename = "./../illustrations/S1_complete.jpg",
  plot = S1_complete,
  width = 27,
  height = 16.9,
  units = "cm",
  dpi = 600)

ggsave(
  filename = "./../illustrations/S1_complete.png",
  plot = S1_complete,
  width = 27,
  height = 16.9,
  units = "cm",
  dpi = 600)

```

```{r rep_S2_stim_bayes_fullmodel_plotting_new, echo=FALSE, eval=F, warning = F, message=F}

# load images ###################################

# plotexample Representation.png
image_1 <- image_read(paste0("../illustrations/plotexample ", levels(d2$condition)[1], ".png"))
image_2 <- image_read(paste0("../illustrations/plotexample ", levels(d2$condition)[2], ".png"))
image_3 <- image_read(paste0("../illustrations/plotexample ", levels(d2$condition)[3], ".png"))
image_4 <- image_read(paste0("../illustrations/plotexample ", levels(d2$condition)[4], ".png"))
# stimuli Representation.png
image_1_2 <- image_read(paste0("../illustrations/stimuli ", levels(d2$condition)[1], ".png"))
image_2_2 <- image_read(paste0("../illustrations/stimuli ", levels(d2$condition)[2], ".png"))
image_3_3 <- image_read(paste0("../illustrations/stimuli ", levels(d2$condition)[3], ".png"))
image_4_4 <- image_read(paste0("../illustrations/stimuli ", levels(d2$condition)[4], ".png"))
# create grobs
image_1_grob <- rasterGrob(image_1, interpolate = TRUE)
image_2_grob <- rasterGrob(image_2, interpolate = TRUE)
image_3_grob <- rasterGrob(image_3, interpolate = TRUE)
image_4_grob <- rasterGrob(image_4, interpolate = TRUE)
image_1_2_grob <- rasterGrob(image_1_2, interpolate = TRUE)
image_2_2_grob <- rasterGrob(image_2_2, interpolate = TRUE)
image_3_2_grob <- rasterGrob(image_3_3, interpolate = TRUE)
image_4_2_grob <- rasterGrob(image_4_4, interpolate = TRUE)

# plot 1 ##################
plot1 <- ggplot() +
  geom_hline(yintercept = 0.5, linetype = "dashed", color = "grey70", alpha = 0.75) +
  
  geom_point(
    data = d2 %>% filter(condition == levels(condition)[1]),
    aes(x = ageinyears, y = mean, colour = colour),
    alpha = 0.5, shape = 1, size = 2
  ) +
  
  geom_smooth(
    data = f2 %>% filter(condition == levels(condition)[1]),
    aes(x = age, y = Estimate, ymin = Q2.5, ymax = Q97.5, fill = colour, colour = colour),
    stat = "identity", alpha = 0.2, linewidth = 0.8
  ) +
  
  # shape 21 uses both fill (inside) and colour (stroke)
  geom_point(
    data = p2 %>% filter(condition == levels(condition)[1]),
    aes(x = days/365.25, y = 0.5, fill = colour, colour = colour),
    size = 4, shape = 21, stroke = 1
  ) +
  
  # constant black overlay: set outside aes()
  geom_point(
    data = p2 %>% filter(condition == levels(condition)[1]),
    aes(x = days/365.25, y = 0.5),
    fill = "black", colour = "black", size = 0.5, shape = 21, stroke = 1
  ) +
  
  # text: move color/fontface outside aes()
  geom_text(
    data = p2 %>% filter(condition == levels(condition)[1]),
    aes(label = months, x = days/365.25, y = 0.13),
    color = "black", fontface = "bold",
    angle = 90, size = 3, vjust = 0.5
  ) +
  
  geom_text(
    data = p2 %>% filter(condition == levels(condition)[1]),
    aes(label = "months", x = days/365.25, y = .31),
    color = "black", fontface = "bold",
    angle = 90, size = 3, vjust = 0.5
  ) +
  
  scale_colour_identity() +
  scale_fill_identity() +
  scale_y_continuous(labels = function(x) paste0(x*100, "%")) +
  labs(x = "Age", y = "Proportion Correct") +
  coord_cartesian(ylim = c(0, 1), xlim = c(2.7, 7.3)) +
  theme_minimal(base_size = 13) +
  theme(
    panel.border = element_rect(colour = "grey30", fill = NA, size = 1),
    strip.text = element_blank(),
    strip.background = element_blank(),
    axis.title = element_text(face = "bold", size = rel(0.8)),
    axis.text = element_text(size = rel(0.8)),
    legend.position = "none",
    panel.grid.minor = element_blank(),
    axis.title.y = element_blank(),
    axis.title.x = element_blank()
  )


# plot 2  ##################
plot2 <- ggplot() +
  geom_hline(yintercept = 0.5, linetype = "dashed", color = "grey70", alpha = 0.75) +
  
  geom_point(
    data = d2 %>% filter(condition == levels(condition)[2]),
    aes(x = ageinyears, y = mean, colour = colour),
    alpha = 0.5, shape = 1, size = 2
  ) +
  
  geom_smooth(
    data = f2 %>% filter(condition == levels(condition)[2]),
    aes(x = age, y = Estimate, ymin = Q2.5, ymax = Q97.5, fill = colour, colour = colour),
    stat = "identity", alpha = 0.2, linewidth = 0.8
  ) +
  
  # shape 21 uses both fill (inside) and colour (stroke)
  geom_point(
    data = p2 %>% filter(condition == levels(condition)[2]),
    aes(x = days/365.25, y = 0.5, fill = colour, colour = colour),
    size = 4, shape = 21, stroke = 1
  ) +
  
  # constant black overlay: set outside aes()
  geom_point(
    data = p2 %>% filter(condition == levels(condition)[2]),
    aes(x = days/365.25, y = 0.5),
    fill = "black", colour = "black", size = 0.5, shape = 21, stroke = 1
  ) +
  
  # text: move color/fontface outside aes()
  geom_text(
    data = p2 %>% filter(condition == levels(condition)[2]),
    aes(label = months, x = days/365.25, y = 0.13),
    color = "black", fontface = "bold",
    angle = 90, size = 3, vjust = 0.5
  ) +
  
  geom_text(
    data = p2 %>% filter(condition == levels(condition)[2]),
    aes(label = "months", x = days/365.25, y = .31),
    color = "black", fontface = "bold",
    angle = 90, size = 3, vjust = 0.5
  ) +
  
  scale_colour_identity() +
  scale_fill_identity() +
  scale_y_continuous(labels = function(x) paste0(x*100, "%")) +
  labs(x = "Age", y = "Proportion Correct") +
  coord_cartesian(ylim = c(0, 1), xlim = c(2.7, 7.3)) +
  theme_minimal(base_size = 13) +
  theme(
    panel.border = element_rect(colour = "grey30", fill = NA, size = 1),
    strip.text = element_blank(),
    strip.background = element_blank(),
    axis.title = element_text(face = "bold", size = rel(0.8)),
    axis.text = element_text(size = rel(0.8)),
    legend.position = "none",
    panel.grid.minor = element_blank(),
    axis.title.y = element_blank(),
    axis.title.x = element_blank()
  )

# plot 3  ##################
plot3 <- ggplot() +
  geom_hline(yintercept = 0.5, linetype = "dashed", color = "grey70", alpha = 0.75) +
  
  geom_point(
    data = d2 %>% filter(condition == levels(condition)[3]),
    aes(x = ageinyears, y = mean, colour = colour),
    alpha = 0.5, shape = 1, size = 2
  ) +
  
  geom_smooth(
    data = f2 %>% filter(condition == levels(condition)[3]),
    aes(x = age, y = Estimate, ymin = Q2.5, ymax = Q97.5, fill = colour, colour = colour),
    stat = "identity", alpha = 0.2, linewidth = 0.8
  ) +
  
  # shape 21 uses both fill (inside) and colour (stroke)
  geom_point(
    data = p2 %>% filter(condition == levels(condition)[3]),
    aes(x = days/365.25, y = 0.5, fill = colour, colour = colour),
    size = 4, shape = 21, stroke = 1
  ) +
  
  # constant black overlay: set outside aes()
  geom_point(
    data = p2 %>% filter(condition == levels(condition)[3]),
    aes(x = days/365.25, y = 0.5),
    fill = "black", colour = "black", size = 0.5, shape = 21, stroke = 1
  ) +
  
  # text: move color/fontface outside aes()
  geom_text(
    data = p2 %>% filter(condition == levels(condition)[3]),
    aes(label = months, x = days/365.25, y = 0.13),
    color = "black", fontface = "bold",
    angle = 90, size = 3, vjust = 0.5
  ) +
  
  geom_text(
    data = p2 %>% filter(condition == levels(condition)[3]),
    aes(label = "months", x = days/365.25, y = .31),
    color = "black", fontface = "bold",
    angle = 90, size = 3, vjust = 0.5
  ) +
  
  scale_colour_identity() +
  scale_fill_identity() +
  scale_y_continuous(labels = function(x) paste0(x*100, "%")) +
  labs(x = "Age", y = "Proportion Correct") +
  coord_cartesian(ylim = c(0, 1), xlim = c(2.7, 7.3)) +
  theme_minimal(base_size = 13) +
  theme(
    panel.border = element_rect(colour = "grey30", fill = NA, size = 1),
    strip.text = element_blank(),
    strip.background = element_blank(),
    axis.title = element_text(face = "bold", size = rel(0.8)),
    axis.text = element_text(size = rel(0.8)),
    legend.position = "none",
    panel.grid.minor = element_blank(),
    axis.title.y = element_blank(),
    axis.title.x = element_blank()
  )

# plot 4  ##################
plot4 <- ggplot() +
  geom_hline(yintercept = 0.5, linetype = "dashed", color = "grey70", alpha = 0.75) +
  
  geom_point(
    data = d2 %>% filter(condition == levels(condition)[4]),
    aes(x = ageinyears, y = mean, colour = colour),
    alpha = 0.5, shape = 1, size = 2
  ) +
  
  geom_smooth(
    data = f2 %>% filter(condition == levels(condition)[4]),
    aes(x = age, y = Estimate, ymin = Q2.5, ymax = Q97.5, fill = colour, colour = colour),
    stat = "identity", alpha = 0.2, linewidth = 0.8
  ) +
  
  # shape 21 uses both fill (inside) and colour (stroke)
  geom_point(
    data = p2 %>% filter(condition == levels(condition)[4]),
    aes(x = days/365.25, y = 0.5, fill = colour, colour = colour),
    size = 4, shape = 21, stroke = 1
  ) +
  
  # constant black overlay: set outside aes()
  geom_point(
    data = p2 %>% filter(condition == levels(condition)[4]),
    aes(x = days/365.25, y = 0.5),
    fill = "black", colour = "black", size = 0.5, shape = 21, stroke = 1
  ) +
  
  # text: move color/fontface outside aes()
  geom_text(
    data = p2 %>% filter(condition == levels(condition)[4]),
    aes(label = months, x = days/365.25, y = 0.13),
    color = "black", fontface = "bold",
    angle = 90, size = 3, vjust = 0.5
  ) +
  
  geom_text(
    data = p2 %>% filter(condition == levels(condition)[4]),
    aes(label = "months", x = days/365.25, y = .31),
    color = "black", fontface = "bold",
    angle = 90, size = 3, vjust = 0.5
  ) +
  
  scale_colour_identity() +
  scale_fill_identity() +
  scale_y_continuous(labels = function(x) paste0(x*100, "%")) +
  labs(x = "Age", y = "Proportion Correct") +
  coord_cartesian(ylim = c(0, 1), xlim = c(2.7, 7.3)) +
  theme_minimal(base_size = 13) +
  theme(
    panel.border = element_rect(colour = "grey30", fill = NA, size = 1),
    strip.text = element_blank(),
    strip.background = element_blank(),
    axis.title = element_text(face = "bold", size = rel(0.8)),
    axis.text = element_text(size = rel(0.8)),
    legend.position = "none",
    panel.grid.minor = element_blank(),
    axis.title.y = element_blank(),
    axis.title.x = element_blank()
  )

# Combine plots #######################


S2_complete <- ggdraw() +
  draw_plot_label(label = paste(levels(d2$condition)[1]), size = 14, x = 0, y = 0.98) +
  draw_plot_label(label = paste(levels(d2$condition)[2]), size = 14, x = 0.25, y = 0.98) +
  draw_plot_label(label = paste(levels(d2$condition)[3]), size = 14, x = 0.46, y = 0.98) +
  draw_plot_label(label = paste(levels(d2$condition)[4]), size = 14, x = 0.7, y = 0.98) +
  draw_plot(image_1_grob, y = 0.77, x = 0.05, width = .2, height = .2) +
  draw_plot(image_2_grob, y = 0.77, x = 0.292, width = .2, height = .2) +
  draw_plot(image_3_grob, y = 0.77, x = 0.541, width = .2, height = .2) +
  draw_plot(image_4_grob, y = 0.77, x = 0.79, width = .2, height = .2) +
  draw_plot(image_1_2_grob, y = 0.47, x = -0.01, width = .32, height = .32) +
  draw_plot(image_2_2_grob, y = 0.47, x =  0.23, width = .32, height = .32) +
  draw_plot(image_3_2_grob, y = 0.47, x =  0.48, width = .32, height = .32) +
  draw_plot(image_4_2_grob, y = 0.47, x =  0.728, width = .32, height = .32) +
  draw_plot(plot1, y = 0, x =  0.01, width = .25, height = .44) +
  draw_plot(plot2, y = 0, x =  0.25, width = .25, height = .44) +
  draw_plot(plot3, y = 0, x =  0.5, width = .25, height = .44) +
  draw_plot(plot4, y = 0, x =  0.75, width = .25, height = .44) +
  draw_plot_label(label = "A", size = 14, x = 0, y = 0.89) +
  draw_plot_label(label = "B", size = 14, x = 0, y = 0.65) +
  draw_plot_label(label = "C", size = 14, x = 0, y = 0.26)


# Saving plots ##################

ggsave(
  filename = "../illustrations/S2_complete.pdf",
  plot = S2_complete,
  width = 27,
  height = 16.9,
  units = "cm",
  dpi = 600   # or 600 for very high resolution
)

# shell.exec("../illustrations/S2_complete.pdf")

ggsave(
  filename = "../illustrations/S2_complete.jpg",
  plot = S2_complete,
  width = 27,
  height = 16.9,
  units = "cm",
  dpi = 600   # or 600 for very high resolution
)
              

ggsave(
  filename = "../illustrations/S2_complete.png",
  plot = S2_complete,
  width = 27,
  height = 16.9,
  units = "cm",
  dpi = 600   # or 600 for very high resolution
)




```

```{r rep_S3_stim_bayes_fullmodel_plotting_new, echo=FALSE, eval=F, warning = F, message=F}

# load images ###################################

# plotexample Representation.png
image_1 <- image_read(paste0("../illustrations/plotexample ", levels(d3$condition)[1], ".png"))
image_2 <- image_read(paste0("../illustrations/plotexample ", levels(d3$condition)[2], ".png"))
image_3 <- image_read(paste0("../illustrations/plotexample ", levels(d3$condition)[3], ".png"))
image_4 <- image_read(paste0("../illustrations/plotexample ", levels(d3$condition)[4], ".png"))
# stimuli Representation.png
image_1_2 <- image_read(paste0("../illustrations/stimuli ", levels(d3$condition)[1], ".png"))
image_2_2 <- image_read(paste0("../illustrations/stimuli ", levels(d3$condition)[2], ".png"))
image_3_3 <- image_read(paste0("../illustrations/stimuli ", levels(d3$condition)[3], ".png"))
image_4_4 <- image_read(paste0("../illustrations/stimuli ", levels(d3$condition)[4], ".png"))
# create grobs
image_1_grob <- rasterGrob(image_1, interpolate = TRUE)
image_2_grob <- rasterGrob(image_2, interpolate = TRUE)
image_3_grob <- rasterGrob(image_3, interpolate = TRUE)
image_4_grob <- rasterGrob(image_4, interpolate = TRUE)
image_1_2_grob <- rasterGrob(image_1_2, interpolate = TRUE)
image_2_2_grob <- rasterGrob(image_2_2, interpolate = TRUE)
image_3_2_grob <- rasterGrob(image_3_3, interpolate = TRUE)
image_4_2_grob <- rasterGrob(image_4_4, interpolate = TRUE)

# plot 1 ###########################
plot1 <- ggplot() +
  geom_hline(yintercept = 0.5, linetype = "dashed", color = "grey70", alpha = 0.75) +
  
  geom_point(
    data = d3 %>% filter(condition == levels(condition)[1]),
    aes(x = ageinyears, y = mean, colour = colour),
    alpha = 0.5, shape = 1, size = 2
  ) +
  
  geom_smooth(
    data = f3 %>% filter(condition == levels(condition)[1]),
    aes(x = age, y = Estimate, ymin = Q2.5, ymax = Q97.5, fill = colour, colour = colour),
    stat = "identity", alpha = 0.2, linewidth = 0.8
  ) +
  
  # shape 21 uses both fill (inside) and colour (stroke)
  geom_point(
    data = p3 %>% filter(condition == levels(condition)[1]),
    aes(x = days/365.25, y = 0.5, fill = colour, colour = colour),
    size = 4, shape = 21, stroke = 1
  ) +
  
  # constant black overlay: set outside aes()
  geom_point(
    data = p3 %>% filter(condition == levels(condition)[1]),
    aes(x = days/365.25, y = 0.5),
    fill = "black", colour = "black", size = 0.5, shape = 21, stroke = 1
  ) +
  
  # text: move color/fontface outside aes()
  geom_text(
    data = p3 %>% filter(condition == levels(condition)[1]),
    aes(label = months, x = days/365.25, y = 0.13),
    color = "black", fontface = "bold",
    angle = 90, size = 3, vjust = 0.5
  ) +
  
  geom_text(
    data = p3 %>% filter(condition == levels(condition)[1]),
    aes(label = "months", x = days/365.25, y = .31),
    color = "black", fontface = "bold",
    angle = 90, size = 3, vjust = 0.5
  ) +
  
  scale_colour_identity() +
  scale_fill_identity() +
  scale_y_continuous(labels = function(x) paste0(x*100, "%")) +
  labs(x = "Age", y = "Proportion Correct") +
  coord_cartesian(ylim = c(0, 1), xlim = c(2.7, 7.3)) +
  theme_minimal(base_size = 13) +
  theme(
    panel.border = element_rect(colour = "grey30", fill = NA, size = 1),
    strip.text = element_blank(),
    strip.background = element_blank(),
    axis.title = element_text(face = "bold", size = rel(0.8)),
    axis.text = element_text(size = rel(0.8)),
    legend.position = "none",
    panel.grid.minor = element_blank(),
    axis.title.y = element_blank(),
    axis.title.x = element_blank()
  )


# plot 2 ###########################
plot2 <- ggplot() +
  geom_hline(yintercept = 0.5, linetype = "dashed", color = "grey70", alpha = 0.75) +
  
  geom_point(
    data = d3 %>% filter(condition == levels(condition)[2]),
    aes(x = ageinyears, y = mean, colour = colour),
    alpha = 0.5, shape = 1, size = 2
  ) +
  
  geom_smooth(
    data = f3 %>% filter(condition == levels(condition)[2]),
    aes(x = age, y = Estimate, ymin = Q2.5, ymax = Q97.5, fill = colour, colour = colour),
    stat = "identity", alpha = 0.2, linewidth = 0.8
  ) +
  
  # shape 21 uses both fill (inside) and colour (stroke)
  geom_point(
    data = p3 %>% filter(condition == levels(condition)[2]),
    aes(x = days/365.25, y = 0.5, fill = colour, colour = colour),
    size = 4, shape = 21, stroke = 1
  ) +
  
  # constant black overlay: set outside aes()
  geom_point(
    data = p3 %>% filter(condition == levels(condition)[2]),
    aes(x = days/365.25, y = 0.5),
    fill = "black", colour = "black", size = 0.5, shape = 21, stroke = 1
  ) +
  
  # text: move color/fontface outside aes()
  geom_text(
    data = p3 %>% filter(condition == levels(condition)[2]),
    aes(label = months, x = days/365.25, y = 0.13),
    color = "black", fontface = "bold",
    angle = 90, size = 3, vjust = 0.5
  ) +
  
  geom_text(
    data = p3 %>% filter(condition == levels(condition)[2]),
    aes(label = "months", x = days/365.25, y = .31),
    color = "black", fontface = "bold",
    angle = 90, size = 3, vjust = 0.5
  ) +
  
  scale_colour_identity() +
  scale_fill_identity() +
  scale_y_continuous(labels = function(x) paste0(x*100, "%")) +
  labs(x = "Age", y = "Proportion Correct") +
  coord_cartesian(ylim = c(0, 1), xlim = c(2.7, 7.3)) +
  theme_minimal(base_size = 13) +
  theme(
    panel.border = element_rect(colour = "grey30", fill = NA, size = 1),
    strip.text = element_blank(),
    strip.background = element_blank(),
    axis.title = element_text(face = "bold", size = rel(0.8)),
    axis.text = element_text(size = rel(0.8)),
    legend.position = "none",
    panel.grid.minor = element_blank(),
    axis.title.y = element_blank(),
    axis.title.x = element_blank()
  )

# plot 3 ###########################
plot3 <- ggplot() +
  geom_hline(yintercept = 0.5, linetype = "dashed", color = "grey70", alpha = 0.75) +
  
  geom_point(
    data = d3 %>% filter(condition == levels(condition)[3]),
    aes(x = ageinyears, y = mean, colour = colour),
    alpha = 0.5, shape = 1, size = 2
  ) +
  
  geom_smooth(
    data = f3 %>% filter(condition == levels(condition)[3]),
    aes(x = age, y = Estimate, ymin = Q2.5, ymax = Q97.5, fill = colour, colour = colour),
    stat = "identity", alpha = 0.2, linewidth = 0.8
  ) +
  
  # shape 21 uses both fill (inside) and colour (stroke)
  geom_point(
    data = p3 %>% filter(condition == levels(condition)[3]),
    aes(x = days/365.25, y = 0.5, fill = colour, colour = colour),
    size = 4, shape = 21, stroke = 1
  ) +
  
  # constant black overlay: set outside aes()
  geom_point(
    data = p3 %>% filter(condition == levels(condition)[3]),
    aes(x = days/365.25, y = 0.5),
    fill = "black", colour = "black", size = 0.5, shape = 21, stroke = 1
  ) +
  
  # text: move color/fontface outside aes()
  geom_text(
    data = p3 %>% filter(condition == levels(condition)[3]),
    aes(label = months, x = days/365.25, y = 0.13),
    color = "black", fontface = "bold",
    angle = 90, size = 3, vjust = 0.5
  ) +
  
  geom_text(
    data = p3 %>% filter(condition == levels(condition)[3]),
    aes(label = "months", x = days/365.25, y = .31),
    color = "black", fontface = "bold",
    angle = 90, size = 3, vjust = 0.5
  ) +
  
  scale_colour_identity() +
  scale_fill_identity() +
  scale_y_continuous(labels = function(x) paste0(x*100, "%")) +
  labs(x = "Age", y = "Proportion Correct") +
  coord_cartesian(ylim = c(0, 1), xlim = c(2.7, 7.3)) +
  theme_minimal(base_size = 13) +
  theme(
    panel.border = element_rect(colour = "grey30", fill = NA, size = 1),
    strip.text = element_blank(),
    strip.background = element_blank(),
    axis.title = element_text(face = "bold", size = rel(0.8)),
    axis.text = element_text(size = rel(0.8)),
    legend.position = "none",
    panel.grid.minor = element_blank(),
    axis.title.y = element_blank(),
    axis.title.x = element_blank()
  )

# plot 4 ###########################
plot4 <- ggplot() +
  geom_hline(yintercept = 0.5, linetype = "dashed", color = "grey70", alpha = 0.75) +
  
  geom_point(
    data = d3 %>% filter(condition == levels(condition)[4]),
    aes(x = ageinyears, y = mean, colour = colour),
    alpha = 0.5, shape = 1, size = 2
  ) +
  
  geom_smooth(
    data = f3 %>% filter(condition == levels(condition)[4]),
    aes(x = age, y = Estimate, ymin = Q2.5, ymax = Q97.5, fill = colour, colour = colour),
    stat = "identity", alpha = 0.2, linewidth = 0.8
  ) +
  
  # shape 21 uses both fill (inside) and colour (stroke)
  geom_point(
    data = p3 %>% filter(condition == levels(condition)[4]),
    aes(x = days/365.25, y = 0.5, fill = colour, colour = colour),
    size = 4, shape = 21, stroke = 1
  ) +
  
  # constant black overlay: set outside aes()
  geom_point(
    data = p3 %>% filter(condition == levels(condition)[4]),
    aes(x = days/365.25, y = 0.5),
    fill = "black", colour = "black", size = 0.5, shape = 21, stroke = 1
  ) +
  
  # text: move color/fontface outside aes()
  geom_text(
    data = p3 %>% filter(condition == levels(condition)[4]),
    aes(label = months, x = days/365.25, y = 0.13),
    color = "black", fontface = "bold",
    angle = 90, size = 3, vjust = 0.5
  ) +
  
  geom_text(
    data = p3 %>% filter(condition == levels(condition)[4]),
    aes(label = "months", x = days/365.25, y = .31),
    color = "black", fontface = "bold",
    angle = 90, size = 3, vjust = 0.5
  ) +
  
  scale_colour_identity() +
  scale_fill_identity() +
  scale_y_continuous(labels = function(x) paste0(x*100, "%")) +
  labs(x = "Age", y = "Proportion Correct") +
  coord_cartesian(ylim = c(0, 1), xlim = c(2.7, 7.3)) +
  theme_minimal(base_size = 13) +
  theme(
    panel.border = element_rect(colour = "grey30", fill = NA, size = 1),
    strip.text = element_blank(),
    strip.background = element_blank(),
    axis.title = element_text(face = "bold", size = rel(0.8)),
    axis.text = element_text(size = rel(0.8)),
    legend.position = "none",
    panel.grid.minor = element_blank(),
    axis.title.y = element_blank(),
    axis.title.x = element_blank()
  )

# Combine plots #######################

S3_complete <- ggdraw() +
  draw_plot_label(label = paste(levels(d3$condition)[1]), size = 14, x = 0.028, y = 0.98) +
  draw_plot_label(label = paste(levels(d3$condition)[2]), size = 14, x = 0.265, y = 0.98) +
  draw_plot_label(label = paste(levels(d3$condition)[3]), size = 14, x = 0.487, y = 0.98) +
  draw_plot_label(label = paste(levels(d3$condition)[4]), size = 14, x = 0.73, y = 0.98) +
  draw_plot(image_1_grob, y = 0.77, x = 0.05, width = .2, height = .2) +
  draw_plot(image_2_grob, y = 0.77, x = 0.292, width = .2, height = .2) +
  draw_plot(image_3_grob, y = 0.77, x = 0.541, width = .2, height = .2) +
  draw_plot(image_4_grob, y = 0.77, x = 0.79, width = .2, height = .2) +
  draw_plot(image_1_2_grob, y = 0.47, x = -0.01, width = .32, height = .32) +
  draw_plot(image_2_2_grob, y = 0.47, x =  0.23, width = .32, height = .32) +
  draw_plot(image_3_2_grob, y = 0.47, x =  0.48, width = .32, height = .32) +
  draw_plot(image_4_2_grob, y = 0.47, x =  0.728, width = .32, height = .32) +
  draw_plot(plot1, y = 0, x =  0.01, width = .25, height = .44) +
  draw_plot(plot2, y = 0, x =  0.25, width = .25, height = .44) +
  draw_plot(plot3, y = 0, x =  0.5, width = .25, height = .44) +
  draw_plot(plot4, y = 0, x =  0.75, width = .25, height = .44) +
  draw_plot_label(label = "A", size = 14, x = 0, y = 0.89) +
  draw_plot_label(label = "B", size = 14, x = 0, y = 0.65) +
  draw_plot_label(label = "C", size = 14, x = 0, y = 0.26)


# saving plots ###########################

ggsave(
  filename = "../illustrations/S3_complete.pdf",
  plot = S3_complete,
  width = 27,
  height = 16.9,
  units = "cm",
  dpi = 600   
)

# shell.exec("../illustrations/S3_complete.pdf")

ggsave(
  filename = "../illustrations/S3_complete.jpg",
  plot = S3_complete,
  width = 27,
  height = 16.9,
  units = "cm",
  dpi = 600  
)
   
ggsave(
  filename = "../illustrations/S3_complete.png",
  plot = S3_complete,
  width = 27,
  height = 16.9,
  units = "cm",
  dpi = 600  
)           

```

<!-- Run additional item models for all three studies (not evaluated to save time) -->

```{r S1S2S3_item_model,echo=FALSE, eval=F, warning = F, message=F}

# Main analysis:
# S1.full.bm<-brm(correct~condition*z.age+z.trial+sex+(z.trial|subid) 

### STUDY 1 ###
# table(rep.S1.bayes.data$condition, rep.S1.bayes.data$item)
# table(rep.S1.bayes.data$item)
# table(rep.S1.bayes.data$condition)

S1.item.model<-brm(correct ~ condition*z.age +z.trial +sex +(z.trial|subid) +(z.age|item), 
               data= rep.S1.bayes.data, 
               family=bernoulli(),
               chains = 4,
               iter= 5000,
               cores= 4)

S1.item.model <- add_criterion(S1.item.model, c("loo", "waic"))

saveRDS(S1.item.model, "../models/S1.item.model.rds")


### STUDY 2 ###
# table(rep.S2.bayes.data$condition, rep.S2.bayes.data$item)
# table(rep.S2.bayes.data$item)
# table(rep.S2.bayes.data$condition)

S2.item.model<-brm(correct ~ condition*z.age +z.trial +sex +(z.trial|subid) +(z.age|item), 
               data= rep.S2.bayes.data, 
               family=bernoulli(),
               chains = 4,
               iter= 5000,
               cores= 4)

S2.item.model <- add_criterion(S2.item.model, c("loo", "waic"))

saveRDS(S2.item.model, "../models/S2.item.model.rds")

### STUDY 3 ###
# table(rep.S2.bayes.data$condition, rep.S2.bayes.data$item)
# table(rep.S2.bayes.data$item)
# table(rep.S2.bayes.data$condition)

S3.item.model<-brm(correct ~ condition*z.age +z.trial +sex +(z.trial|subid) +(z.age|item), 
               data= rep.S3.bayes.data, 
               family=bernoulli(),
               chains = 4,
               iter= 5000,
               cores= 4)

S3.item.model <- add_criterion(S3.item.model, c("loo", "waic"))

saveRDS(S3.item.model, "../models/S3.item.model.rds")

```

```{r S1S2S3_itemvsfull_comp, echo=FALSE, eval=F, warning = F, message=F}

### MODEL COMPARISON

# STUDY 1 - item vs full #######################################
S1.itemvsfull.comp <- loo_compare(S1.item.model, S1.full.bm, 
                                  criterion = "waic")%>%as_tibble(rownames = "index")

S1.itemvsfull.comp  <- data.frame(S1.itemvsfull.comp , row.names = "index")

S1.itemvsfull.weights <- model_weights(S1.item.model, S1.full.bm, criterion = "waic") 
S1.itemvsfull.weights <- S1.itemvsfull.weights %>% as_tibble(rownames = "index")
S1.itemvsfull.weights <- data.frame(S1.itemvsfull.weights, row.names = "index")

saveRDS(S1.itemvsfull.comp, "../models/S1.itemvsfull.comp.rds")
saveRDS(S1.itemvsfull.weights, "../models/S1.itemvsfull.weights.rds")


# STUDY 2 - item vs full #######################################
S2.itemvsfull.comp <- loo_compare(S2.item.model, S2.full.bm, 
                                  criterion = "waic")%>%as_tibble(rownames = "index")

S2.itemvsfull.comp  <- data.frame(S2.itemvsfull.comp , row.names = "index")

S2.itemvsfull.weights <- model_weights(S2.item.model, S2.full.bm, criterion = "waic") 
S2.itemvsfull.weights <- S2.itemvsfull.weights %>% as_tibble(rownames = "index")
S2.itemvsfull.weights <- data.frame(S2.itemvsfull.weights, row.names = "index")

saveRDS(S2.itemvsfull.comp, "../models/S2.itemvsfull.comp.rds")
saveRDS(S2.itemvsfull.weights, "../models/S2.itemvsfull.weights.rds")


# STUDY 3 - item vs full #######################################
S3.itemvsfull.comp <- loo_compare(S3.item.model, S3.full.bm, 
                                  criterion = "waic")%>%as_tibble(rownames = "index")

S3.itemvsfull.comp  <- data.frame(S3.itemvsfull.comp , row.names = "index")

S3.itemvsfull.weights <- model_weights(S3.item.model, S3.full.bm, criterion = "waic") 
S3.itemvsfull.weights <- S3.itemvsfull.weights %>% as_tibble(rownames = "index")
S3.itemvsfull.weights <- data.frame(S3.itemvsfull.weights, row.names = "index")

saveRDS(S3.itemvsfull.comp, "../models/S3.itemvsfull.comp.rds")
saveRDS(S3.itemvsfull.weights, "../models/S3.itemvsfull.weights.rds")


```


```{r S1_item_ppcheck_rhat_bulkESS_coefftables, echo=FALSE, eval=T, warning = F, message=F}

S1.item.model <- readRDS("../models/S1.item.model.rds")
S1.itemvsfull.comp <- readRDS("../models/S1.itemvsfull.comp.rds")
S1.itemvsfull.weights <- readRDS("../models/S1.itemvsfull.weights.rds")

S2.item.model <- readRDS("../models/S2.item.model.rds")
S2.itemvsfull.comp <- readRDS("../models/S2.itemvsfull.comp.rds")
S2.itemvsfull.weights <- readRDS("../models/S2.itemvsfull.weights.rds")


S3.item.model <- readRDS("../models/S3.item.model.rds")
S3.itemvsfull.comp <- readRDS("../models/S3.itemvsfull.comp.rds")
S3.itemvsfull.weights <- readRDS("../models/S3.itemvsfull.weights.rds")



# POSTERIOR PREDICTICE CHECKS ###################
# pp_check(S1.item.model)
# pp_check(S1.item.model, type = "bars")
# 
# pp_check(S2.item.model)
# pp_check(S2.item.model, type = "bars")
# 
# pp_check(S3.item.model)
# pp_check(S3.item.model, type = "bars")

### inspect rhat --> always 1 --> good
### inspect Bulk_ESS --> always > 1000 --> good

#################       Estimate Est.Error l-95% CI 
# summary(S1.item.model) # Intercept 2.04      0.23     1.61
# summary(S2.item.model) # Intercept 1.09      0.25     0.60
# summary(S3.item.model) # Intercept 1.06      0.21     0.64





# S1 item model prepping for text and table ####################

# for reporting BULK_ESS and Coefficients
S1.item.coef <- summarise_draws(as_draws_df(S1.item.model)) # ! standard is just 90% CrI

# NOTE: # as_draws_df() from posterior uses 90% CrIs
# we preregistered using 2.5% and 97.5% quantiles
draws_df <- as_draws_df(S1.item.model)
quantiles_df <- as.data.frame(t(apply(draws_df, 2, quantile, probs = c(0.025, 0.975))))
quantiles_df <- tibble::rownames_to_column(quantiles_df, var = "variable")
names(quantiles_df)[2:3] <- c("q2.5", "q97.5")

S1.item.coef <- left_join(S1.item.coef, quantiles_df, by = "variable") 

# for table in appendix:
S1.item.coef.table <- S1.item.coef

# for reporting in text:
S1.item.coef <- S1.item.coef %>% 
  slice(1:16) %>%
  mutate(variable = gsub("b_", "", variable)) %>% 
  mutate(variable = gsub("condition", "", variable)) %>% 
  data.frame(row.names = "variable")



# S2 item model prepping for text and table ####################

# for reporting BULK_ESS and Coefficients
S2.item.coef <- summarise_draws(as_draws_df(S2.item.model)) # ! standard is just 90% CrI

# NOTE: # as_draws_df() from posterior uses 90% CrIs
# we preregistered using 2.5% and 97.5% quantiles
draws_df <- as_draws_df(S2.item.model)
quantiles_df <- as.data.frame(t(apply(draws_df, 2, quantile, probs = c(0.025, 0.975))))
quantiles_df <- tibble::rownames_to_column(quantiles_df, var = "variable")
names(quantiles_df)[2:3] <- c("q2.5", "q97.5")

S2.item.coef <- left_join(S2.item.coef, quantiles_df, by = "variable") 

# for table in appendix:
S2.item.coef.table <- S2.item.coef

# for reporting in text:
S2.item.coef <- S2.item.coef %>% 
  slice(1:16) %>%
  mutate(variable = gsub("b_", "", variable)) %>% 
  mutate(variable = gsub("condition", "", variable)) %>% 
  data.frame(row.names = "variable")



# S3 item model prepping for text and table ####################

# for reporting BULK_ESS and Coefficients
S3.item.coef <- summarise_draws(as_draws_df(S3.item.model)) # ! standard is just 90% CrI

# NOTE: # as_draws_df() from posterior uses 90% CrIs
# we preregistered using 2.5% and 97.5% quantiles
draws_df <- as_draws_df(S3.item.model)
quantiles_df <- as.data.frame(t(apply(draws_df, 2, quantile, probs = c(0.025, 0.975))))
quantiles_df <- tibble::rownames_to_column(quantiles_df, var = "variable")
names(quantiles_df)[2:3] <- c("q2.5", "q97.5")

S3.item.coef <- left_join(S3.item.coef, quantiles_df, by = "variable") 



# for table in appendix:
S3.item.coef.table <- S3.item.coef


# for reporting in text:
S3.item.coef <- S3.item.coef %>% 
  slice(1:16) %>%
  mutate(variable = gsub("b_", "", variable)) %>% 
  mutate(variable = gsub("condition", "", variable)) %>% 
  data.frame(row.names = "variable")

```


```{r S1S2S3_item_plotting, echo=FALSE, eval=T, warning = F, message=F}

# prep data 1 #######

S1.item_effects <- ranef(S1.item.model)$item

# Extract random intercepts
S1.item_intercepts <- as_tibble(S1.item_effects[, , "Intercept"], rownames = "item") %>%
  rename(
    estimate = Estimate,
    lower = Q2.5,
    upper = Q97.5) %>% 
  mutate(condition = substr(item,1,4)) %>% 
  mutate(item = substr(item, 10,10)) %>% 
  mutate(condition = case_when(
    condition == "repr" ~ "Representation", 
    condition == "pars" ~ "Pars Pro Toto",
    condition == "fsim" ~"Simple Form Analogy",
    condition == "fcom" ~ "Complex Form Analogy",
    condition == "abpo" ~ "Absolute Position",
    condition == "repo" ~ "Relative Position",
    condition == "orob" ~ "Orientation of Object",
    condition == "orfe" ~ "Orientation of Feature",
    condition == "siob" ~ "Size of Object", 
    condition == "sife" ~ "Size of Feature", 
    condition == "nuob" ~ "Number of Object", 
    condition == "nufe" ~ "Number of Feature",
    TRUE ~ as.character(condition))) %>% 
  mutate(condition = factor(condition, levels = c(
    "Representation", # first level becomes reference
    "Pars Pro Toto", 
    "Simple Form Analogy", 
    "Complex Form Analogy"))) %>% 
  mutate(item = factor(item, levels = c("4", "3", "2", "1")))

S1.item_intercepts <- add_colour(S1.item_intercepts)

# prep data 2 ######################

S2.item_effects <- ranef(S2.item.model)$item

# Extract random intercepts
S2.item_intercepts <- as_tibble(S2.item_effects[, , "Intercept"], rownames = "item") %>%
  rename(
    estimate = Estimate,
    lower = Q2.5,
    upper = Q97.5) %>% 
  mutate(condition = substr(item,1,4)) %>% 
  mutate(item = substr(item, 10,10)) %>% 
  mutate(condition = case_when(
    condition == "repr" ~ "Representation", 
    condition == "pars" ~ "Pars Pro Toto",
    condition == "fsim" ~"Simple Form Analogy",
    condition == "fcom" ~ "Complex Form Analogy",
    condition == "abpo" ~ "Absolute Position",
    condition == "repo" ~ "Relative Position",
    condition == "orob" ~ "Orientation of Object",
    condition == "orfe" ~ "Orientation of Feature",
    condition == "siob" ~ "Size of Object", 
    condition == "sife" ~ "Size of Feature", 
    condition == "nuob" ~ "Number of Object", 
    condition == "nufe" ~ "Number of Feature",
    TRUE ~ as.character(condition))) %>% 
  mutate(condition = factor(condition, levels = c(
    "Absolute Position",
    "Relative Position",
    "Orientation of Object",
    "Orientation of Feature"))) %>%
  mutate(item = factor(item, levels = c("4", "3", "2", "1")))

S2.item_intercepts <- add_colour(S2.item_intercepts)



# prep data 3 #####################

S3.item_effects <- ranef(S3.item.model)$item

# Extract random intercepts
S3.item_intercepts <- as_tibble(S3.item_effects[, , "Intercept"], rownames = "item") %>%
  rename(
    estimate = Estimate,
    lower = Q2.5,
    upper = Q97.5) %>% 
  mutate(condition = substr(item,1,4)) %>% 
  mutate(item = substr(item, 10,10)) %>% 
  mutate(condition = case_when(
    condition == "repr" ~ "Representation", 
    condition == "pars" ~ "Pars Pro Toto",
    condition == "fsim" ~"Simple Form Analogy",
    condition == "fcom" ~ "Complex Form Analogy",
    condition == "abpo" ~ "Absolute Position",
    condition == "repo" ~ "Relative Position",
    condition == "orob" ~ "Orientation of Object",
    condition == "orfe" ~ "Orientation of Feature",
    condition == "siob" ~ "Size of Object", 
    condition == "sife" ~ "Size of Feature", 
    condition == "nuob" ~ "Number of Object", 
    condition == "nufe" ~ "Number of Feature",
    TRUE ~ as.character(condition))) %>% 
  mutate(condition = factor(condition, levels = c(
    "Size of Object", # first level becomes reference
    "Size of Feature",
    "Number of Object",
    "Number of Feature"))) %>%
  mutate(item = factor(item, levels = c("4", "3", "2", "1")))

S3.item_intercepts <- add_colour(S3.item_intercepts)



# plot 1 ##################
S1.item.plot <- ggplot(S1.item_intercepts, aes(x = item, y = estimate)) +
  geom_point(aes(color = I(colour))) +
  geom_errorbar(aes(ymin = lower, ymax = upper, color = I(colour)), width = 0.6, size = .5) +
  geom_hline(yintercept = 0, linetype = "dashed", color = "gray50") +
  coord_flip() +
  facet_wrap(~ condition, scales = "free_y", ncol = 1) +
  scale_y_continuous(limits = c(-1, 1)) +
  labs(
    x = "Item",
    y = "Estimated Deviation from Overall Intercept (log-odds)"
  ) +
  theme_minimal() +
  theme(
    axis.text.y = element_text(size = 6),
    axis.title.x  = element_text(size = 8),     
    axis.title.y  = element_text(size = 8),
    legend.position = "none",  
    strip.text = element_text(size = 8, face = "bold"))

# plot 2 ############

S2.item.plot <- ggplot(S2.item_intercepts, aes(x = item, y = estimate)) +
  geom_point(aes(color = I(colour))) +
  geom_errorbar(aes(ymin = lower, ymax = upper, color = I(colour)), width = 0.6, size = .5) +
  geom_hline(yintercept = 0, linetype = "dashed", color = "gray50") +
  coord_flip() +
  facet_wrap(~ condition, scales = "free_y", ncol = 1) +
  labs(
    x = "Item",
    y = "Estimated Deviation from Overall Intercept (log-odds)"
  ) +
  scale_y_continuous(limits = c(-1, 1)) +
  theme_minimal() +
  theme(
    axis.text.y = element_text(size = 6),
    axis.title.x  = element_text(size = 8),     
    axis.title.y  = element_text(size = 8),     
    legend.position = "none",  
    strip.text = element_text(size = 8, face = "bold"))

# plot 3 ################################

S3.item.plot <- ggplot(S3.item_intercepts, aes(x = item, y = estimate)) +
  geom_point(aes(color = I(colour))) +
  geom_errorbar(aes(ymin = lower, ymax = upper, color = I(colour)), width = 0.6, size = .5) +
  geom_hline(yintercept = 0, linetype = "dashed", color = "gray50") +
  coord_flip() +
  facet_wrap(~ condition, scales = "free_y", ncol = 1) +
  labs(
    x = "Item",
    y = "Estimated Deviation from Overall Intercept (log-odds)"
  ) +
  scale_y_continuous(limits = c(-1, 1)) +
  theme_minimal() +
  theme(
    axis.text.y = element_text(size = 6),
    axis.title.x  = element_text(size = 8),     
    axis.title.y  = element_text(size = 8),
    legend.position = "none",  
    strip.text = element_text(size = 8, face = "bold"))

# combine plots  ##################

# hide x axis
S1.item.plot <- S1.item.plot + theme(axis.title.x = element_blank(),
                                       axis.text.x  = element_blank(),
                                       axis.ticks.x = element_blank())
S2.item.plot <- S2.item.plot + theme(axis.title.x = element_blank(),
                                       axis.text.x  = element_blank(),
                                       axis.ticks.x = element_blank())


S1S2S3_item_plot <- plot_grid(
  S1.item.plot, 
  S2.item.plot, 
  S3.item.plot,
  ncol = 1,
  labels = c("A", "B", "C"),
  label_size = 10,
  label_y = .95,   # vertical center
  hjust = -4,    # shift labels left
  align = "v", axis = "tb"
)


ggsave(
  filename = "../illustrations/S1S2S3_item_plot.pdf",
  plot = S1S2S3_item_plot,
  width = 17,
  height = 21,
  units = "cm",
  dpi = 600   
)

ggsave(
  filename = "../illustrations/S1S2S3_item_plot.png",
  plot = S1S2S3_item_plot,
  width = 17,
  height = 21,
  units = "cm",
  dpi = 600   
)

ggsave(
  filename = "../illustrations/S1S2S3_item_plot.jpg",
  plot = S1S2S3_item_plot,
  width = 17,
  height = 21,
  units = "cm",
  dpi = 600   
)


```

```{r rep_s1_item_unclear, echo = FALSE, include=F, eval=F, results='asis'}

S1.item.model


S1.full.bm <- readRDS("../models/S1.full.bm.rds")
S1.null.bm <- readRDS("../models/S1.null.bm.rds")

S1.comp <- readRDS("../models/S1.comp.rds")
S1.weights <- readRDS("../models/S1.weights.rds")

### POSTERIOR PREDICTICE CHECKS
### Check plots ...they look good, as expected in binomial models
# pp_check(S1.full.bm)
# pp_check(S1.null.bm)
# pp_check(S1.full.bm, type = "bars")
# pp_check(S1.null.bm, type = "bars")

### EFFECTICE SAMPLE SIZES
### inspect rhat --> always 1 --> good
### inspect Bull_ESS --> always > 1000 --> good
# summary(S1.full.bm)
# summary(S1.null.bm)

# for reporting BULK_ESS and Coefficients
S1.full.coef <- summarise_draws(as_draws_df(S1.full.bm)) # ! standard is just 90% CrI

# NOTE: # as_draws_df() from posterior uses 90% CrIs
# we preregistered using 2.5% and 97.5% quantiles
draws_df <- as_draws_df(S1.full.bm)
quantiles_df <- as.data.frame(t(apply(draws_df, 2, quantile, probs = c(0.025, 0.975))))
quantiles_df <- tibble::rownames_to_column(quantiles_df, var = "variable")
names(quantiles_df)[2:3] <- c("q2.5", "q97.5")

S1.full.coef <- left_join(S1.full.coef, quantiles_df, by = "variable") 

# for table in appendix:
S1.full.coef.table <- S1.full.coef

# for reporting in text:
S1.full.coef <- S1.full.coef %>% 
  filter(grepl("^b_", variable)) %>% 
  mutate(variable = gsub("b_", "", variable)) %>% 
  mutate(variable = gsub("condition", "", variable)) %>% 
  data.frame(row.names = "variable")

S1.null.coef <- summarise_draws(as_draws_df(S1.null.bm)) %>%
  filter(grepl("^b_", variable))
# 
# mean(S1.full.coef$ess_bulk)
# min(S1.full.coef$ess_bulk)
# max(S1.full.coef$ess_bulk)
# 
# mean(S1.null.coef$ess_bulk)
# min(S1.null.coef$ess_bulk)
# max(S1.null.coef$ess_bulk)


```


<!-- weitere zahlen -->

```{r summaryresults,  echo=FALSE, warning=F, message=F, eval=T}

p_all <- rbind(p1,p2,p3) %>% arrange(months)
p_all <- data.frame(p_all, row.names = "condition")

```

<!-- Hier gehts los -->

**Keywords:** symbolic literacy, graphic symbols, communication,
pragmatics, analogical reasoning, graphic communication, emerging
literacy, symbol-referent relationship, reference, symbol grounding

# Introduction

Humans are cultural beings. There is almost no aspect of our psychology
that is not influenced, shaped or even entirely created by and through
social interactions [@heyes2018cognitive; @legare2017cumulative;
@henrich2007humans; @henrich2021origins; @Tomasello2014ultra;
@Moll2007cooperation; @Vygotsky1980mind]. To a large extent, such
interactions are symbolically mediated [@Bruner1996culture;
@Donald2001mind; @Donald1991origins; @tomasello2009cultural]. Children’s
developing understanding of symbols in language, gesture or symbolic
artefacts is central to their enculturation and demonstrates the growth
of cognitive capacities that define the human mind
[@Tomasello2014natural; @Vygotsky1980mind]. The acquisition of language
and – much later – literacy [@Dehaene2009reading; @Bruner1996culture]
are arguably two of the most significant achievements in cultural
learning that individuals undergo with dramatic consequences for
cognitive abilities [@karmiloff1994beyond].

The human pointing gesture provides an entry point into the sphere of
symbolic communication and is one of the first means of intentional
communication that children acquire at the end of the first year
[@liszkowski2012prelinguistic; @tomasello2007new]. Following this
achievement, children soon become able to use iconic gestures, learn
their first words and begin to form propositions over the course of the
second year of life [@tomasello2010origins; @tomasello2009cultural].
While at first lacking an understanding of the dual nature of symbolic
means of communication, they soon come to grasp the
standing-for-relationship of symbols in the third year of life. In order
to better understand this process, researchers have worked on gesture,
words, photographs, representative drawings, maps, models, simulacra,
figurines and sound symbolism [@callaghan2015development;
@Tomasello1999do; @tomasello1997comprehension]. Notably, symbolic
behavior per se does not require symbolic insight [@namy2017symbols],
which is to say that children may be successful communicators and grasp
their interlocutors communicative acts or intentions but still lack
insight into the standing-for relationship of symbols: the idea that
something stands for something else. Therefore, the work of Judy
DeLoache and colleagues has been of seminal importance in sketching
children’s ability to exploit the informative value of symbolic
artefacts. In various studies, they have prompted children to find the
location of a hidden toy by providing them with cues in the form of
scale models, pictures, videos and maps representing the search space
[@deloache2004becoming]. Whereas even 30-month-old children would fail
to retrieve hidden items by using instructions based on replicas like a
model-room, 36-month-olds excel. This pattern of results in symbolic
object-choice-tasks has been replicated many times by her group and
other labs [@deloache2011early] and demonstrates that children’s
symbolic understanding undergoes a rapid development in the first and
second year of live [@deloache2004becoming; @callaghan2015development;
@Tomasello1999do].

A similar developmental trajectory has been observed in the
understanding of graphic representations. Iconicity provides an entry
point in this domain and even in the first year, infants are sensitive
to the similarity between a picture and its 3D referent
[@deloache1998grasping]. While pictures can incite manual exploration
before the first birthday [@pierroutsakos2003infants] this is replaced
with pointing to the depiction in the second year
[@deloache1998grasping]. Around the same age, toddlers understand that
pictures refer to concepts [@allen2004both] in learning words: 15- and
18-month-olds can extend newly learned labels both from pictures to
objects and from objects to pictures [@ganea2008transfer]. From 2,5 to 4
children use the shape of drawings to interpret them as long as the
drawings are presented to them as having been produced intentionally
[@gelman1998shape]. Yet, Callaghan [-@callaghan1999early] found that
two-year-olds were still at chance selecting an item depicted in
representative drawings whereas three- and four-year-olds succeeded. One
of the few studies sampling children’s age continuously due to the
arguably rapid changes between two and four years of age
[@deloache2004becoming] found gradual improvement between 15 and 30
months of age using age in months as a predictor in standard linear
regression [@ganea2008transfer]. Children’s comprehension of graphic
depictions remains fragile until the end of the third year. In another
series of studies, Callaghan [-@callaghan2000factors] presented children
either with a realistic pencil drawing, a stylized drawing or a model
replica and then prompted children to choose what was depicted from a
set of two realistic presentations. 30-months-olds did not benefit from
iconicity and failed to use pictures and replicas as symbols.
36-month-olds succeeded in all conditions and benefitted from iconicity
and the availability of verbal labels during the task
[@callaghan2000factors; @DeLoache1995early]. Matching graphic
representations with each other is much less demanding or even so
trivial that it is rarely employed in experimental contexts. Finding a
graphical item in a drawn scene as is often done in picture-book reading
routines or visual search paradigms and is generally accessible for
children at the end of the third year [@gerhardstein2002development].
Matching identical items in match-to-sample tasks is occasionally used
as a training in research on analogical reasoning and generally provides
no challenge for children older than three [@kroupin2022you].

Direct investigations into children’s ability to use conceptual
dimensions other than similarity or iconicity in the graphic domain
are - to the best of our knowledge - relatively rare. Due to the
graphical representations being static in time and limited to 2D-space,
the conceptual dimensions along which information can be encoded is
finite. Apart from representations capturing the actual shape of what
they are depicting, discussions of graphic communication generally
identify primitives or “visual variables” as fundamental elements for
encoding information. These variables are position, size, number,
orientation, relational and gestalt-principles, as well as continuous
visual properties such as brightness, color (hue) or texture
[@cleveland1984graphical; @stevenson2014visual;
@monmonier1985semiology]. The former group takes precedence in
conceptual implementation due to their discreteness. After all, a
conventional sign or representative drawing can evoke the same concept
regardless of the color or brightness it is implemented with. On the
perceptual level, object, color, quantity, size are easier to process
than relational properties or figural analogies such as orientation and
position [@stevenson2014visual; @donnelly2007visual]. Similar
successions have been documented throughout preschool development.
Children are first able to understand iconic signs or depictions around
the third birthday, whereas more conceptual or analogical dimensions are
appreciated only at four to five years of age [@callaghan2000factors].
Defining the precise ages and relative developmental trajectories for
children’s sensitivity to using these graphic primitives as conveying
meaning and disambiguating reference provides crucial insights into
children’s developing symbolic competence but also provides orientation
for investigations into the origins and development of graphic systems
of communication. Below we discuss previous research on young children’s
sensitivity for aspects such as part-whole relationships, form,
orientation, number and size in the graphic domain.

Graphical representations naturally abstract from the reference they
intend to depict by leaving out detail as it is generally sufficient for
conveying the idea of - for example - a person without drawing their
fingers. Reducing representation to a certain compositional element can
also be evocative of a concept but is already typical for more abstract
symbolic communication, for example, drawing a crown on a map may
indicate the position of a royal residence. Using an aspect or part of
something in reference to a whole is common in rhetorical figures such
as metonomy or ellipsis, and requires an inductive pragmatic reference
on the side of the listener that is mastered by children at the age of
three [@falkum2017moustache]. Omissions in depiction are an important
aspect of developing conventions and streamlining communication
[@goldin1977development] as well as they are an interesting minimal step
towards abstraction as they are still basically iconic, yet only showing
a part or aspect of the referent. At least for basic geometrical shapes,
we know that while the production and completion of shapes in drawing
[@cox2005pictorial; @daugli2016young] develops throughout the preschool
years, shape recognition and naming are robust in the third and fourth
year [@ZAMBRZYCKA2017144; @verdine2017shape; @verdine2016shape] and the
ability to mentally complete canonical geometric shapes is already
nascent in early infancy [@kellman1983perception;
@valenza2006perceptual], making part-whole relationships on the level of
geometric figures an ideal target for an investigation into slightly
abstract symbol-reference relationships that young children may be able
to read at the beginning of the preschool years.

A highly abstract means of reference that is still rooted in iconicity
may be the metaphorical use of form or shape, for example, by referring
to something pointy, sharp or spiky with an edgy or more clear cut
rectangular drawing but also size [@knoeferle2017drives]. Again, this is
common in language and became a focus of research studying sound
symbolism in the lexicon [@bermudez2020sound; @sidhu2025sound] writing
systems [@porto2024sound], as well as actions and gesture
[@margiotoudi2020action; @bohn2019natural]. Children are sensitive to
sound symbolism matching words and shapes by about 30 months of age
[@maurer2006shape; @imai2008sound; @fort2018symbouki] and for matching
actions with gestures or vocalizations at 36 months [@bohn2019natural].
There is currently no data on whether children are sensitive to an
agreement in the overall properties of a shape or the impression that
its form conveys for grounding reference.

As with the other dimensions reported above, there is evidence that
children are sensitive to Gestalt principles like closure and spatial
dimensions of composition position, orientation and alignment in graphic
displays but there is virtually no data on how likely children are to
perceive such aspects of graphical stimuli to convey meaning. Closure
appears to be a basic principle for graphic production, as children
rarely draw overlapping figures [@cox2005pictorial; @piaget1997mental].
Relative position is intuitively used by children even in their earliest
figural drawings when arranging items in scenes, such as children next
to an ice-cream van, but also when achieving “intellectual realism” in
depicting complex objects [@luquet2001children]. That is, while
children’s drawings may not look realistic per se, they are true to the
invariant organisation of a depicted item via the relative position of
the defining elements: when drawing a car, the wheels will be added at
the bottom rather than on top [@cox2005pictorial]. In both cases,
relative position and orientation on the level of the individual object
or scene may be discussed as iconic. A more abstract or conceptual use
of relative position for conveying information is present in children’s
developing ability to read maps. An intuitive understanding of basic
maps allowing children to extract relational directions such as “behind
me” or “in front of me” is accessible by four years of age and even so
in the absence of training [@landau1986early] but iconicity is again
very important for grasping the conceptual space depicted in maps
[@liben2013role]. Likewise 4-year-olds can use geometric information
from maps to navigate real space [@shusterman2008young], but more
demanding transfer from maps to real-world settings with larger spatial
arrays is unstable prior to six to seven years of age [@uttal1989young].
For example, performance in 4-year-olds decreases if mental rotation is
necessary [@blades1994development].

Size is a relative property of graphical content and requires a
comparison between items, for example when drawing a big and small dog,
or an appreciation of an item’s relation to the frame of reference it
occurs in, as when a child may try to convey the concept of a big dog by
making it occupy the entire piece paper it is drawing on
[@cox2005pictorial]. Children are able to make spontaneous or productive
size comparisons at three years of age and begin to use size words size
words (*big*), size superlatives (*biggest*), or quantifiers (more, most)
[@ferry2025bigger], yet young children are most accurate with *bigger*
and only gradually gain competence with words like smaller, shorter or
longer [@frausel2020origins]. When presented with an array of graphic
stimuli, preschoolers can reliably point at, for example, the smallest
or largest item in a set [@haun2011conformity]. While three and four
year olds can identify larger or smaller graphic items, the canonical
size of the depicted objects can interfere leading to stroop-like errors
[@long2019real]. When presented with three different geometric shapes in
matching or non-matching dimensions (e.g. large, large, small) in
match-to-sample tasks, children are quite unlikely to spontaneously
infer size as the basis for matching even around the fourth birthday
[@kroupin2022you]. One of the few studies using size as a way for
grounding reference, investigated the role of the producers intentions
in identifying concepts in ambiguous scribble drawings that were
presented to participants as aiming to depict, for example, a small
spider next to a big house. Children here made use of spatial analogies
beginning at three years of age but appeared to benefit more as they
turned four [@bloom1998intention].

Number, is another relational concept, and an absolute primitive in
graphic communication [@ifrah2000universal; @cooperrider2019career]
likely to be the conceptual space that the very first historic systems
of writing were trying to capture. Judgments of quantity have been
studied extensively in developmental psychology and identified both
implicit and explicit number systems [@carey2019ontogenetic]. Infants
already have an implicit proximate grasp of differences in number
[@starr2013number] with one versus three being one of the most early
comparisons possible, which is also frequently used as the most simple
tasks in comparative work [@eckert2022does; @xu2007number;
@carey2000origin]. Preschoolers growing up in industrialized
environments are constantly surrounded by math tasks in the form of
various games [@daucourt2021home] as well as preschool curricula
incentivizing a playful engagement with quantities, number symbols and
shapes [@kucharz2012elementarbildung; @schmidt2021fruhpadagogische]. By
four years of age, children have a basic grasp of the cardinal
principle, that is basic understanding of the relation of number words
and fixed quantities [@silver2022environmental; @carey2019ontogenetic]
and they are able to use that knowledge in practical everyday contexts,
for example when comparing comparing numbers with magnitudes smaller
than five [@wynn1990children]. In match-to-sample tasks, children
spontaneously infer number as a basis of comparison at 48–60 months
[@kroupin2022you].

From this review of children’s ability to appreciate various basic
dimensions of graphic depictions and their sensitivity to these as means
for conveying information and disambiguating reference, we can identify
a couple of research desiderata. Most striking is the literature’s focus
on similarity and iconicity [@callaghan2015development]. Mappings
between symbol and referent can take place along a number of conceptual
dimensions and few studies explicitly address these. Against this
background, a systematic and comprehensive investigation of the
conceptual dimensions along which graphic symbols can be imbued with
meaning, will help to evaluate the extent to which children’s competence
is specific to certain types of symbol-referent-relationships or
generalizes across mappings based on analogy in form, size, number, or
Gestalt principles. The strong focus on iconicity often goes together
with the graphic stimulus depicting actual real world objects. Here
familiarity with the depicted object, its canonical features and even
conventional ways of drawing them may interfere with the aim of
investigating cognitive capacities rather than knowledge of culturally
imbued graphic conventions, script or icons. By contrast, our work
investigates young children’s spontaneous comprehension of unfamiliar
graphic symbols that gain meaning from being produced in a specific and
highly restricted context where symbol and referent align in certain
conceptual dimensions with decreasing iconicity. Therefore, our work
focuses on children’s pragmatic competencies and their ability to
identify shared features across graphic displays used as target and
referent. To the extent that children are highly unlikely to have
encountered the specific graphic cues used here, our findings showcase
their ability to grasp a novel symbolic practice and acquire novel
symbols. This may limit the influence of children’s knowledge of
conventional symbols on performance and make our results more robust and
informative for research about the acquisition or emergence of
communicative systems despite spanning an age-range where children
become competent users of script, numerals or drawings. Notably, the
producers’ cooperative intentions are key in individuating the symbols’
meaning within the practical context of the coordination game employed
in the studies below [@namy2017symbols], which has been shown to be key
for success in other symbolic tasks such as the scale-model task
[@deloache2011early], maps [@liben2013role], and drawings
[@callaghan2000factors].

# General Methods

All three studies presented below share methodological and analytic
approaches. For the convenience of the reader, common features of the
procedure, participant recruiting and stimulus design are reported first
before discussing the three studies respectively. All studies were
preregistered online prior to data collection (cf. [Study
1](https://aspredicted.org/SJT_H7F): <https://aspredicted.org/SJT_H7F>,
[Study 2](https://aspredicted.org/L2H_XC7):
<https://aspredicted.org/L2H_XC7>, and [Study
3](https://aspredicted.org/DR4_B4B): <https://aspredicted.org/DR4_B4B>).
All stimuli, data and analyses are available at **LINK**.

## Data Collection and Setup

In order to continuously trace the development of symbolic competences
across the preschool years, for each study we aimed to test two children
per month of age between the third and the seventh birthday for a total
of 96 participants while balancing male and female participants. As
children participated on the basis of availability and data were
collected by several experimenter teams visiting different institutions
in parallel, the resulting final samples slightly exceed this
preregistered minimum sample size. The final sample approximates an
equal distribution of male and female participants and aligns with
conventions in the field in providing a minimum of 24 participants per
study and year of age (cf. Appendix A figure
@ref(fig:suppl-participants-dots)). All participants were recruited in
*MASKED FOR REVIEW*, a medium-sized middle-European city, and came from
a predominantly white population of middle to high income families. They
were contacted via a database of participants for child development
studies to which their parents had voluntarily signed up. Children were
tested in day- and after schoolcare for the most part, and occasionally
in the lab or at home. The studies were reviewed and approved by an
internal ethics committee at the *MASKED FOR REVIEW*. Data collection
took place from June 2022 to February 2023.

## Setup and Procedure

During test sessions, a child and an experimenter sat down together to
play a picture-book-style hiding game presented on a touch-screen
laptop, which provides a very intuitive, highly controlled and efficient
testing environment (Frank et al., 2016; Zack et al., 2009). Verbal
instructions were played back by the experimental script. Experimenters
supervised children during data collection and occasionally reacted with
a fixed set of verbal prompts when children were not following the
presentation ("Oh look, the game continues!"). Test sessions always took
place in a quiet separate room. See figure \@ref(fig:plot-figure-setup)
A for an illustration of the setup.

```{r plot-figure-setup, fig.cap = "*Setup, Stimuli and Trial Structure.* Panel A shows the setup during testing. Experimenters were sitting behind the children in order to not distract them while supervising data collection. Panel B shows all elements contributing to an item of a possible test trial consisting of two target and one of two possible cues. Panel C exemplifies how two targets and one of the cues can be arranged in a specific test trial. Panel D shows a familiarization trial and Panel E shows a test trial.", fig.align = "center", echo = FALSE, out.width = "95%"}

knitr::include_graphics(knitr::plot_crop("../illustrations/setup complete.png"))

```

*Familiarisation.* Experimenters invited the participants to join a
hiding game and initially instructed them to follow the narration of the
story. First, the presentation introduced a cartoon monkey. This
character then placed two cups on the bottom left and right side of the
screen. After holding up a banana, one of the barriers was lifted, the
banana was placed underneath one of the cups and the barrier was
lowered. Children were now prompted to touch the hiding place and in
doing so the barrier of their choice was lifted to reveal the banana
again if they chose correctly. The experimental script played back
prerecorded feedback upon children's choice ("yes, great job!"; "No,
that's not it. Let's try again!") during the familiarization (cf. figure
\@ref(fig:plot-figure-setup) D). In order to succeed during
familiarization, children solely had to remember where the item went and
touch this part of the screen a few seconds later. To ensure that
children were familiar with the goal of the game and the touch
interface, they first had to complete a set of four to eight
familiarization trials with a success rate of 75%. In case a child did
not reply correctly in three out of four trials, another four
familiarization trials were provided. If the child was correct in six
out of eight trials, she was included in the main sample. Children that
did not succeed during familiarization were allowed to participate but
their data was not submitted to analysis. These children are reported
below as failing the familiarization phase.

*Test.* The main phase of the study commenced with announcing that the
cartoon character had an idea for a new game. The narration conveyed
that children were not allowed to see where the banana would be hidden,
but that the monkey would help them find it. Hence, the cartoon
character was established as a knowledgeable and benevolent partner in a
cooperative coordination game. The hiding sequence was identical to the
familiarization phase, however the placement of the banana was concealed
by a barrier covering the lower half of the screen. After the hiding
phase, the monkey then held up a piece of paper and a pencil. Pencil
movement and a short scribble sound indicated that the monkey was
drawing. Children were reminded that the monkey was going to help them.
Finally, participants were prompted with the phrase "Where is the
banana?" and the monkey's drawing was placed in the center between the
two barriers. The drawing served as a cue to guide children's choice. In
the most basic experimental condition in study one (*Representation*),
each hiding place, for example, showed either a solid blue circle or
square and the paper displayed a simple outline drawing of one the
shapes. Upon making a choice by touching the hiding places, children
received no feedback and there was no reveal animation. Rather,
children's choice was acknowledged with neutral feedback ("Ah, thank
you") leading over to the next trial (cf. figure
\@ref(fig:plot-figure-setup) E).

Except for the geometric shapes displayed on the hiding places and the
respective drawing, the experimental presentation was identical for all
test trials. A single trial lasted roughly 20 to 60 seconds, depending
on how swiftly children chose. Each study presented four different
experimental conditions with four trials each in a blocked order for a
maximum of 16 test trials. Unique graphic displays were used on every
trial. Test sessions lasted about 12 minutes in total. The order of
conditions was counterbalanced across participants. Children
occasionally wished to stop before completing all trials, resulting in
minor deviations of the total number of trials per condition that were
submitted to analysis. For an overview of the average number of trials
participants received in each condition, see tables
\@ref(tab:suppl-descriptives-S1), \@ref(tab:suppl-descriptives-S2) and
\@ref(tab:suppl-descriptives-S3) in Appendix B. In line with the
preregistration, children had to complete a minimum of eight test trials
to be included in analysis. Respective exclusions are reported
separately for each study.

## Stimuli and Counterbalancing

The set of studies presented here regard communication as a means for
solving coordination problems. In the most simple small-world scenario
an utterance or symbol, such as a graphic display, provided by a helpful
interlocutor should enable an addressee to shift attention to, or help
decide for one out of two options that are relevant in a particular
practical context and even in the absence of conventions
[@wittgenstein2009philosophical]. For the purpose of operationalization,
the context in the studies presented below is provided by a game of hide
and seek and the options are two hiding places that are distinct by
means of the graphic displays they are marked with. The aim was to test
at what age children become able to spontaneously use graphic displays
employing various dimensions of symbol-referent relationships. For this,
the graphic displays presented as referents were designed to saliently
differ in one relevant dimension and to be as similar as possible with
regard to other surface features. The referent, on the other hand, was a
reduced and less straight-lined graphic display akin to a hand drawing
that had something in common with one of the referents and is thereby
referring to it while it remains distinct with regard to other surface
features. In test trials, one of the possible referents serves as a
target and the other as a distractor. For counterbalancing, a second
referent was designed to refer to the other target, such that across
participants the same referents serve equally often as targets and
distractors. For an illustration of trial composition, see figure
\@ref(fig:plot-figure-setup) B and C. For each of the conditions in the
three studies below, four sets of stimuli were designed, consisting of
two blue shapes serving as target or distractor, and two drawings that
could serve as cues. Each condition covers a particular type of
symbol-referent relationship via four stimulus versions with two
variations each. For an example, consider figure \@ref(fig:plot-study1).
The first box in Panel B shows all stimuli for the *Representation*
condition. The first column exemplifies a set of targets (a blue square
and circle) and referents (outline drawings of a square and circle).
During test, participants are presented with four test trials per
condition, each composed of the shapes of a single column. During
testing, a child sees each trial combination only once and with only one
of the two possible cues. Across children, the position (left/right) of
the referent, and the identity of the cue are counterbalanced.

## Data Handling and Analyses

In each test trial, participants were prompted to touch one of the two
choice options. Choices were logged by the experimental script and
directly coded as correct or incorrect. Exclusions of data were solely
made on the level of participants with regard to the exclusion criteria
reported above. The analyses modeled children’s binary choices (0 =
incorrect, 1 = correct) to estimate the probability of interpreting cues
correctly and how this probability varied as a function of age and
condition. We fitted Bayesian logistic generalized linear mixed models
(GLMMs) with fixed effects for condition, standardized age, their
interaction, as well as trial number, and sex. To account for
subject-level variability, we included random intercepts and random
slopes for trial number by participant. Age and trial number were
standardized prior to modeling. To evaluate the relevance of age and
condition for children’s performance, a full model was compared with a
reduced model lacking the interaction of age and condition using Widely
Applicable Information Criterion (WAIC) scores and weights
[@mcelreath2018statistical] as well as the difference in Expected Log
Predictive Density (ELPD) via the function *loo_compare*. Furthermore,
model estimates were inspected for the different predictors including
their 95% Credible Interval (CrI). In each study, the condition
hypothesized as the most simple was set as the reference level within
conditions to make interpretation of model estimates convenient. All
Bayesian models used default priors and were run in Stan [@RStan] via
the function *brm* of the package *brms* [@burkner2017brms].

To answer the main research question of when children as a group
systematically make correct choices in any of the conditions outlined
below, we followed the approach of House and colleagues
[@House2017diverse; @House2013ontogeny] and plotted the model estimates
graphically as a smoothed curve surrounded by the respective confidence
intervals. We fitted models to predict the developmental trajectory
(with 95% CrI) of group level performance drawn from values of the
posterior predicted distribution via the function *fitted*. These
trajectories and CrIs were plotted by age. The criterion for settling
when children performed above chance was the point at which the lower
bound of the 95% CrI for a particular trajectory did no longer overlap
with a mid-line demarcating the 50% chance level. All analyses were
preregistered prior to data collection. Analyses deviate from the
preregistered analyses when comparing models via ELPD differences
[@sivula2020uncertainty]. This was simply not as common by the time of
preregistration.

For the convenience of the reader, we also provide conventional analyses
binning participants according to their age in years. To test whether
group-level performance was above chance in all experimental groups,
two-tailed one-sample t-tests with a chance level set to .5 were
computed and are accompanied by Cohen's *d* as a standardized effect
size for significance testing (cf. Appendix B Tables
\@ref(tab:suppl-descriptives-S1), \@ref(tab:suppl-descriptives-S2) and
\@ref(tab:suppl-descriptives-S3)).

**000** In addition to our main analyses, we preregistered an additional
exploratory analyses for evaluating item-level effects separately in
each study. For this we added a crossed random effect for items,
allowing the relationship between age and performance to vary across
items (correct \~ condition\*z.age + z.trial + sex + (z.trial \|
subid)). Due to the lower number of individual items within a task, we
expect this model to be less diagnostic with regard to our main research
question. However, it adds detail about the equivalence of items within
conditions.

# Study 1

Study 1 aimed to establish a baseline for children's performance and for
evaluating task demands by providing the most simple symbol-referent
relationship possible, where the cue is a direct representation of the
target (*Representation*). From this, three further conditions were
derived that were also employing form or shape as a means for
establishing reference but that were less iconic by either reducing the
amount of information provided (*Pars Pro Toto*), or the amount of
similarity between symbol and referent (*Simple Form Analogy*, *Complex
Form Analogy).* We hypothesized (and preregistered) that as a group
children will first succeed with *Representation*, then *Pars Pro Toto*,
*Simple Form Analogy* and finally *Complex Form Analogy*.

## Stimuli

To make the four conditions in study 1 as comparable as possible, they
are all employing the same target stimuli (cf. figure
\@ref(fig:plot-study1), panels A and B). In addition the two referents
within a trial can be seen as the round and square equivalents of each
other which makes their overall appearance even more similar and aids
matching the surface they cover. For the condition *Representation,* the
graphical cue is a direct representation, that is an outline drawing, of
the referent. The second condition, *Pars Pro Toto,* refers to the
targets by means of a part-whole relationship. This is still in
principle representational but provides less information and may require
children to complete the shapes according to gestalt principles. While
this completion is easiest in the first two items of *Pars pro Toto* due
to the canonical shapes (square, circle) it is less obvious with the
less canonical shapes albeit they are vertically and horizontally
symmetrical on purpose (cf. \@ref(fig:plot-study1) B, box 2). For
comparability, *Pars Pro Toto* uses the same graphical cues as
*Representation* but cut in half at a horizontal mid-line. A Stimulus
set of an individual trial either uses the top or bottom half, but both
variations are counterbalanced across trials. Stimulus variations with a
division at the vertical axis were avoided as such cues are likely to
have been read as arrows by children of the age that were tested here
[@kachelarrowsInPrep]. Two further conditions aimed to abstract from the
original representational symbol-referent relationship by providing
graphical analogies in form. In both *Simple Form Analogy* and *Complex
Form Analogy* the cue was an abstract line drawing being more round or
rectangular, thereby referring to either the round or rectangular
equivalent of the target shapes. As this has not been done before in
developmental research, our aim was to provide two versions of form
analogies both supporting children's comprehension in distinct ways. In
*Simple Form Analogy*, the cues are less dense and therefore more simple
to grasp, whereas the more complex versions in *Complex Form Analogy*
provide more information. Arguably either variation may support feature
extraction. As before, the cues in both conditions are direct
equivalents with either round or edgy drawing line progressions. For an
overview of all stimuli in Study 1, see figure \@ref(fig:plot-study1) B.

## Participants

A sample of `r rep.age.table.data["study1", "N"]` children (M =
`r rep.age.table.data["study1", "Mean"]` months, SD =
`r rep.age.table.data["study1", "SD"]` months, range
`r rep.age.table.data["study1", "Min"]` -
`r rep.age.table.data["study1", "Max"]` months;
`r rep.age.table.data["study1", "female"]` female) participated in
Study 1. In addition, `r rep.drop.table.data["study1", "N"]` children
(`r rep.drop.table.data["study1", "female"]` female) were tested but
excluded from analysis for not succeeding during familiarization (N =
`r rep.drop.table.data["study1", "fail_in_fam"]`), for not completing at
least eight out of 16 test trials (N =
`r rep.drop.table.data["study1", "quit_early"]`), or due to being fussy
(N = `r rep.drop.table.data["study1", "fussy_child"]`). For
`r rep.drop.table.data["study1", "language"]` children, experimenters
only learned during testing that they were not fluent enough in German
to participate as their families had only recently migrated. Finally,
`r rep.drop.table.data["study1", "technical"]` children had to be
excluded due to technical issues. For a graphical overview of
participants and exclusions across all three studies, see Appendix A
figures \@ref(fig:suppl-participants-dots) and
\@ref(fig:suppl-exclusions-dots).

## Analysis

A total of `r sum(rep.s1.trials$Trials)` trials (mean per condition =
`r mean(rep.s1.trials$Trials)`, range: `r min(rep.s1.trials$Trials)` -
`r max(rep.s1.trials$Trials)`) from
`r rep.age.table.data["study1", "N"]` participants were submitted for
analysis. The full model notation was
`correct ~ condition*z.age + z.trial + sex + (z.trial | subid)`. In
addition, a null model lacking the interaction of condition and age was
fitted. An additional exploratory analysis included an item level random
effect (Model notation
`correct ~ condition*z.age +z.trial +z.sex +(z.trial|id) +(z.age|item)`).

## Results

Posterior predictive checks (PPC) for both full and null model indicated
excellent fit of observed data and model predictions. Rhat values in
both models were equal to one, indicating convergence across all chains.
Effective sample sizes for all fixed effects in the full model (Bulk
ESS, mean = `r round(mean(S1.full.coef$ess_bulk), 0)`, range
`r round(min(S1.full.coef$ess_bulk), 0)` -
`r round(max(S1.full.coef$ess_bulk), 0)`) and the null model (Bulk ESS,
mean = `r round(mean(S1.null.coef$ess_bulk), 0)`, range
`r round(min(S1.null.coef$ess_bulk), 0)` -
`r round(max(S1.null.coef$ess_bulk), 0)`) were \> 1000, indicating
reliable posterior estimations.

Comparing the models using weights based on the Widely Applicable
Information Criterion (WAIC) yielded
`r round(S1.weights["S1.full.bm","value"]*100,2)`% of the model weight
for the full model, and
`r round(S1.weights["S1.null.bm","value"]*100,2)`% for the null model.
Hence, the full model generally had a higher probability of making
accurate predictions. Directly comparing the models' WAIC via expected
log predictive density (ELPD) corroborates this (ELPD WAIC; full model =
`r round(S1.comp["S1.full.bm", "elpd_waic"],2)`; null model =
`r round(S1.comp["S1.null.bm", "elpd_waic"],2)`). The standard error of
the difference in predictive accuracy (SE =
`r round(S1.comp["S1.null.bm", "se_diff"],2)`) is not much larger than
the difference itself (ELPD diff =
`r round(S1.comp["S1.null.bm", "elpd_diff"],2)`). Hence, evidence in
favor of this model is not decisive. A similar comparison via
Leave-One-Out Cross-Validation (LOO) provided essentially the same
results. In absence of conclusive evidence for either model, we report
the results for the full model in line with the preregistration.

Relative to the *Representation* condition, the *Simple Form Analogy*
($\beta$ = `r S1.full.coef["SimpleFormAnalogy", "mean"]`, 95% CrI
[`r S1.full.coef["SimpleFormAnalogy", "q2.5"]`,
`r S1.full.coef["SimpleFormAnalogy", "q97.5"]`) and *Complex Form
Analogy* ($\beta$ = `r S1.full.coef["ComplexFormAnalogy", "mean"]`, 95%
CrI [`r S1.full.coef["ComplexFormAnalogy", "q2.5"]`,
`r S1.full.coef["ComplexFormAnalogy", "q97.5"]`) have a considerably
lower probability of correct responses. The *Pars Pro Toto* condition
has no clear difference from the reference condition ($\beta$ =
`r S1.full.coef["ParsProToto", "mean"]`, 95% CrI
[`r S1.full.coef["ParsProToto", "q2.5"]`,
`r S1.full.coef["ParsProToto", "q97.5"]`). Interaction effects with age
were not relevant with the exception of *Pars Pro Toto*. Here, the
interaction with age was positive and just above zero ($\beta$ =
`r S1.full.coef["ParsProToto:z.age", "mean"]`, 95% CrI
[`r S1.full.coef["ParsProToto:z.age", "q2.5"]`,
`r S1.full.coef["ParsProToto:z.age", "q97.5"]`), suggesting that
performance increased more steeply across the age range than in the
reference condition *Representation*. Generally, participants’
performance improved with age in all conditions ($\beta$ =
`r S1.full.coef["z.age", "mean"]`, 95% CrI
[`r S1.full.coef["z.age", "q2.5"]`, `r S1.full.coef["z.age", "q97.5"]`).
In contrast, trial number has no clear effect on performance ($\beta$ =
`r S1.full.coef["z.trial", "mean"]`, 95% CrI
[`r S1.full.coef["z.trial", "q2.5"]`,
`r S1.full.coef["z.trial", "q97.5"]`), suggesting no evidence for
learning or fatigue throughout the test session.

Finally, by tracing when the lower bound of the 95% CrI exceeds the
chance level of 50%, it is possible to report when children's group
level performance becomes robustly systematic in favor of the correct
choice. In study 1, children perform above chance in the
*Representation* condition at least as early as
`r p1$months[p1$condition == "Representation"]` months, which is the
lower limit of the age-range. Quickly after, at
`r p1$months[p1$condition == "Pars Pro Toto"]` months, children succeed
in the *Pars Pro Toto* condition. In the more abstract conditions
*Simple Form Analogy* and *Complex Form Analogy*, preschoolers meet
criterion at `r p1$months[p1$condition == "Simple Form Analogy"]` and
`r p1$months[p1$condition == "Complex Form Analogy"]` months
respectively. For a side-by-side comparison of the developmental
trajectories in the four conditions of study 1, see figure
\@ref(fig:plot-study1). See appendix B table
\@ref(tab:suppl-S1-coef-table) for a full overview of coefficients for
the full model, and table \@ref(tab:suppl-descriptives-S1) for
additional conventional analyses binning participants according to their
age in years.

```{r plot-study1, fig.cap = "*Stimuli and Developmental Trajectories for Study 1.* Panels illustrate (A) an example stimulus combination (distractor, cue, target), (B) all items of the respective conditions and (C) results. Coloured lines indicate smoothed mean performance by age. Shaded areas represent 95% CIs. The dashed line demarcates chance level and the dots represent individual means. The coloroured dots and annotation indicate when children's performance exceeds chance level.", fig.align = "center", echo = FALSE, out.width = "95%"}

knitr::include_graphics(knitr::plot_crop("../illustrations/S1_complete.png"))

```

**111** An exploratory model with additional item-level random effects showed that the variability of intercepts at the item level was small ($\beta$ = `r S1.item.coef["sd_item__Intercept", "mean"]`, 95% CrI [`r S1.item.coef["sd_item__Intercept", "q2.5"]`,`r S1.item.coef["sd_item__Intercept", "q97.5"]`). Likewise there is only modest variation for the effect of age across items ($\beta$ = `r S1.item.coef["sd_item__z.age", "mean"]`, 95% CrI [`r S1.item.coef["sd_item__z.age", "q2.5"]`,`r S1.item.coef["sd_item__z.age", "q97.5"]`).
The correlation between item difficulty and item-specific age slopes was highly uncertain (ρ = `r S1.item.coef["cor_item__Intercept__z.age", "mean"]`, 95% CrI [`r S1.item.coef["cor_item__Intercept__z.age", "q2.5"]`,`r S1.item.coef["cor_item__Intercept__z.age", "q97.5"]`). Model weights based on the WAIC suggested that the full model was more likely to provide accurate predictions (weight =  `r round(S1.itemvsfull.weights["S1.full.bm","value"]*100,2)`% ) compared to the item model (weight = `r round(S1.itemvsfull.weights["S1.item.model","value"]*100,2)`%).The estimated difference in expected log predictive density (elpd) between models, however, was not much larger than the difference itself  (ELPD diff = `r round(S1.itemvsfull.comp["S1.item.model", "elpd_diff"],2)`), indicating considerable uncertainty as to whether either model was preferable. For on overview of logg odds for all items across conditions see figure \@ref(fig:plot-study123itemintercepts). For a full overview of coefficients and the random effects structure of the item model see table \@ref(tab:suppl-S1item-coef-table). Taken together, item-level effects appear negligible.

## Discussion

A main finding is that children succeed in *Representation* already and
robustly at 36 months of age, which is the lower end of our age-range.
Based on the literature, it is reasonable to assume that also in our
setup, children would be able to solve the task at hand between the
second and third birthday [@deloache1992picture; @callaghan2000factors;
@callaghan1999early]. In the context of the series of studies presented
below, this result establishes that the task design and setup are
sufficiently clear even for the youngest children in the sample. This is
also ensured by the 75% criterion of correct choices employed in the
familiarization phase. Exclusions due to this familiarization criterion
were comparably high at the lower end of the age-range (cf. Appendix A,
\@ref(fig:suppl-exclusions-dots)) suggesting that testing younger
children would require adjustments. The setup presented here worked
perfectly despite providing the same task across an age-range of four
years from the end of toddlerhood up into school age. The results for
*Representation* further illustrate that even the youngest children in
the sample understand a representational symbol-referent relationship as
operationalized here - with full-color target shapes and loose outline
drawings as cues - in the context of the picture-book-style
object-choice-task at hand. Finally, the CrI around the estimated mean
in the graphic presentation is getting narrower, showing that - as
children get older - they are behaving more uniformly, providing a
baseline for the uncertainty that can be expected with the current
operationalization. In summary, *Representation* provides a robust and
clear conceptual canvass against which the developmental patterns of all
other symbol-referent relationships can be discussed.

The first case in question then is *Pars Pro Toto*. Despite using
identical targets and - even partially identical cues - as in
*Representation* children succeed only at 40 months. The symbol-referent
relationship in *Pars pro Toto* is still based in visual similarity but
requires a slight inference, namely that a part can stand for a whole.
The interaction with age shows that performance improves more quickly
with age and that the area covered by the upper and lower CrI bounds
shrinks considerably across the age range. *Pars Pro Toto*, hence,
stands out as a clear example for a task that children come to master
early and within the age-range tested here, that generally is not
demanding for preschoolers in general. This contrasts with the less
steep developmental trajectories observed in the other two conditions of
study 1. *Simple Form Analogy* and *Complex form Analogy* share highly
similar developmental trajectories and, when considering the entire
age-range, appear equally difficult for participants. They appear as
examples for symbol-referent relationships that remain demanding for the
oldest children in the sample, and may require a second to solve or
describe verbally - even for adults. They are based in visual
similarity, but are conceptually demanding at the same time. With regard
to the influence of surface features, group level success occurs
slightly earlier with the reduced cues employed in *Simple Form
Analogy*. This suggests a slight benefit of stimuli that are easier to
grasp in line with the literature on analogical reasoning
[@gentner1988metaphor; @richland2006children]. Finally, the results are
perfectly in line with the hypothesized developmental succession of
group level success coming to pass first with *Representation*, then
*Pars Pro Toto*, *Simple Form Analogy* and *Complex Form Analogy*.

# Study 2

The conditions in study 2 continue to abstract from a representational
symbol-referent relationship by using different shapes for both cue and
target stimuli. The conditions here, draw on gestalt-principles like
figure-ground-relationship, continuity and parallelism. The
symbol-referent-relationship in *Absolute Position* is established by
the respective cue and target sharing the same position with regard to
the reference frame they occur in. In *Relative Position* cue and target
are each composed of two shapes. Reference is established by the
respective shapes being closer or further apart or sharing a position on
a horizontal or vertical axis. For *Orientation of Object*, symbol and
cue are aligned along the same axis. The final condition, *Orientation
of Feature* employs cue and target shapes with a salient feature that is
either oriented up- or downward. The preregistered hypothesis, assumed
children to perform above chance first in *Orientation of Object*, then
*Orientation of Feature*, *Absolute Position* and finally *Relative
Position*.

## Stimuli

For comparability, *Absolute Position* and *Relative Position* employed
the same distinct shapes as cue and target respectively (circle vs.
square, cross). In *Absolute Position* target positions were placed in
top and bottom, or central and peripheral conditions in half of trails.
For *Relative Position*, two trials present target stimuli that are
closer together or further apart, as well as another two trials with
target components being aligned on a horizontal or vertical axis. To
ensure that cue and target are maximally distinct in all dimensions,
cues and target items do not allign on the same axxis. As in study 1,
cues and targets are either round and rectangular shapes in these
conditions. To convey a sense of direction in *Orientation of Object,*
cues and targets feature elongated shapes that are aligned either on a
horizontal, vertical, or diagonal axis with rising or falling slope. The
shapes are distinct oblong elipses and rectangles or abstract shapes
with more or less round or square features. For *Orientation of
Feature*, targets and cues are either circles or squares with a salient
feature like an opening or a dent. While these shapes and features
alternate for the related cue and target, they are aligned up- or
downwards. As in study 1, cues in *Orientation of Feature* were oriented
on a vertical axis, to counter interpretations as arrow-like cues
[@kachelarrowsInPrep]. For an overview of all stimuli per condition in
Study 2, see figure \@ref(fig:plot-study2).

## Participants

A total of `r rep.age.table.data["study2", "N"]` three- to
seven-year-old children (M = `r rep.age.table.data["study2", "Mean"]`
months, SD = `r rep.age.table.data["study2", "SD"]` months, range
`r rep.age.table.data["study2", "Min"]` -
`r rep.age.table.data["study2", "Max"]` months;
`r rep.age.table.data["study2", "female"]` female) participated. In
addition, a total of `r rep.drop.table.data["study2", "N"]` children
(`r rep.drop.table.data["study2", "female"]` female) were tested but
excluded from analysis for failing familiarization (N =
`r rep.drop.table.data["study2", "fail_in_fam"]`), being fussy (N =
`r rep.drop.table.data["study2", "fussy_child"]`), not being fluent
enough in German to follow the instructions (N =
`r rep.drop.table.data["study2", "language"]`), or due to technical
issues (N = `r rep.drop.table.data["study2", "technical"]`).

## Analysis

A total of `r sum(rep.s2.trials$Trials)` trials (mean per condition =
`r mean(rep.s2.trials$Trials)`, range: `r min(rep.s2.trials$Trials)` -
`r max(rep.s2.trials$Trials)`) from
`r rep.age.table.data["study2", "N"]` participants were submitted for
analysis. The full model notation was
`correct ~ condition*z.age + z.trial + sex + (z.trial | subid)`. In
addition, a null model lacking the interaction of condition and age was
fitted as well as an exploratory model including an item-level random
effect (Model notation
`correct ~ condition*z.age +z.trial +z.sex +(z.trial|id) +(z.age|item)`).

## Results

For both full and null model, PPCs indicate excellent fit of observed
data and model predictions. Rhat values in both models were equal to
one, indicating convergence across all chains. Effective sample sizes
for all fixed effects in the full model (Bulk ESS, mean =
`r round(mean(S2.full.coef$ess_bulk), 0)`, range
`r round(min(S2.full.coef$ess_bulk), 0)` -
`r round(max(S2.full.coef$ess_bulk), 0)`) and the null model (Bulk ESS,
mean = `r round(mean(S2.null.coef$ess_bulk), 0)`, range
`r round(min(S2.null.coef$ess_bulk), 0)` -
`r round(max(S2.null.coef$ess_bulk), 0)`) were \> 1000, indicating
reliable posterior estimations.

To compare model performance, we evaluated the WAIC estimates. The null
model showed a slightly better predictive performance (ELPD =
`r round(S2.comp["S2.null.bm","elpd_waic"],2)`) compared to the full
model (ELPD = `r round(S2.comp["S2.full.bm","elpd_waic"],2)`). WAIC
values also indicate better performance of the null model (WAIC =
`r round(S2.comp["S2.null.bm", "waic"],2)`) over the full model (WAIC =
`r round(S2.comp["S2.full.bm", "waic"],2)`). However, the difference
between models (ELPD Diff =
`r round(S2.comp["S2.full.bm", "elpd_diff"],2)`) falls within the bounds
of uncertainty (SE = `r round(S2.comp["S2.full.bm", "se_diff"],2)`),
suggesting no advantage in predictive accuracy. Hence, the preregistered
analyses using the full model is reported below.

Across all conditions, performance improved with both age ($\beta$ =
`r S2.full.coef["z.age", "mean"]`, 95% CrI
[`r S2.full.coef["z.age", "q2.5"]`, `r S2.full.coef["z.age", "q97.5"]`)
and slightly with trial number ($\beta$ =
`r S2.full.coef["z.trial", "mean"]`, 95% CrI
[`r S2.full.coef["z.trial", "q2.5"]`,
`r S2.full.coef["z.trial", "q97.5"]`). Relative to *Absolute Position*,
children were generally less likely to correctly solve *Relative
Position* ($\beta$ = `r S2.full.coef["RelativePosition", "mean"]`, 95%
CrI [`r S2.full.coef["RelativePosition", "q2.5"]`,
`r S2.full.coef["RelativePosition", "q97.5"]`). Performance in
*Orientation of Object* ($\beta$ =
`r S2.full.coef["OrientationofObject", "mean"]`, 95% CrI
[`r S2.full.coef["OrientationofObject", "q2.5"]`,
`r S2.full.coef["OrientationofObject", "q97.5"]`) and *Orientation of
Feature* ($\beta$ = `r S2.full.coef["OrientationofFeature", "mean"]`,
95% CrI [`r S2.full.coef["OrientationofFeature", "q2.5"]`,
`r S2.full.coef["OrientationofFeature", "q97.5"]`) was not substantially
different from the reference category when considering the full age
range. Interaction terms between age and condition were not credibly
different from zero, suggesting similar developmental patterns for all
conditions. Tracing the lower bound of the 95% CrI against the 50%
chance level (cf. figure \@ref(fig:plot-study2)), the model establishes
that children master the condition *Absolute Position* at
`r p2$months[p2$condition == "Absolute Position"]` months, making it the
easiest task in study 2. Then in quick succession, children succeed in
*Orientation of Feature* at
`r p2$months[p2$condition == "Orientation of Feature"]` months,
*Relative Position* at
`r p2$months[p2$condition == "Relative Position"]` months and
*Orientation of Object* at
`r p2$months[p2$condition == "Orientation of Object"]` months. For a
side-by-side comparison of the developmental trajectories, see figure
\@ref(fig:plot-study2). For an additional conventional analysis binning
participants according to their age in years, see table
\@ref(tab:suppl-descriptives-S2) in appendix B. See appendix B table
\@ref(tab:suppl-S2-coef-table) and table
\@ref(tab:suppl-descriptives-S2) for an overview of model coefficients.

```{r plot-study2, fig.cap = "*Stimuli and Developmental Trajectories for Study 1.* Panels illustrate (A) an example stimulus combination (distractor, cue, target), (B) all items of the respective conditions and (C) results. Coloured lines indicate smoothed mean performance by age. Shaded areas represent 95% CIs. The dashed line demarcates chance level and the dots represent individual means. The coloroured dots and annotation indicate when children's performance exceeds chance level.", fig.align = "center", echo = FALSE, out.width = "95%"}

knitr::include_graphics(knitr::plot_crop("../illustrations/S2_complete.png"))

```

**222** An exploratory model including item-level random effects indicated modest variability ($\beta$ = `r S2.item.coef["sd_item__Intercept", "mean"]`, 95% CrI [`r S2.item.coef["sd_item__Intercept", "q2.5"]`,`r S2.item.coef["sd_item__Intercept", "q97.5"]`). The variability of age effects across items was small ($\beta$ = `r S2.item.coef["sd_item__z.age", "mean"]`, 95% CrI [`r S2.item.coef["sd_item__z.age", "q2.5"]`, `r S2.item.coef["sd_item__z.age", "q97.5"]`), suggesting that the effect of age was fairly consistent across items. The correlation between item intercepts and age slopes was near zero and highly uncertain (ρ = `r S2.item.coef["cor_item__Intercept__z.age", "mean"]`, 95% CrI [`r S2.item.coef["cor_item__Intercept__z.age", "q2.5"]`,`r S2.item.coef["cor_item__Intercept__z.age", "q97.5"]`), providing no reliable evidence that slightly easier or difficult items varied in age-related gains. Comparing the models using WAIC weights showed that including item-level random effects in Study 2 did not provide a clear advantage in out-of-sample predictive accuracy (full model `r round(S2.itemvsfull.weights["S2.full.bm","value"]*100,2)`%; item model `r round(S2.itemvsfull.weights["S2.item.model","value"]*100,2)`%). Directly comparing the models corroborates this (ELPD WAIC; full model = `r round(S2.itemvsfull.comp["S2.full.bm", "elpd_waic"],2)`; item model = `r round(S2.itemvsfull.comp["S2.item.model", "elpd_waic"],2)`). The difference in expected log predictive density was negligible (ELPD diff = `r round(S2.itemvsfull.comp["S2.item.model", "elpd_diff"],2)`), and within the range of sampling uncertainty (SE =`r round(S2.itemvsfull.comp["S2.item.model", "se_diff"],2)`). For an overview of item level variability across conditions see figure \@ref(fig:plot-study123itemintercepts). For a full table of coefficients and random effects of the exploratory model see table \@ref(tab:suppl-S2item-coef-table). Taken together, the inclusion of item-level random effects did not meaningfully improve model fit and both models account for the data equally well.

## Discussion

We hypothesized that children as a group would perform above chance
earlier with *Absolute Position* than with *Relative Position* due to
the latter obviously requiring children to integrate a higher number of
items. Results confirm this assumption with a clear 5-months offset in
the age of success. We hypothesized further that children would succeed
earlier with *Orientation of Object* than *Orientation of Feature*, due
to the necessity of evaluating the composition of a target item rather
than its general alignment with the cue. Here, we find the opposite to
be true. The impression of direction or congruence between cue and
target appears to be much more salient for children in graphic stimuli
with a salient feature pointing out such as in *Orientation of Feature*,
than an overall alignment in the horizontal, vertical or diagonal
orientation. However, an overall picture emerges from the results of
study 2: with stimuli that are not primarily drawing on representational
symbol-referent relationships but that are based in more conceptual
Gestalt principles, children generally come to perform above chance
closely around the fourth birthday. Arguably, all four of these
conditions still have an iconic aspect to them with regard to the
overall gestalt of the displays. Study 3 set out to further reduce the
amount of iconicity and investigate fully abstract reference.

# Study 3

The final study features symbol-referent relationships that are based on
analogies in size or number without cues and targets sharing
similarities in other visual aspects, and while avoiding to draw on
conventions in graphic communication. In order to correctly interpret
the symbol-referent relationships employed here, children need to assign
or extract conceptual order in graphical displays. Such processes can be
fostered or obstructed by surface level features of the stimuli at hand
which makes it harder to assess whether the age at which children master
a task - our primary aim of investigation - depends more on the ability
to generally form symbol-referent relationships from analogies or from
children's developing ability to process visual complexity. The two base
conditions of study three are *Size of Object* and *Size of Number.*
Here the cues refer to a target shape as a whole via an analogy in size
or number. They are complemented by the conditions *Size of Feature* and
*Number of Feature* in which the cues refer to a salient aspect of the
target stimuli. In these cases, extracting conceptual information is
arguably more demanding. The overall performance across the ages as well
as the relative offset in the age at which children solve a task based
on symbol-referent relationships targeting objects or their features,
can then serve to evaluate such surface-level effects across two
different domains. Prior to data collection, we hypothesized that
children will succeed earlier with symbol-referent relationships based
in size than in number, and that children will succeed earlier when cues
refer to a target object per se rather than a salient feature thereof.

## Stimuli

In *Size of Object* the targets in a each trial are identical shapes
that are either small or large with regard to the reference frame they
are presented in. To make cue and target shapes as distinct as possible
they are again employing either squares or circles respectively or fully
abstract shapes such as a random scribble or straight lines (cf. figure
\@ref(fig:plot-study3) B). For comparability, *Size of Feature* employs
the exact same cues as *Size of Object*, but features target shapes with
either a relatively large or small void, opening, or protrusion. In
*Number of Object*, cues and targets are composed of different shapes
with some being simple line drawings. The displayed quantities were 1
versus 3, and 2 versus 4. Already in infancy children can discriminate 1
versus 3 [@feigenson2002representations]. Three- and four-year-olds can
reliably distinguish these magnitudes explicitly and implicitly without
counting [@mix2002quantitative; @halberda2008developmental;
@huntley2000preschoolers]. Special attention was paid to the arrangement
of the objects to ensure that the cue and target objects do not share
visually similarity by forming a similar pattern, which is difficult as
such small number arrays lend themselves to being grouped into canonical
shapes by Gestalt principles such as proximity and closure. This issue
was addressed by presenting the targets depicting the magnitudes three
and four as if outlining irregular shapes. By contrast, the
corresponding cues were aligned along a vertical of horizontal axis. For
comparability, *Number of Feature* employs the same cues as *Number of
Object*. To evoke a sense of quantity in the closed forms serving as
referents, the target shapes in *Number of Feature* either have salient
protrusions, or partial areas resulting from incisions. For an overview
of all stimuli presented in Study 3, see figure \@ref(fig:plot-study3).

## Participants

A total of `r rep.age.table.data["study3", "N"]` three- to
seven-year-old children (M = `r rep.age.table.data["study3", "Mean"]`
months, SD = `r rep.age.table.data["study3", "SD"]` months, range
`r rep.age.table.data["study3", "Min"]` -
`r rep.age.table.data["study3", "Max"]` months;
`r rep.age.table.data["study3", "female"]` female) participated. In
addition, `r rep.drop.table.data["study3", "N"]` children
(`r rep.drop.table.data["study3", "female"]` female) were tested but
excluded for low performance during familiarization (N =
`r rep.drop.table.data["study3", "fail_in_fam"]`), for not completing at
least eight out of 16 test trials (N =
`r rep.drop.table.data["study3", "quit_early"]`), or being fussy (N =
`r rep.drop.table.data["study3", "fussy_child"]`). Further exclusions
were necessary due to language problems (N =
`r rep.drop.table.data["study3", "language"]`) and technical issues (N =
`r rep.drop.table.data["study3", "technical"]`).

## Analysis

For study three, `r sum(rep.s3.trials$Trials)` trials (mean per
condition = `r mean(rep.s3.trials$Trials)`, range:
`r min(rep.s3.trials$Trials)` - `r max(rep.s3.trials$Trials)`) from
`r rep.age.table.data["study3", "N"]` participants were submitted for
analysis. Data were analyzed both with a full model
(`correct ~ condition*z.age + z.trial + sex + (z.trial | subid)`), a
null model lacking the interaction of condition and age and an
additional exploratory model including an item-level random effect
(Model notation
`correct ~ condition*z.age +z.trial +z.sex +(z.trial|id) +(z.age|item)`).

## Results

PPCs indicated excellent fit of observed data and model predictions in
both models. Model diagnostics were drawn for the full and null model in
study 3. Rhat values in both models were equal to one, indicating
convergence across all chains. Effective sample sizes for all fixed
effects in the full model (Bulk ESS, mean =
`r round(mean(S3.full.coef$ess_bulk), 0)`, range
`r round(min(S3.full.coef$ess_bulk), 0)` -
`r round(max(S3.full.coef$ess_bulk), 0)`) and the null model (Bulk ESS,
mean = `r round(mean(S3.null.coef$ess_bulk), 0)`, range
`r round(min(S3.null.coef$ess_bulk), 0)` -
`r round(max(S3.null.coef$ess_bulk), 0)`) were \> 1000, indicating
reliable posterior estimations.

When comparing performance, the full model showed a better fit (ELPD =
`r round(S3.comp["S3.full.bm","elpd_waic"],2)`) relative to the null
model (ELPD = `r round(S3.comp["S3.null.bm","elpd_waic"],2)`). The WAIC
values also favored the full model (WAIC =
`r round(S3.comp["S3.full.bm", "waic"],2)`) over the null model (WAIC =
`r round(S3.comp["S3.null.bm", "waic"],2)`). Despite the slightly lower
WAIC and higher ELPD of the full model, the difference in predictive
accuracy (ELPD Diff = `r round(S3.comp["S3.null.bm", "elpd_diff"],2)`)
remains almost within the range of sampling uncertainty (SE =
`r round(S3.comp["S3.null.bm", "se_diff"],2)`). In the absence of
substantial differences, the full model is reported below in line with
the preregistration.

Overall, children's performance increased with age ($\beta$ =
`r S3.full.coef["z.age", "mean"]`, 95% CrI
[`r S3.full.coef["z.age", "q2.5"]`, `r S3.full.coef["z.age", "q97.5"]`)
and with trial number ($\beta$ = `r S3.full.coef["z.trial", "mean"]`,
95% CrI [`r S3.full.coef["z.trial", "q2.5"]`,
`r S3.full.coef["z.trial", "q97.5"]`), indicating general improvement
across development and time-on-task. Relative to *Size of Object*,
participants were substantially less accurate in *Size of Feature* (beta
= `r S3.full.coef["SizeofFeature", "mean"]`, 95% CrI
[`r S3.full.coef["SizeofFeature", "q2.5"]`,
`r S3.full.coef["SizeofFeature", "q97.5"]`). A smaller, marginal effect
was observed in *Number of Feature* ($\beta$ =
`r S3.full.coef["NumberofFeature", "mean"]`, 95% CrI
[`r S3.full.coef["NumberofFeature", "q2.5"]`,`r S3.full.coef["NumberofFeature", "q97.5"]`).
*Number of Object* ($\beta$ =
`r S3.full.coef["NumberofObject", "mean"]`, 95% CrI
[`r S3.full.coef["NumberofObject", "q2.5"]`,
`r S3.full.coef["NumberofObject", "q97.5"]`) did not differ reliably
from *Size of Object*. Age moderated performance less strongly in *Size
of Feature* ($\beta$ = `r S3.full.coef["SizeofFeature:z.age", "mean"]`,
95% CrI [`r S3.full.coef["SizeofFeature:z.age", "q2.5"]`,
`r S3.full.coef["SizeofFeature:z.age", "q97.5"]`) and *Number of
Feature* ($\beta$ = `r S3.full.coef["NumberofFeature:z.age", "mean"]`,
95% CrI [`r S3.full.coef["NumberofFeature:z.age", "q2.5"]`,
`r S3.full.coef["NumberofFeature:z.age", "q97.5"]`), suggesting lower
developmental gains compared to *Size of Object*. Generally, the
conditions relying on feature-based reference are associated with lower
overall performance and weaker developmental gains. The best overview of
the relative performance across conditions is provided by plotting the
model estimates (cf. figure \@ref(fig:plot-study3)). Children succeed in
most conditions just after the fourth birthday. Model estimates indicate
group level success in *Size of Object* at
`r p3$months[p3$condition == "Size of Object"]` months, *Number of
Object* at `r p3$months[p3$condition == "Number of Object"]` months, and
*Number of Feature* at
`r p3$months[p3$condition == "Number of Feature"]` months. The exception
to this pattern is *Size of Feature* where children master the task no
sooner than `r p3$months[p3$condition == "Size of Feature"]` months of
age. For an overview of model coefficients see table table
\@ref(tab:suppl-S3-coef-table), appendix B. For alternative analyses
binning children by year of age, please see table
\@ref(tab:suppl-descriptives-S3) (ibid).

```{r plot-study3, fig.cap = "*Developmental Trajectories for all Conditions in Study 3.* Panels illustrate example stimulus combinations (distractor, cue, target) and results. Coloured lines indicate smoothed mean performance by age. Shaded areas represent 95% CrIs. The dashed line demarcates chance level and the dots represent individual means. The coloured dots and annotation indicate when performance exceeds chance level.", fig.align = "center", echo = FALSE, out.width = "95%"}

knitr::include_graphics(knitr::plot_crop("../illustrations/S3_complete.png"))

```

**333** To evaluate the equivalence of items within conditions, item-level random effects were included in an exploratory model showing that item variation at the intercept was moderate ($\beta$ = `r S3.item.coef["sd_item__Intercept", "mean"]`, 95% CrI [`r S3.item.coef["sd_item__Intercept", "q2.5"]`,`r S3.item.coef["sd_item__Intercept", "q97.5"]`) and that the effect of age varied slightly across items ($\beta$ = `r S3.item.coef["sd_item__z.age", "mean"]`, 95% CrI [`r S3.item.coef["sd_item__z.age", "q2.5"]`,`r S3.item.coef["sd_item__z.age", "q97.5"]`). Again, the correlation between item difficulty and item-specific age slopes was moderately positive but uncertain (ρ = `r S3.item.coef["cor_item__Intercept__z.age", "mean"]`, 95% CrI [`r S3.item.coef["cor_item__Intercept__z.age", "q2.5"]`,`r S3.item.coef["cor_item__Intercept__z.age", "q97.5"]`) providing weak evidence that easier items had stronger age-related gains.
Comparing the models using WAIC weights showed that the item model had higher predictive power (full model `r round(S3.itemvsfull.weights["S3.full.bm","value"]*100,2)`%; item model `r round(S3.itemvsfull.weights["S3.item.model","value"]*100,2)`%). Directly comparing the models' WAIC via ELPDs corroborates this (full model = `r round(S3.itemvsfull.comp["S3.full.bm", "elpd_waic"],2)`; 
item model = `r round(S3.itemvsfull.comp["S3.item.model", "elpd_waic"],2)`). The difference in expected log predictive density favored the item model (ELPD diff = `r round(S3.itemvsfull.comp["S3.full.bm", "elpd_diff"],2)`), though the uncertainty around this estimate suggests that the evidence is not decisive (SE =`r round(S3.itemvsfull.comp["S3.full.bm", "se_diff"],2)`). Graphically exploring item-level variability via logg odds indicates that items are still very similar with their estimated deviation from the intercept still including zero (cf. figure \@ref(fig:plot-study123itemintercepts)). For an overview of coefficients and random effects see table \@ref(tab:suppl-S3item-coef-table) in appendix 3. Taken together, further exploring the data by including item-level random effects yielded moderate variability which means in study 3 there is modest evidence for variability due to item level effects. However these are small compared to participant random effects. Model comparisons provided no strong evidence for deterring from our preregistered analysis.

## Discussion

We hypothesized that children will succeed earlier with analogies in
size than in number, and that children will succeed earlier when cues
refer to the target objects per se rather than salient features thereof.
We find limited support for the hypothesis that the feature conditions
are generally more demanding. However, that children succeed a month
earlier in *Number of Object* than in *Size of Object* as hypothesized
is negligible especially in the context of the four year age-range that
is considered here. *Size of Feature* stands out as the most difficult
condition in the series of studies presented here with group-level
success at 59 months. It is arguably quite demanding as it is a highly
conceptual symbol-referent relationship and the only condition that
requires children to consider proportions within the composition of the
target stimulus. *Size of Object* demonstrates that children generally
can grasp form analogies earlier with the exact same cues and *Absolute
Position* and *Relative Position* from study 2 indicate that children
can also master figure-ground relationships or relational patterns in
targets even prior to the fourth birthday. Taken together, results
further indicate that children are solving analogy-based symbol-referent
relationships just after the fourth birthday, as if - provided that a
critical level of reasoning development is attained - children can
generally dismiss surface level features and focus on conceptional
dimensions [@gentner1988metaphor; @richland2006children] and flexibly
employ their analogical reasoning skills in communicative contexts
regardless of the specific conceptual dimensions such as number or size.

# Discussion

We presented a concerted three-part research project tracing young
children’s ability to spontaneously comprehend unfamiliar graphic
symbols in an object-choice task across a wide variety of
symbol-referent relationships. In three studies with four conditions
each, we collected data of two children per month of age continuously
from the third to the seventh birthday for a final sample of 304
children (Study 1, N = 106; Study 2, N = 99; Study 3, N = 99). Using
Bayesian GLMMs, we were able to determine the month of age at which
children as a group perform above chance with each symbol-referent
relationship. Across the various conditions, symbolic reference between
cue and target was established via direct representation, a part-whole
relationship, analogies in size, number and shape, as well as
gestalt-like principles like figure-ground relationships, orientation
and alignment. While previous work on graphic communication has focused
almost exclusively on iconicity as a way of creating meaning and
compared performance across binned age-groups, the three studies
presented here map development continuously using a highly simple and
streamlined procedure across various conceptual dimensions.

In Study 1, we found that - with cues that are direct outline drawings
of the items they refer to - children are robustly better than chance at
the lower boundary of our age-window. Representation was the most basic
condition in the set and yields above-chance performance at 36 months.
This demonstrates that the general task design and setup are
sufficiently clear even for the youngest children in the sample, and
that at the latest by three years of age children understand the
pragmatics of a representational graphic cue in the context of the
picture-book-style object-choice-task at hand. A second condition, Pars
Pro Toto, used the exact same stimuli, but the cues provided only half
of the respective figures to guide children’s choices. While cues are
highly similar and targets even identical, children solve Pars Pro Toto
no sooner than at 38 months of age. This demonstrates that by three
years of age, children’s symbolic competence is still fragile if
additional steps such as the straightforward completion of canonic shape
is necessary for referential inference. Two further conditions aimed at
abstracting from the cue representations while still retaining
characteristic features of the target shapes with regard to an analogy
in form, namely whether they were more round or edgy. Simple Form
Analogy provided relatively simple shapes as cues with success at 47
months, and Complex Form Analogy more elaborate patterns with success at
50 months. To the best of our knowledge, this is the first time a
developmental setup features abstract shape as a means of disambiguation
in graphic communication and does so with an analysis open to detecting
the advent of the competence necessary to solve this problem. Taken
together, study 1 provides a within-subjects comparison of young
children’s ability to read representational, metonymical and
metaphorical uses of form in graphic communication, showing that while
iconicity marks the entry point for the comprehension of graphic cues,
abstract representations are only accessible by the fourth year even in
the highly restricted referential space provided by a two-option
object-choice coordination problem.

Study 2 explored whether children can infer symbol-referent
relationships based on orientation and position. In all of the four
conditions, cue and target had different shapes, which strictly limited
the role of iconicity on the level of the individual cues used in the
stimulus compositions. In Absolute Position, cue and target placement
were aligned in their frame of presentation (e.g. the paper that the
symbol was drawn on) and the symbol-referent relation was established by
the respective positions in their immediate visual context. Here
children succeeded at 44 months of age. In Relative Position, the target
and cue were composed of two figures each that were either closer
together or further apart, or aligned on a vertical or horizontal axis.
Here children perform above chance at 49 months of age. Success even
prior to the fourth birthday in these conditions is remarkable as it
requires children to identify and compare relations (Absolute Position –
figure/ground; Relative Position – figure/figure) which is demanding
even later throughout the preschool years in other contexts
[@shivaram2023children]. Orientation of Object featured elongated shapes
that were oriented either horizontally or vertically while cue and
target shared the same direction. Previous research employing a
same-different task indicates that children are sensitive to spatial
alignment along a common axis in juxtaposed graphic displays no sooner
than six to eight years of age [@yinyuan2022a]. In the straightforward
context of our study, children succeeded at 50 months. Contrary to our
preregistered prediction, children succeed even earlier - at 47 months -
in the complementary condition Orientation of Feature. In this
condition, the cues and targets had a feature like a bump or an opening
that is oriented either up- or downward. That the orientation of a
feature of a graphic display (bump, opening, indentation) appears more
salient than its overall orientation is surprising but aligns with
recent work on children’s spontaneous ability to read asymmetric shapes
as unconventional arrow cues, already prior to 48 months
[@kachelarrowsInPrep]. In summary, Study 2 addresses an interesting
caveat in previous research by presenting stimulus sets where symbol and
referent feature different shapes but are composed in similar ways.
While this requires uncovering abstract relations, these relations are
by design still based on resemblance on the level of the overall
composition, and hence, cover a middle ground between iconic and
abstract representations that yet has not been operationalized in
developmental work on graphic communication.

Since all four conditions in study 2 have an iconic aspect to them.
Study 3 set out to further reduce the amount of iconicity by drawing
abstract analogies in size and number. In the final study, the stimuli
used as cue and target/distractor had nothing in common except for their
relative magnitude in size and number. Number of Object featured graphic
displays with one or three items per target or referent. Number of
Feature reuses the same cues but employs targets varying in number with
regard to salient features (e.g., spikes or dents). Children succeed in
both conditions at 50 months. A crucial advantage of the study design
and analytical approach employed here is not only that it allows to
determine when children as a group are able to solve the respective
conditions, but it also provides a comparison of the respective
developmental trajectories. For example, performance rates on Number of
Feature and Number of Object share the same cut-off for group-level
success, but the curve for the number of features items has a more
gradual growth, suggesting that it may still be slightly more demanding.
A different pattern emerges for the two conditions featuring size
relationships. Children succeed at 49 months of age in Size of Object,
but ten months later in Size of Feature in which target and distractor
figures have a small or large opening, bump or hole. This aligns with
research showing that while preschoolers are generally sensitive to the
canonical size of objects depicted in graphical displays [@long2019real;
@cox2005pictorial; @bloom1998intention] they are much less likely to
spontaneously extract size relations among abstract shapes
[@kroupin2022you].

A set of major findings emerges from the studies presented here. First,
our results robustly confirm that symbol-referent relationships are
easiest for children when they are based in iconicity and become
gradually more difficult as visual similarity decreases
[@ganea2008transfer]. The findings presented here perfectly illustrate
how children are generally able to grasp and benefit from graphic means
of communication but that access to conceptual information appears to
develop later in the preschool years [@callaghan2000factors]. These
findings are of practical relevance for early childhood education as
they showcase children’s ability to use various expressive dimensions in
the graphic domain and can guide the design of pedagogical materials by
showing specifically how accessible various ways of conveying meaning in
graphic design may be at various ages.

Second, the reduced accuracy in analogy-based and feature-referenced
tasks are both consistent with evidence that younger children tend to
focus on surface features rather than relations [@rattermann1998more;
@gentner2017analogy], making tasks that require attentional shifting or
nested comparison structures particularly demanding
[@halford1998processing]. Relational or abstract as opposed to
feature‑based processing taxes working memory and inhibitory control
more strongly [@gick1980analogical; @goswami1991analogical]. This, in
turn, points to aspects of cognitive maturation that are likely to
foster children’s performance in the tasks outlined above, as seen in
work on the development of executive functions — particularly the early
emergence and developmental trajectories of working memory, inhibitory
control, and cognitive flexibility in childhood
[@deluca2010developmental; @diamond2013executive;
reilly2022developmental].

Third, just around their fourth birthday at 50 months of age, children
are generally able to identify various types of analogies spontaneously
in unfamiliar symbolic displays. Previous findings have challenged
assumptions of domain specificity in symbol development modalities such
as graphic, gestural or verbal communication and rather highlighted the
flexibility of symbolic and pragmatic abilities [@callaghan1999early].
Our findings champion a similar perspective with regard to various
conceptual or basic graphic dimensions and underline the flexibility of
symbolic cognition across various symbol-referent relationships within
the graphic domain. For conditions that relied strongly on children to
abstract from surface level features and focus on analogies in form,
orientation, size and number, there is no strong evidence for sequences
in the ages of success. Rather, children appear to master all
symbol-referent relationships almost at the same point in time, which is
highly indicative of a qualitative shift in pragmatic and analogical
reasoning skills in the fourth year that drive children’s ability for
solving communicative coordination problems across various
symbol-referent relationships.

To the extent that the studies presented above highlight the fourth
birthday as a milestone in symbolic development, this connects to a rich
literature on major developmental shifts in this important period of
middle-childhood. As change at this age is again rapid and foundational
across a variety of cognitive processes [@karmiloff1994beyond;
@rakoczy2022foundations], several factors are likely to contribute to
the convergence of above-chance performance across the experimental
conditions used here. What has been described as the
four-year-revolution in social cognition endows children with a
full-fledged metarepresentational theory of mind and firmly developed
belief-desire psychology [@rakoczy2022foundations; @wellman2001meta;
@gopnik1988children]. Theory of mind performance, in turn, was shown to
be correlated with representational insight into the
standing-for-relationship of pictorial representations
[@callaghan2012young], as well as insight into communicative intent
[@callaghan2008children], and qualitative shifts in perspective-taking
abilities [@flavell1981young]. All of which are necessary or conducive
for the flexible and spontaneous interpretation of graphic displays as
well as inference-based or pragmatically challenging communicative
behavior broadly construed. Specifically helpful for the tasks employed
here may be developmental gains typically occurring around the fourth
birthday in the domain of analogical reasoning [@shivaram2023children;
@christie2014language; @gentner1977children], which are again fostered
by parallely growing capacities in working memory [@simms2018working;
@richland2006children], executive functions [@thibaut2010development;
@bohn2023individual] and inhibitory control [@carlson2007inhibitory;
@jablonski2014inhibitory].

While ork on analogical reasoning abilities has highlighted that
preschoolers are generally able to identify agreement in graphic
displays and specifically involving size, number, and shape also at the
age of four [@kroupin2022you; @kroupin2022importance], this has mostly
been established in match-to-sample paradigms where children are
conventionally presented with three items and prompted with a phrase
such as “which ones go together” directly inducing the cognitive
operation tested. In our task, children make matches and comparisons
across various dimensions without any verbal scaffolding addressing the
match-making process or the dimension of comparison and, hence,
showcases abilities for implicit judgements across a wide variety of
basic conceptual and visual features. Therefore, our work provides a
crucial extension to the literature on analogical reasoning by showing
that children can actually put their developing skills to work in the
practical context of a versatile communicative coordination game
requiring both relational reasoning and pragmatic inference.

Taken together, our work provides one of the most comprehensive, robust
and systematic investigations of young children’s ability to find
meaning in unfamiliar graphic symbols and may provide a benchmark data
set for the development of preschoolers symbolic competence. Yet by
design, the project is exploratory and while it traces symbolic
development across the preschool years, it has limitations that future
research needs to address. A crucial problem is that the project aims to
establish robust developmental trajectories but does so only in a
single, industrialized population [@henrich2010weirdest] that is
spending their days immersed in symbolic artefacts and being educated
almost daily by preschool curricula geared to prepare them for
script-centered formal education. Future work needs to address the role
of enculturation and specifically the influence of permanent exposure to
symbolic and pictorial illustrations, writing and numbers or depictions
featuring canonical shapes - ideally doing so both by investigating
children in various cultural settings, as well as less industrialized
communities, with a much more limited access and exposure to symbolic
artefacts in their daily routines [@dehaene2006core;
@callaghan2012young; @martlew1996human; @zhu2025investigating;
@zhu2025development]. Second, having established several milestones for
symbolic development across various symbol-referent relationships in a
cross-sectional design, we can only explain patterns or shifts by
reference to developments occurring at similar developmental stages. Our
work needs to be complemented with studies employing an
individual-differences perspective to untangle the relative
contributions of knowledge about various conventional systems of
reference, pragmatic skills and the growth of basic level cognitive
capacities. Finally, it would be highly valuable to complement the
current results on the comprehension of unfamiliar symbols by
establishing at what ages children would be able to use their skills in
the production of graphic communication and, thereby, inform theories on
the development of communication systems broadly construed. Currently,
our work highlights that iconicity is key in establishing new
communication systems [@fay2014iconicity] and that more abstract systems
of reference may then build on these [@cooperrider2019career;
@gentner2019metaphoric]. Finally, findings support experimental work on
the development of communication systems by showing children at four
years of age are already extremely flexible and skilled communicators
ready to spontaneously decode novel means and systems of communication
without explicit instruction or training [@bohn2019young;
@raviv2018systematicity]. It would be extremely interesting to see at
what ages and under what specific set of circumstances
[@nolle2020language; @nolle2022field] young children may begin to use
various dimensions of graphic communication for disambiguating reference
[@nolle2018emergence] or establishing a even compositional communication
systems [@bohn2019young] when producing signs themselves. Our work here
demonstrates that at least by the age of four, they would be apt
receivers of symbolic creations whose reference is based on iconicity,
metonymy, alignment, orientation, as well as analogies in form, size and
number.

The work presented here provides a clear and methodologically rigorous
account of early symbolic development. Its straightforward streamlined
design, conceptual breadth, robust sample, and open but fine-grained
statistical approach offer a reliable foundation for precisely the
future work outlined here and already address an important caveat in our
understanding of children's growing aptitude in graphic communication:
the conceptual space spanning from iconic to abstract graphical
representation.

\newpage

# References

::: {#refs custom-style="Bibliography"}
:::

```{r, eval =F}
# (APPENDIX) Appendix {-}

```

\newpage

```{r child = "appendix_a_participants.Rmd"}
```

\newpage

```{r child = "appendix_b_results.Rmd"}
```

\newpage

```{r child = "appendix_c_additional.Rmd"}
```
